[22:48:57.856] Namespace(root_path='../data/bcss/L0_1024_s512', dataset='bcss', list_dir='./lists/lists_Synapse', num_classes=6, output_dir='./logs/frac_0.5/fold_0', max_iterations=30000, max_epochs=150, batch_size=24, n_gpu=1, deterministic=0, base_lr=0.05, img_size=224, seed=1234, cfg='configs/swin_tiny_patch4_window7_224_lite.yaml', opts=None, zip=False, cache_mode='part', resume=None, accumulation_steps=None, use_checkpoint=False, amp_opt_level='O1', tag=None, eval=False, throughput=False, frac=0.5, fold=0)
[22:48:57.880] Reading 9897 files in ../data/bcss/L0_1024_s512/data.csv...
[22:48:57.893] Using fold 0 and keep 6992 train files only...
[22:48:57.893] Removing images with threshold of 0.1...
[22:48:57.894] Create train set with 6345 files...
[22:48:57.895] Use 0.5 percent of data to train: 3172!
[22:48:57.899] Reading 804 files in ../data/bcss/L0_1024_s512/val_data.csv...
[22:48:57.901] Using fold 0 and keep 804 val files only...
[22:48:57.902] Removing images with threshold of 0.1...
[22:48:57.902] Create val set with 679 files...
[22:48:58.757] 133 iterations per epoch. 19950 max iterations 
[22:49:01.550] train iteration 1 : loss : 1.288420, loss_ce: 1.924269
[22:49:21.191] train iteration 51 : loss : 1.024783, loss_ce: 1.360465
[22:49:41.045] train iteration 101 : loss : 0.966018, loss_ce: 1.294859
[22:50:03.144] val epoch 0 : f1_micro : 0.5872168289290534, f1_macro : 0.402567109796736, tumor_f1 : 0.5675456605075548, stroma_f1 : 0.6335151506794824, infla_f1 : 0.11112490937961815, necr_f1 : 0.8349285576078627, other_f1 : 0.38947853258707454, acc_micro : 0.8349285576078627
[22:50:04.716] train iteration 134 : loss : 1.007159, loss_ce: 1.407198
[22:50:24.519] train iteration 184 : loss : 0.878227, loss_ce: 1.193491
[22:50:44.793] train iteration 234 : loss : 0.927646, loss_ce: 1.328295
[22:51:06.411] val epoch 1 : f1_micro : 0.6065572553210788, f1_macro : 0.4455664889680015, tumor_f1 : 0.6511511193381415, stroma_f1 : 0.6020498204562399, infla_f1 : 0.05458218932358755, necr_f1 : 0.8426498995886909, other_f1 : 0.4087800346728828, acc_micro : 0.8426498995886909
[22:51:07.903] train iteration 267 : loss : 0.876956, loss_ce: 1.089261
[22:51:27.698] train iteration 317 : loss : 0.946568, loss_ce: 1.346140
[22:51:47.899] train iteration 367 : loss : 0.859717, loss_ce: 1.120511
[22:52:09.707] val epoch 2 : f1_micro : 0.5773953013949924, f1_macro : 0.4128698971536424, tumor_f1 : 0.6404592807094256, stroma_f1 : 0.5263258649346729, infla_f1 : 0.07642615361481957, necr_f1 : 0.8309655944506328, other_f1 : 0.39875842904051145, acc_micro : 0.8309655944506328
[22:52:11.238] train iteration 400 : loss : 0.788682, loss_ce: 1.064077
[22:52:31.167] train iteration 450 : loss : 0.773890, loss_ce: 1.147761
[22:52:51.289] train iteration 500 : loss : 0.867593, loss_ce: 1.087712
[22:53:13.036] val epoch 3 : f1_micro : 0.5933690223428938, f1_macro : 0.401239769326316, tumor_f1 : 0.6701525482866499, stroma_f1 : 0.5456951534168588, infla_f1 : 0.3144448407822185, necr_f1 : 0.8373874253696866, other_f1 : 0.3912816362248527, acc_micro : 0.8373874253696866
[22:53:14.536] train iteration 533 : loss : 0.940536, loss_ce: 1.330358
[22:53:34.262] train iteration 583 : loss : 0.933081, loss_ce: 1.301893
[22:53:54.568] train iteration 633 : loss : 0.827677, loss_ce: 1.085813
[22:54:16.158] val epoch 4 : f1_micro : 0.6208086702558729, f1_macro : 0.42311490774154664, tumor_f1 : 0.6615512429012192, stroma_f1 : 0.5745074902143743, infla_f1 : 0.3973728619101975, necr_f1 : 0.8483751826816135, other_f1 : 0.39707816271891516, acc_micro : 0.8483751826816135
[22:54:17.537] train iteration 666 : loss : 0.867896, loss_ce: 1.264032
[22:54:37.398] train iteration 716 : loss : 0.859840, loss_ce: 1.207459
[22:54:57.571] train iteration 766 : loss : 0.708673, loss_ce: 0.937612
[22:55:19.333] val epoch 5 : f1_micro : 0.6224655939473046, f1_macro : 0.40380939874384136, tumor_f1 : 0.6774832235442267, stroma_f1 : 0.6098912252320183, infla_f1 : 0.1397300089395786, necr_f1 : 0.8490558981895446, other_f1 : 0.4099678751288189, acc_micro : 0.8490558981895446
[22:55:20.916] train iteration 799 : loss : 0.839319, loss_ce: 1.054628
[22:55:40.657] train iteration 849 : loss : 0.839016, loss_ce: 1.186380
[22:56:00.869] train iteration 899 : loss : 0.683249, loss_ce: 0.988112
[22:56:22.701] val epoch 6 : f1_micro : 0.6322998940944672, f1_macro : 0.43791499932607014, tumor_f1 : 0.6918689277436998, stroma_f1 : 0.6000062364929666, infla_f1 : 0.2829485697426005, necr_f1 : 0.8529841250843472, other_f1 : 0.4037164556949089, acc_micro : 0.8529841250843472
[22:56:24.207] train iteration 932 : loss : 0.766795, loss_ce: 1.046447
[22:56:43.932] train iteration 982 : loss : 0.990860, loss_ce: 1.488719
[22:57:04.181] train iteration 1032 : loss : 0.759700, loss_ce: 1.044992
[22:57:26.015] val epoch 7 : f1_micro : 0.6642897420459324, f1_macro : 0.47073098089959886, tumor_f1 : 0.7192297495073743, stroma_f1 : 0.5815441456105974, infla_f1 : 0.4991140087031656, necr_f1 : 0.8657701863182916, other_f1 : 0.404881968566527, acc_micro : 0.8657701863182916
[22:57:27.437] train iteration 1065 : loss : 0.686731, loss_ce: 0.989387
[22:57:47.217] train iteration 1115 : loss : 0.786884, loss_ce: 1.100667
[22:58:07.291] train iteration 1165 : loss : 0.686379, loss_ce: 1.077164
[22:58:29.275] val epoch 8 : f1_micro : 0.6147139628728231, f1_macro : 0.43223723106914097, tumor_f1 : 0.6455664844976531, stroma_f1 : 0.5915706457363235, infla_f1 : 0.4529942994316419, necr_f1 : 0.8459929611947802, other_f1 : 0.37044937280006707, acc_micro : 0.8459929611947802
[22:58:30.778] train iteration 1198 : loss : 0.623360, loss_ce: 0.722876
[22:58:50.480] train iteration 1248 : loss : 0.754602, loss_ce: 0.980555
[22:59:10.582] train iteration 1298 : loss : 0.508701, loss_ce: 0.755087
[22:59:32.500] val epoch 9 : f1_micro : 0.6677403608957927, f1_macro : 0.47670791380935246, tumor_f1 : 0.7443620695008172, stroma_f1 : 0.5782611028187805, infla_f1 : 0.5378902281324068, necr_f1 : 0.8671390771865845, other_f1 : 0.3931436572223902, acc_micro : 0.8671390771865845
[22:59:33.980] train iteration 1331 : loss : 0.742328, loss_ce: 0.904567
[22:59:53.737] train iteration 1381 : loss : 0.603698, loss_ce: 0.729865
[23:00:13.833] train iteration 1431 : loss : 0.844927, loss_ce: 1.217358
[23:00:35.552] val epoch 10 : f1_micro : 0.6878363000022041, f1_macro : 0.49238783485359616, tumor_f1 : 0.7637325353092618, stroma_f1 : 0.5973860449261136, infla_f1 : 0.5506772395223379, necr_f1 : 0.8751739462216696, other_f1 : 0.430764728730234, acc_micro : 0.8751739462216696
[23:00:37.018] train iteration 1464 : loss : 0.852211, loss_ce: 1.175953
[23:00:56.802] train iteration 1514 : loss : 0.710243, loss_ce: 0.817861
[23:01:16.937] train iteration 1564 : loss : 0.709898, loss_ce: 1.043374
[23:01:38.555] val epoch 11 : f1_micro : 0.6533003482553694, f1_macro : 0.46545535922050474, tumor_f1 : 0.7398547483815088, stroma_f1 : 0.5535219530471497, infla_f1 : 0.4994128581550386, necr_f1 : 0.861374208662245, other_f1 : 0.4016390402697855, acc_micro : 0.861374208662245
[23:01:40.046] train iteration 1597 : loss : 0.646561, loss_ce: 0.801720
[23:01:59.747] train iteration 1647 : loss : 0.646082, loss_ce: 0.831057
[23:02:19.813] train iteration 1697 : loss : 0.791570, loss_ce: 1.013687
[23:02:41.805] val epoch 12 : f1_micro : 0.666126279036204, f1_macro : 0.4825263460477193, tumor_f1 : 0.7451339695188735, stroma_f1 : 0.5558016022046407, infla_f1 : 0.5593910762419303, necr_f1 : 0.8664801597595215, other_f1 : 0.4212518410239783, acc_micro : 0.8664801597595215
[23:02:43.312] train iteration 1730 : loss : 0.712163, loss_ce: 0.998438
[23:03:03.010] train iteration 1780 : loss : 0.688899, loss_ce: 0.915320
[23:03:23.169] train iteration 1830 : loss : 0.691977, loss_ce: 1.011152
[23:03:45.048] val epoch 13 : f1_micro : 0.6124619172679053, f1_macro : 0.4301898923185137, tumor_f1 : 0.6776763843165503, stroma_f1 : 0.5297460380527709, infla_f1 : 0.3664664779349955, necr_f1 : 0.8449962457021077, other_f1 : 0.42189699099399147, acc_micro : 0.8449962457021077
[23:03:46.466] train iteration 1863 : loss : 0.835244, loss_ce: 1.173401
[23:04:06.257] train iteration 1913 : loss : 0.824488, loss_ce: 1.042242
[23:04:26.435] train iteration 1963 : loss : 0.893288, loss_ce: 1.255146
[23:04:48.102] val epoch 14 : f1_micro : 0.5977501730124156, f1_macro : 0.4531617257330153, tumor_f1 : 0.7167775203784307, stroma_f1 : 0.4276926645802127, infla_f1 : 0.5246906198030855, necr_f1 : 0.839146535926395, other_f1 : 0.4324266268380193, acc_micro : 0.839146535926395
[23:04:49.563] train iteration 1996 : loss : 0.636569, loss_ce: 0.912305
[23:05:09.393] train iteration 2046 : loss : 0.549743, loss_ce: 0.817292
[23:05:29.482] train iteration 2096 : loss : 0.907207, loss_ce: 1.294450
[23:05:51.290] val epoch 15 : f1_micro : 0.6815313365724351, f1_macro : 0.4930018186569214, tumor_f1 : 0.7438899166054196, stroma_f1 : 0.5720396745536063, infla_f1 : 0.5732293146351973, necr_f1 : 0.8726440482669406, other_f1 : 0.4019374842561471, acc_micro : 0.8726440482669406
[23:05:52.839] train iteration 2129 : loss : 0.654308, loss_ce: 0.852136
[23:06:12.620] train iteration 2179 : loss : 0.552845, loss_ce: 0.625064
[23:06:32.753] train iteration 2229 : loss : 0.609305, loss_ce: 0.810717
[23:06:54.435] val epoch 16 : f1_micro : 0.6605281823211246, f1_macro : 0.49136889378229776, tumor_f1 : 0.7378034055233001, stroma_f1 : 0.5391569730308321, infla_f1 : 0.5805039635135067, necr_f1 : 0.8642154296239217, other_f1 : 0.44118824948867164, acc_micro : 0.8642154296239217
[23:06:55.932] train iteration 2262 : loss : 0.714652, loss_ce: 0.864150
[23:07:15.765] train iteration 2312 : loss : 0.705612, loss_ce: 0.842393
[23:07:35.999] train iteration 2362 : loss : 0.688768, loss_ce: 0.934833
[23:07:57.861] val epoch 17 : f1_micro : 0.6861606174045138, f1_macro : 0.49368381798267363, tumor_f1 : 0.7550926884015401, stroma_f1 : 0.610072088200185, infla_f1 : 0.5636665109131072, necr_f1 : 0.8745000070995754, other_f1 : 0.44185200098695027, acc_micro : 0.8745000070995754
[23:07:59.287] train iteration 2395 : loss : 0.659093, loss_ce: 0.816050
[23:08:19.042] train iteration 2445 : loss : 0.563329, loss_ce: 0.697369
[23:08:39.141] train iteration 2495 : loss : 0.780787, loss_ce: 1.130226
[23:09:00.878] val epoch 18 : f1_micro : 0.6753231260511611, f1_macro : 0.4852979769309362, tumor_f1 : 0.744961968395445, stroma_f1 : 0.5812425368362003, infla_f1 : 0.5546958900936362, necr_f1 : 0.8701808094978333, other_f1 : 0.42656778931203815, acc_micro : 0.8701808094978333
[23:09:02.431] train iteration 2528 : loss : 0.596827, loss_ce: 0.768915
[23:09:22.171] train iteration 2578 : loss : 0.731729, loss_ce: 1.041192
[23:09:42.367] train iteration 2628 : loss : 0.606979, loss_ce: 0.848300
[23:10:04.224] val epoch 19 : f1_micro : 0.6765276253223419, f1_macro : 0.4803042342265447, tumor_f1 : 0.7289812309874428, stroma_f1 : 0.6143046983828148, infla_f1 : 0.4747648508624277, necr_f1 : 0.8706371333864, other_f1 : 0.39602592206663556, acc_micro : 0.8706371333864
[23:10:05.701] train iteration 2661 : loss : 0.835132, loss_ce: 1.097020
[23:10:25.424] train iteration 2711 : loss : 0.644429, loss_ce: 0.929740
[23:10:45.620] train iteration 2761 : loss : 0.611595, loss_ce: 0.769786
[23:11:07.503] val epoch 20 : f1_micro : 0.6707771023114523, f1_macro : 0.49589271081818476, tumor_f1 : 0.7501211676332685, stroma_f1 : 0.5496946348084344, infla_f1 : 0.5697191029787063, necr_f1 : 0.8683402988645765, other_f1 : 0.4434756141466399, acc_micro : 0.8683402988645765
[23:11:08.988] train iteration 2794 : loss : 0.770042, loss_ce: 0.982880
[23:11:28.716] train iteration 2844 : loss : 0.704509, loss_ce: 1.035189
[23:11:48.951] train iteration 2894 : loss : 0.508349, loss_ce: 0.567554
[23:12:10.878] val epoch 21 : f1_micro : 0.646481223238839, f1_macro : 0.4762832721074422, tumor_f1 : 0.7427980456087324, stroma_f1 : 0.5244758269853063, infla_f1 : 0.5438702590090947, necr_f1 : 0.8586120353804694, other_f1 : 0.42799907736480236, acc_micro : 0.8586120353804694
[23:12:12.381] train iteration 2927 : loss : 0.701597, loss_ce: 1.067254
[23:12:32.164] train iteration 2977 : loss : 0.744258, loss_ce: 1.026367
[23:12:52.184] train iteration 3027 : loss : 0.651216, loss_ce: 0.777144
[23:13:14.262] val epoch 22 : f1_micro : 0.6864881773789724, f1_macro : 0.5036068634854423, tumor_f1 : 0.7517325023810069, stroma_f1 : 0.584527787897322, infla_f1 : 0.5898228729764621, necr_f1 : 0.8746170070436265, other_f1 : 0.4412962883503901, acc_micro : 0.8746170070436265
[23:13:15.763] train iteration 3060 : loss : 0.582858, loss_ce: 0.772801
[23:13:35.472] train iteration 3110 : loss : 0.641430, loss_ce: 0.937810
[23:13:55.695] train iteration 3160 : loss : 0.684572, loss_ce: 0.814143
[23:14:17.425] val epoch 23 : f1_micro : 0.6787879321310255, f1_macro : 0.5001213822099898, tumor_f1 : 0.7436522497071161, stroma_f1 : 0.5609047969182333, infla_f1 : 0.5526767381363444, necr_f1 : 0.8715461572011312, other_f1 : 0.4553035634983745, acc_micro : 0.8715461572011312
[23:14:18.952] train iteration 3193 : loss : 0.702359, loss_ce: 0.913965
[23:14:38.687] train iteration 3243 : loss : 0.606625, loss_ce: 0.864252
[23:14:58.858] train iteration 3293 : loss : 0.612584, loss_ce: 0.716633
[23:15:20.768] val epoch 24 : f1_micro : 0.6949318144056532, f1_macro : 0.5111013611157735, tumor_f1 : 0.7625858498944177, stroma_f1 : 0.5966661256220606, infla_f1 : 0.5769763577315542, necr_f1 : 0.8779977493815951, other_f1 : 0.4620781264319602, acc_micro : 0.8779977493815951
[23:15:22.179] train iteration 3326 : loss : 0.674647, loss_ce: 0.870925
[23:15:42.000] train iteration 3376 : loss : 0.574685, loss_ce: 0.654260
[23:16:02.232] train iteration 3426 : loss : 0.562563, loss_ce: 0.764253
[23:16:23.914] val epoch 25 : f1_micro : 0.6913270632425944, f1_macro : 0.507122113969591, tumor_f1 : 0.7260781824588776, stroma_f1 : 0.6325887984699673, infla_f1 : 0.5429122580422295, necr_f1 : 0.8765821523136563, other_f1 : 0.4477628479627634, acc_micro : 0.8765821523136563
[23:16:25.426] train iteration 3459 : loss : 0.748134, loss_ce: 1.081042
[23:16:45.284] train iteration 3509 : loss : 0.760322, loss_ce: 0.988542
[23:17:05.426] train iteration 3559 : loss : 0.817479, loss_ce: 1.154944
[23:17:27.261] val epoch 26 : f1_micro : 0.6679534243212806, f1_macro : 0.4894487059778637, tumor_f1 : 0.7196849985255136, stroma_f1 : 0.5771789203087488, infla_f1 : 0.5094007438908901, necr_f1 : 0.8671940830018785, other_f1 : 0.42522727728096976, acc_micro : 0.8671940830018785
[23:17:28.715] train iteration 3592 : loss : 0.859813, loss_ce: 1.170056
[23:17:48.507] train iteration 3642 : loss : 0.818574, loss_ce: 1.200793
[23:18:08.771] train iteration 3692 : loss : 0.697601, loss_ce: 0.973022
[23:18:30.396] val epoch 27 : f1_micro : 0.6586170269383325, f1_macro : 0.49383522934383817, tumor_f1 : 0.7632767809761896, stroma_f1 : 0.4993888417051898, infla_f1 : 0.5916771064615912, necr_f1 : 0.8634641647338868, other_f1 : 0.4476905936918532, acc_micro : 0.8634641647338868
[23:18:31.966] train iteration 3725 : loss : 0.663882, loss_ce: 0.873030
[23:18:51.726] train iteration 3775 : loss : 0.750917, loss_ce: 0.995687
[23:19:12.027] train iteration 3825 : loss : 0.670925, loss_ce: 0.840899
[23:19:33.813] val epoch 28 : f1_micro : 0.6941041866938273, f1_macro : 0.5092018398973677, tumor_f1 : 0.7583732651339636, stroma_f1 : 0.6070571918040514, infla_f1 : 0.5290335568288962, necr_f1 : 0.8776573207643297, other_f1 : 0.4477931829893755, acc_micro : 0.8776573207643297
[23:19:35.285] train iteration 3858 : loss : 0.850717, loss_ce: 1.177572
[23:19:55.101] train iteration 3908 : loss : 0.711043, loss_ce: 0.936448
[23:20:15.147] train iteration 3958 : loss : 0.732425, loss_ce: 1.014234
[23:20:37.056] val epoch 29 : f1_micro : 0.6839237842294905, f1_macro : 0.5147811439302232, tumor_f1 : 0.7542469402154287, stroma_f1 : 0.5639392857750257, infla_f1 : 0.6217387061980035, necr_f1 : 0.8735813789897495, other_f1 : 0.43303576450950154, acc_micro : 0.8735813789897495
[23:20:38.601] train iteration 3991 : loss : 0.537686, loss_ce: 0.719961
[23:20:58.338] train iteration 4041 : loss : 0.523205, loss_ce: 0.513021
[23:21:18.591] train iteration 4091 : loss : 0.937724, loss_ce: 1.418837
[23:21:40.221] val epoch 30 : f1_micro : 0.69296685523457, f1_macro : 0.4975738743940989, tumor_f1 : 0.7449571695592668, stroma_f1 : 0.6154170409258869, infla_f1 : 0.5689135844922728, necr_f1 : 0.8772285328971015, other_f1 : 0.4339753794690801, acc_micro : 0.8772285328971015
[23:21:41.801] train iteration 4124 : loss : 0.724688, loss_ce: 0.989421
[23:22:01.587] train iteration 4174 : loss : 0.719153, loss_ce: 0.848122
[23:22:21.848] train iteration 4224 : loss : 0.514829, loss_ce: 0.730437
[23:22:43.693] val epoch 31 : f1_micro : 0.6583795150121053, f1_macro : 0.47892557779947914, tumor_f1 : 0.7260821921957864, stroma_f1 : 0.5726090874936846, infla_f1 : 0.505425076548838, necr_f1 : 0.8633844057718912, other_f1 : 0.44166679320236046, acc_micro : 0.8633844057718912
[23:22:45.171] train iteration 4257 : loss : 0.590616, loss_ce: 0.833726
[23:23:04.895] train iteration 4307 : loss : 0.741708, loss_ce: 1.069933
[23:23:25.106] train iteration 4357 : loss : 0.496464, loss_ce: 0.671150
[23:23:46.880] val epoch 32 : f1_micro : 0.6407528016302321, f1_macro : 0.48565209011236826, tumor_f1 : 0.7172510315974553, stroma_f1 : 0.5406694911989487, infla_f1 : 0.5279190500577291, necr_f1 : 0.8563173651695252, other_f1 : 0.4436686308640573, acc_micro : 0.8563173651695252
[23:23:48.320] train iteration 4390 : loss : 0.547096, loss_ce: 0.788794
[23:24:08.036] train iteration 4440 : loss : 0.752707, loss_ce: 1.056508
[23:24:28.232] train iteration 4490 : loss : 0.680668, loss_ce: 0.852819
[23:24:49.922] val epoch 33 : f1_micro : 0.6769560204611884, f1_macro : 0.49449337191051906, tumor_f1 : 0.752129829592175, stroma_f1 : 0.5918807536363602, infla_f1 : 0.5098824372411602, necr_f1 : 0.8707976778348286, other_f1 : 0.43341347279234066, acc_micro : 0.8707976778348286
[23:24:51.438] train iteration 4523 : loss : 0.736846, loss_ce: 1.064123
[23:25:11.243] train iteration 4573 : loss : 0.441274, loss_ce: 0.491007
[23:25:31.346] train iteration 4623 : loss : 0.865388, loss_ce: 1.171930
[23:25:53.431] val epoch 34 : f1_micro : 0.6853158897823758, f1_macro : 0.5229890551831987, tumor_f1 : 0.7526911536852519, stroma_f1 : 0.5696284118625853, infla_f1 : 0.6247320182621479, necr_f1 : 0.8741627176602681, other_f1 : 0.4431554954499006, acc_micro : 0.8741627176602681
[23:25:54.923] train iteration 4656 : loss : 0.640187, loss_ce: 0.861467
[23:26:14.738] train iteration 4706 : loss : 0.763373, loss_ce: 1.018199
[23:26:34.792] train iteration 4756 : loss : 0.728532, loss_ce: 1.112686
[23:26:56.529] val epoch 35 : f1_micro : 0.6681948449876574, f1_macro : 0.5089363329940372, tumor_f1 : 0.7423277821805742, stroma_f1 : 0.5527984754906761, infla_f1 : 0.586780744501286, necr_f1 : 0.867304515838623, other_f1 : 0.4390348949159185, acc_micro : 0.867304515838623
[23:26:58.083] train iteration 4789 : loss : 0.669340, loss_ce: 0.962588
[23:27:17.865] train iteration 4839 : loss : 0.670257, loss_ce: 0.844252
[23:27:38.050] train iteration 4889 : loss : 0.582415, loss_ce: 0.704182
[23:27:59.853] val epoch 36 : f1_micro : 0.7064641714096069, f1_macro : 0.5401119295093748, tumor_f1 : 0.7661203874482049, stroma_f1 : 0.6088727596733305, infla_f1 : 0.5760634786552853, necr_f1 : 0.882607270611657, other_f1 : 0.40980951454904346, acc_micro : 0.882607270611657
[23:28:01.309] train iteration 4922 : loss : 0.862011, loss_ce: 1.146605
[23:28:21.052] train iteration 4972 : loss : 0.639002, loss_ce: 0.861485
[23:28:41.215] train iteration 5022 : loss : 0.713860, loss_ce: 0.960608
[23:29:03.144] val epoch 37 : f1_micro : 0.6491344730059306, f1_macro : 0.5036300056510501, tumor_f1 : 0.7617545240455204, stroma_f1 : 0.49287920308609806, infla_f1 : 0.6157130864759286, necr_f1 : 0.859696176317003, other_f1 : 0.46605247979362807, acc_micro : 0.859696176317003
[23:29:04.661] train iteration 5055 : loss : 0.551336, loss_ce: 0.755961
[23:29:24.399] train iteration 5105 : loss : 0.580361, loss_ce: 0.631779
[23:29:44.546] train iteration 5155 : loss : 0.547481, loss_ce: 0.569461
[23:30:06.435] val epoch 38 : f1_micro : 0.6798656490114, f1_macro : 0.49712561733192867, tumor_f1 : 0.7176258511013455, stroma_f1 : 0.6040425267717283, infla_f1 : 0.5398527037766244, necr_f1 : 0.871967245472802, other_f1 : 0.45354882478713987, acc_micro : 0.871967245472802
[23:30:07.913] train iteration 5188 : loss : 0.578524, loss_ce: 0.697462
[23:30:27.657] train iteration 5238 : loss : 0.450526, loss_ce: 0.598364
[23:30:47.822] train iteration 5288 : loss : 0.595569, loss_ce: 0.705217
[23:31:09.669] val epoch 39 : f1_micro : 0.690592059161928, f1_macro : 0.5194510598977407, tumor_f1 : 0.7649109125137329, stroma_f1 : 0.5799369352973169, infla_f1 : 0.6057366807065491, necr_f1 : 0.8762577984068128, other_f1 : 0.45232666715876096, acc_micro : 0.8762577984068128
[23:31:11.090] train iteration 5321 : loss : 0.798385, loss_ce: 1.049420
[23:31:30.907] train iteration 5371 : loss : 0.645233, loss_ce: 0.912150
[23:31:51.086] train iteration 5421 : loss : 0.566933, loss_ce: 0.741599
[23:32:12.700] val epoch 40 : f1_micro : 0.6834065232012007, f1_macro : 0.517127470837699, tumor_f1 : 0.7656508180830214, stroma_f1 : 0.5612492107682758, infla_f1 : 0.5765982091426849, necr_f1 : 0.8733798331684537, other_f1 : 0.46295479610562323, acc_micro : 0.8733798331684537
[23:32:14.227] train iteration 5454 : loss : 0.754399, loss_ce: 0.932562
[23:32:34.020] train iteration 5504 : loss : 0.682160, loss_ce: 0.891669
[23:32:54.295] train iteration 5554 : loss : 0.675083, loss_ce: 0.902364
[23:33:15.881] val epoch 41 : f1_micro : 0.7015207389990489, f1_macro : 0.5195893035994635, tumor_f1 : 0.7727470682726966, stroma_f1 : 0.605994760327869, infla_f1 : 0.6205739181592232, necr_f1 : 0.8806347290674845, other_f1 : 0.4531619825296932, acc_micro : 0.8806347290674845
[23:33:17.372] train iteration 5587 : loss : 0.591365, loss_ce: 0.740491
[23:33:37.125] train iteration 5637 : loss : 0.633368, loss_ce: 0.797581
[23:33:57.264] train iteration 5687 : loss : 0.956067, loss_ce: 1.372025
[23:34:19.114] val epoch 42 : f1_micro : 0.6774866686926948, f1_macro : 0.5136325501733356, tumor_f1 : 0.7369242512517505, stroma_f1 : 0.6018843991888894, infla_f1 : 0.5800465494394302, necr_f1 : 0.8710216005643209, other_f1 : 0.4289156643880738, acc_micro : 0.8710216005643209
[23:34:20.622] train iteration 5720 : loss : 0.535787, loss_ce: 0.663631
[23:34:40.396] train iteration 5770 : loss : 0.780756, loss_ce: 1.127350
[23:35:00.642] train iteration 5820 : loss : 0.630521, loss_ce: 0.788614
[23:35:22.413] val epoch 43 : f1_micro : 0.7108988013532427, f1_macro : 0.5224186559518178, tumor_f1 : 0.7633598486582438, stroma_f1 : 0.6356491443183687, infla_f1 : 0.5091000051444603, necr_f1 : 0.8843809299998813, other_f1 : 0.45938667390081617, acc_micro : 0.8843809299998813
[23:35:23.915] train iteration 5853 : loss : 0.635548, loss_ce: 0.895968
[23:35:43.652] train iteration 5903 : loss : 0.584001, loss_ce: 0.621811
[23:36:03.783] train iteration 5953 : loss : 0.473794, loss_ce: 0.678071
[23:36:25.648] val epoch 44 : f1_micro : 0.7043283641338348, f1_macro : 0.5220814959870445, tumor_f1 : 0.7623976091543834, stroma_f1 : 0.6208772281805675, infla_f1 : 0.580094746955567, necr_f1 : 0.8817662755648296, other_f1 : 0.4370604939060286, acc_micro : 0.8817662755648296
[23:36:27.188] train iteration 5986 : loss : 0.731413, loss_ce: 0.963387
[23:36:46.881] train iteration 6036 : loss : 0.623541, loss_ce: 0.853889
[23:37:07.114] train iteration 6086 : loss : 0.550043, loss_ce: 0.757469
[23:37:28.832] val epoch 45 : f1_micro : 0.7059151629606882, f1_macro : 0.5322526931762696, tumor_f1 : 0.7712846047348446, stroma_f1 : 0.6059294650952022, infla_f1 : 0.6202733541528384, necr_f1 : 0.8823947350184123, other_f1 : 0.44992348150246675, acc_micro : 0.8823947350184123
[23:37:30.386] train iteration 6119 : loss : 0.565187, loss_ce: 0.761007
[23:37:50.105] train iteration 6169 : loss : 0.521357, loss_ce: 0.749570
[23:38:10.272] train iteration 6219 : loss : 0.760391, loss_ce: 1.015486
[23:38:31.943] val epoch 46 : f1_micro : 0.6943003839916653, f1_macro : 0.5337997714678446, tumor_f1 : 0.7582114140192667, stroma_f1 : 0.5923661897579829, infla_f1 : 0.5851625555919276, necr_f1 : 0.8777409805191888, other_f1 : 0.45423339212106334, acc_micro : 0.8777409805191888
[23:38:33.453] train iteration 6252 : loss : 0.555279, loss_ce: 0.838382
[23:38:53.159] train iteration 6302 : loss : 0.712908, loss_ce: 0.935800
[23:39:13.467] train iteration 6352 : loss : 0.768198, loss_ce: 1.062047
[23:39:35.066] val epoch 47 : f1_micro : 0.6871234787835016, f1_macro : 0.5087688065237469, tumor_f1 : 0.7555779576301574, stroma_f1 : 0.5972168026698961, infla_f1 : 0.5699337310261197, necr_f1 : 0.874887986977895, other_f1 : 0.4423741285999616, acc_micro : 0.874887986977895
[23:39:36.583] train iteration 6385 : loss : 0.731446, loss_ce: 1.048748
[23:39:56.334] train iteration 6435 : loss : 0.670831, loss_ce: 0.963888
[23:40:16.599] train iteration 6485 : loss : 0.607681, loss_ce: 0.732468
[23:40:38.368] val epoch 48 : f1_micro : 0.6980909056133694, f1_macro : 0.5285660915904575, tumor_f1 : 0.7570745706558227, stroma_f1 : 0.5884103837940428, infla_f1 : 0.626077960183223, necr_f1 : 0.8792530284987555, other_f1 : 0.46076022473474343, acc_micro : 0.8792530284987555
[23:40:39.821] train iteration 6518 : loss : 0.625892, loss_ce: 0.874514
[23:40:59.650] train iteration 6568 : loss : 0.704010, loss_ce: 0.983117
[23:41:19.793] train iteration 6618 : loss : 0.489499, loss_ce: 0.657525
[23:41:41.522] val epoch 49 : f1_micro : 0.6666753023862839, f1_macro : 0.5219994535048803, tumor_f1 : 0.7449806352456411, stroma_f1 : 0.5858433057864507, infla_f1 : 0.5960064337485367, necr_f1 : 0.8667448017332289, other_f1 : 0.44439937460960616, acc_micro : 0.8667448017332289
[23:41:42.954] train iteration 6651 : loss : 0.620058, loss_ce: 0.930243
[23:42:02.802] train iteration 6701 : loss : 0.744241, loss_ce: 0.907633
[23:42:22.883] train iteration 6751 : loss : 0.679323, loss_ce: 1.050510
[23:42:44.873] val epoch 50 : f1_micro : 0.7110937972863515, f1_macro : 0.5366435600651636, tumor_f1 : 0.7725274152225918, stroma_f1 : 0.6191719363133112, infla_f1 : 0.6095448298379779, necr_f1 : 0.8844577405187819, other_f1 : 0.43343087832132976, acc_micro : 0.8844577405187819
[23:42:46.306] train iteration 6784 : loss : 0.574237, loss_ce: 0.768823
[23:43:06.040] train iteration 6834 : loss : 0.586884, loss_ce: 0.664605
[23:43:26.176] train iteration 6884 : loss : 0.722080, loss_ce: 1.011003
[23:43:48.137] val epoch 51 : f1_micro : 0.7001772105693818, f1_macro : 0.5570529719193776, tumor_f1 : 0.7633373108175066, stroma_f1 : 0.6009994076357947, infla_f1 : 0.6099917345576816, necr_f1 : 0.8801093763775296, other_f1 : 0.47824274400870004, acc_micro : 0.8801093763775296
[23:43:49.570] train iteration 6917 : loss : 0.540404, loss_ce: 0.641181
[23:44:09.337] train iteration 6967 : loss : 0.662368, loss_ce: 0.924577
[23:44:29.486] train iteration 7017 : loss : 0.501774, loss_ce: 0.668411
[23:44:51.181] val epoch 52 : f1_micro : 0.6871208548545837, f1_macro : 0.5223433017730713, tumor_f1 : 0.7507663382424249, stroma_f1 : 0.5663791603512234, infla_f1 : 0.6054700609710482, necr_f1 : 0.8748680088255141, other_f1 : 0.4659307782848676, acc_micro : 0.8748680088255141
[23:44:52.539] train iteration 7050 : loss : 0.581337, loss_ce: 0.661413
[23:45:12.426] train iteration 7100 : loss : 0.559805, loss_ce: 0.792705
[23:45:32.548] train iteration 7150 : loss : 0.680812, loss_ce: 0.995636
[23:45:54.292] val epoch 53 : f1_micro : 0.6909999112288158, f1_macro : 0.522123572561476, tumor_f1 : 0.7502856761217117, stroma_f1 : 0.5938663678036795, infla_f1 : 0.5787364318552944, necr_f1 : 0.876415240764618, other_f1 : 0.45467446067680917, acc_micro : 0.876415240764618
[23:45:55.806] train iteration 7183 : loss : 0.737392, loss_ce: 1.008636
[23:46:15.553] train iteration 7233 : loss : 0.576766, loss_ce: 0.874258
[23:46:35.793] train iteration 7283 : loss : 0.717451, loss_ce: 0.932779
[23:46:57.654] val epoch 54 : f1_micro : 0.6970632168981764, f1_macro : 0.5347899244891272, tumor_f1 : 0.7659906917148166, stroma_f1 : 0.5951055798265669, infla_f1 : 0.5706509473837085, necr_f1 : 0.8788440214263068, other_f1 : 0.45611339016920993, acc_micro : 0.8788440214263068
[23:46:59.178] train iteration 7316 : loss : 0.683770, loss_ce: 0.918565
[23:47:18.858] train iteration 7366 : loss : 0.598620, loss_ce: 0.787056
[23:47:39.084] train iteration 7416 : loss : 0.590615, loss_ce: 0.724409
[23:48:00.947] val epoch 55 : f1_micro : 0.7025239335166084, f1_macro : 0.5401728782388899, tumor_f1 : 0.7738605505890317, stroma_f1 : 0.5928844418583645, infla_f1 : 0.6044833501180013, necr_f1 : 0.8810282773441739, other_f1 : 0.4741256691515446, acc_micro : 0.8810282773441739
[23:48:02.392] train iteration 7449 : loss : 0.567344, loss_ce: 0.698771
[23:48:22.227] train iteration 7499 : loss : 0.520680, loss_ce: 0.650245
[23:48:42.403] train iteration 7549 : loss : 0.846764, loss_ce: 1.246794
[23:49:04.494] val epoch 56 : f1_micro : 0.6865694046020507, f1_macro : 0.537529675828086, tumor_f1 : 0.740450515349706, stroma_f1 : 0.5671577711900075, infla_f1 : 0.609280737903383, necr_f1 : 0.8746767428186205, other_f1 : 0.46805711997052035, acc_micro : 0.8746767428186205
[23:49:05.981] train iteration 7582 : loss : 0.596857, loss_ce: 0.752637
[23:49:25.744] train iteration 7632 : loss : 0.543787, loss_ce: 0.545293
[23:49:45.910] train iteration 7682 : loss : 0.632415, loss_ce: 0.817867
[23:50:07.545] val epoch 57 : f1_micro : 0.6598013238774405, f1_macro : 0.5226048628489176, tumor_f1 : 0.7486166391107771, stroma_f1 : 0.5537089803152614, infla_f1 : 0.625620608859592, necr_f1 : 0.8639530539512634, other_f1 : 0.4738551343480746, acc_micro : 0.8639530539512634
[23:50:09.028] train iteration 7715 : loss : 0.487139, loss_ce: 0.624021
[23:50:28.903] train iteration 7765 : loss : 0.533960, loss_ce: 0.555763
[23:50:49.203] train iteration 7815 : loss : 0.686434, loss_ce: 0.963678
[23:51:11.013] val epoch 58 : f1_micro : 0.7037216073936886, f1_macro : 0.5692702915933398, tumor_f1 : 0.7596527099609375, stroma_f1 : 0.6187500867578718, infla_f1 : 0.5620139400164287, necr_f1 : 0.8814980586369833, other_f1 : 0.4612143269740045, acc_micro : 0.8814980586369833
[23:51:12.565] train iteration 7848 : loss : 0.554596, loss_ce: 0.704726
[23:51:32.320] train iteration 7898 : loss : 0.559222, loss_ce: 0.698018
[23:51:52.469] train iteration 7948 : loss : 0.697373, loss_ce: 0.938107
[23:52:14.206] val epoch 59 : f1_micro : 0.6708181957403819, f1_macro : 0.5220576418770684, tumor_f1 : 0.762436158127255, stroma_f1 : 0.5457003110398849, infla_f1 : 0.5978286835882399, necr_f1 : 0.8683588822682698, other_f1 : 0.45562915835115647, acc_micro : 0.8683588822682698
[23:52:15.695] train iteration 7981 : loss : 0.645827, loss_ce: 0.876185
[23:52:35.531] train iteration 8031 : loss : 0.620661, loss_ce: 0.828770
[23:52:55.702] train iteration 8081 : loss : 0.419930, loss_ce: 0.519623
[23:53:17.465] val epoch 60 : f1_micro : 0.6888526333702936, f1_macro : 0.5067039221525192, tumor_f1 : 0.7543203906880485, stroma_f1 : 0.5959696173667908, infla_f1 : 0.5923670672087206, necr_f1 : 0.8755600306722853, other_f1 : 0.41353841941389774, acc_micro : 0.8755600306722853
[23:53:18.999] train iteration 8114 : loss : 0.737719, loss_ce: 1.018394
[23:53:38.762] train iteration 8164 : loss : 0.533457, loss_ce: 0.635219
[23:53:58.857] train iteration 8214 : loss : 0.541324, loss_ce: 0.661533
[23:54:20.641] val epoch 61 : f1_micro : 0.7011911895540025, f1_macro : 0.5423472917742199, tumor_f1 : 0.7627163257863786, stroma_f1 : 0.6216527356973125, infla_f1 : 0.6009732168581751, necr_f1 : 0.8805057962735494, other_f1 : 0.4671476767398417, acc_micro : 0.8805057962735494
[23:54:22.132] train iteration 8247 : loss : 0.627081, loss_ce: 0.827733
[23:54:41.895] train iteration 8297 : loss : 0.577343, loss_ce: 0.793288
[23:55:02.174] train iteration 8347 : loss : 0.647161, loss_ce: 0.766408
[23:55:23.969] val epoch 62 : f1_micro : 0.7072032988071442, f1_macro : 0.5751425663630167, tumor_f1 : 0.767021460003323, stroma_f1 : 0.6165685610638725, infla_f1 : 0.6130427916482505, necr_f1 : 0.8828974763552347, other_f1 : 0.48094246718618605, acc_micro : 0.8828974763552347
[23:55:25.360] train iteration 8380 : loss : 0.502348, loss_ce: 0.666516
[23:55:45.135] train iteration 8430 : loss : 0.680841, loss_ce: 0.899687
[23:56:05.225] train iteration 8480 : loss : 0.710066, loss_ce: 0.942057
[23:56:27.191] val epoch 63 : f1_micro : 0.6656364725695716, f1_macro : 0.517296701669693, tumor_f1 : 0.7727787527773116, stroma_f1 : 0.5540780375401179, infla_f1 : 0.5706787625120746, necr_f1 : 0.8662707567214966, other_f1 : 0.46894876934432733, acc_micro : 0.8662707567214966
[23:56:28.676] train iteration 8513 : loss : 0.556529, loss_ce: 0.672170
[23:56:48.404] train iteration 8563 : loss : 0.687857, loss_ce: 0.924555
[23:57:08.516] train iteration 8613 : loss : 0.693365, loss_ce: 0.878079
[23:57:30.480] val epoch 64 : f1_micro : 0.6851824190881517, f1_macro : 0.4997544136312273, tumor_f1 : 0.7564323832591374, stroma_f1 : 0.597572363830275, infla_f1 : 0.5713602691785329, necr_f1 : 0.8740993658701579, other_f1 : 0.41050504607879296, acc_micro : 0.8740993658701579
[23:57:31.945] train iteration 8646 : loss : 0.730747, loss_ce: 0.988481
[23:57:51.684] train iteration 8696 : loss : 0.559342, loss_ce: 0.727394
[23:58:11.833] train iteration 8746 : loss : 0.686624, loss_ce: 0.912876
[23:58:33.794] val epoch 65 : f1_micro : 0.6708240535524156, f1_macro : 0.5272118618090947, tumor_f1 : 0.7349008646276262, stroma_f1 : 0.587378567788336, infla_f1 : 0.5839122709300782, necr_f1 : 0.8683539536264208, other_f1 : 0.4504674848065608, acc_micro : 0.8683539536264208
[23:58:35.230] train iteration 8779 : loss : 0.614905, loss_ce: 0.760144
[23:58:55.026] train iteration 8829 : loss : 0.867695, loss_ce: 1.107376
[23:59:15.240] train iteration 8879 : loss : 0.469916, loss_ce: 0.571742
[23:59:37.147] val epoch 66 : f1_micro : 0.697624448272917, f1_macro : 0.5545072032345666, tumor_f1 : 0.7666978928777907, stroma_f1 : 0.5951969541609288, infla_f1 : 0.6327625541223421, necr_f1 : 0.8790920522477892, other_f1 : 0.4744729434243507, acc_micro : 0.8790920522477892
[23:59:38.581] train iteration 8912 : loss : 0.630101, loss_ce: 0.802432
[23:59:58.294] train iteration 8962 : loss : 0.531415, loss_ce: 0.671184
[00:00:18.541] train iteration 9012 : loss : 0.675560, loss_ce: 0.909632
[00:00:40.203] val epoch 67 : f1_micro : 0.6894188476933374, f1_macro : 0.5410408463742998, tumor_f1 : 0.767395657963223, stroma_f1 : 0.5844631261295743, infla_f1 : 0.6349559927048782, necr_f1 : 0.8757901867230733, other_f1 : 0.42561730036718975, acc_micro : 0.8757901867230733
[00:00:41.754] train iteration 9045 : loss : 0.687744, loss_ce: 1.002723
[00:01:01.491] train iteration 9095 : loss : 0.636670, loss_ce: 0.916237
[00:01:21.656] train iteration 9145 : loss : 0.764792, loss_ce: 1.024841
[00:01:43.565] val epoch 68 : f1_micro : 0.692469722032547, f1_macro : 0.5421710789203644, tumor_f1 : 0.7622879842917124, stroma_f1 : 0.5946678423219257, infla_f1 : 0.6028597733626763, necr_f1 : 0.8770024418830872, other_f1 : 0.4449662244154347, acc_micro : 0.8770024418830872
[00:01:45.026] train iteration 9178 : loss : 0.600940, loss_ce: 0.847139
[00:02:04.859] train iteration 9228 : loss : 0.557032, loss_ce: 0.775000
[00:02:25.054] train iteration 9278 : loss : 0.451031, loss_ce: 0.602798
[00:02:46.785] val epoch 69 : f1_micro : 0.6986369265450372, f1_macro : 0.515925125612153, tumor_f1 : 0.7751911812358432, stroma_f1 : 0.6027856681081983, infla_f1 : 0.5665032293026646, necr_f1 : 0.8794859276877509, other_f1 : 0.40726609552899995, acc_micro : 0.8794859276877509
[00:02:48.290] train iteration 9311 : loss : 0.567616, loss_ce: 0.748292
[00:03:08.026] train iteration 9361 : loss : 0.803501, loss_ce: 1.147887
[00:03:28.239] train iteration 9411 : loss : 0.496413, loss_ce: 0.721242
[00:03:49.838] val epoch 70 : f1_micro : 0.6926653590467241, f1_macro : 0.526553373866611, tumor_f1 : 0.7461418390274048, stroma_f1 : 0.6245772086911732, infla_f1 : 0.5386710681849056, necr_f1 : 0.8771193835470411, other_f1 : 0.4307985319031609, acc_micro : 0.8771193835470411
[00:03:51.327] train iteration 9444 : loss : 0.451490, loss_ce: 0.482358
[00:04:11.136] train iteration 9494 : loss : 0.495688, loss_ce: 0.647973
[00:04:31.339] train iteration 9544 : loss : 0.557873, loss_ce: 0.686750
[00:04:52.998] val epoch 71 : f1_micro : 0.7164341767628988, f1_macro : 0.5525234036975437, tumor_f1 : 0.7657591773404016, stroma_f1 : 0.6329409701956643, infla_f1 : 0.6231451279587216, necr_f1 : 0.8865906967057122, other_f1 : 0.46109660930103724, acc_micro : 0.8865906967057122
[00:04:54.499] train iteration 9577 : loss : 0.586576, loss_ce: 0.763040
[00:05:14.367] train iteration 9627 : loss : 0.666988, loss_ce: 0.994756
[00:05:34.583] train iteration 9677 : loss : 0.598438, loss_ce: 0.815280
[00:05:56.520] val epoch 72 : f1_micro : 0.6687126457691193, f1_macro : 0.5051498025655746, tumor_f1 : 0.7226303504572974, stroma_f1 : 0.598306503560808, infla_f1 : 0.5648452452901337, necr_f1 : 0.8675341063075596, other_f1 : 0.4185312803187925, acc_micro : 0.8675341063075596
[00:05:57.954] train iteration 9710 : loss : 0.641546, loss_ce: 0.863173
[00:06:17.725] train iteration 9760 : loss : 0.608638, loss_ce: 0.904333
[00:06:37.898] train iteration 9810 : loss : 0.587103, loss_ce: 0.670203
[00:06:59.930] val epoch 73 : f1_micro : 0.702727097272873, f1_macro : 0.5414992703331841, tumor_f1 : 0.7648871335718367, stroma_f1 : 0.6290755530198415, infla_f1 : 0.5710974137816164, necr_f1 : 0.8811191929711236, other_f1 : 0.4384512333872004, acc_micro : 0.8811191929711236
[00:07:01.515] train iteration 9843 : loss : 0.529974, loss_ce: 0.703107
[00:07:21.248] train iteration 9893 : loss : 0.694501, loss_ce: 1.037461
[00:07:41.441] train iteration 9943 : loss : 0.497968, loss_ce: 0.672010
[00:08:03.293] val epoch 74 : f1_micro : 0.651842807398902, f1_macro : 0.48475720749961004, tumor_f1 : 0.7410597662130992, stroma_f1 : 0.49069116330809065, infla_f1 : 0.5818825916283661, necr_f1 : 0.8607574754291111, other_f1 : 0.42291928973669807, acc_micro : 0.8607574754291111
[00:08:04.902] train iteration 9976 : loss : 0.624821, loss_ce: 0.878950
[00:08:24.601] train iteration 10026 : loss : 0.696804, loss_ce: 1.061118
[00:08:44.850] train iteration 10076 : loss : 0.606931, loss_ce: 0.841200
[00:09:06.647] val epoch 75 : f1_micro : 0.6822701315085093, f1_macro : 0.5333596799108717, tumor_f1 : 0.7555874367554982, stroma_f1 : 0.5863984199033843, infla_f1 : 0.5815830482376947, necr_f1 : 0.8729243689113193, other_f1 : 0.4310381576936278, acc_micro : 0.8729243689113193
[00:09:08.131] train iteration 10109 : loss : 0.501096, loss_ce: 0.590117
[00:09:27.898] train iteration 10159 : loss : 0.496304, loss_ce: 0.741152
[00:09:48.126] train iteration 10209 : loss : 0.591324, loss_ce: 0.757563
[00:10:10.022] val epoch 76 : f1_micro : 0.6695269604523977, f1_macro : 0.5262533552116818, tumor_f1 : 0.7345290170775519, stroma_f1 : 0.5455722911490335, infla_f1 : 0.5832519783327977, necr_f1 : 0.8678229875034756, other_f1 : 0.4495500075320403, acc_micro : 0.8678229875034756
[00:10:11.605] train iteration 10242 : loss : 0.469873, loss_ce: 0.595832
[00:10:31.401] train iteration 10292 : loss : 0.448372, loss_ce: 0.544513
[00:10:51.608] train iteration 10342 : loss : 0.586069, loss_ce: 0.669059
[00:11:13.458] val epoch 77 : f1_micro : 0.7057918118105995, f1_macro : 0.5522703329722086, tumor_f1 : 0.7667831407652961, stroma_f1 : 0.6232559136839376, infla_f1 : 0.5760729130771425, necr_f1 : 0.8823310905032687, other_f1 : 0.477847921434376, acc_micro : 0.8823310905032687
[00:11:14.934] train iteration 10375 : loss : 0.489427, loss_ce: 0.593136
[00:11:34.685] train iteration 10425 : loss : 0.495123, loss_ce: 0.625236
[00:11:54.809] train iteration 10475 : loss : 0.721882, loss_ce: 1.004624
[00:12:16.765] val epoch 78 : f1_micro : 0.6802917162577311, f1_macro : 0.51632020175457, tumor_f1 : 0.7599552505546145, stroma_f1 : 0.5597155777944459, infla_f1 : 0.5787136321680413, necr_f1 : 0.8721349451276991, other_f1 : 0.4249389324473062, acc_micro : 0.8721349451276991
[00:12:18.210] train iteration 10508 : loss : 0.441097, loss_ce: 0.605395
[00:12:37.958] train iteration 10558 : loss : 0.561698, loss_ce: 0.772008
[00:12:58.231] train iteration 10608 : loss : 0.590709, loss_ce: 0.902547
[00:13:19.880] val epoch 79 : f1_micro : 0.6934024863772922, f1_macro : 0.5372396949264738, tumor_f1 : 0.7689438819885254, stroma_f1 : 0.6015148266632524, infla_f1 : 0.6184376178516282, necr_f1 : 0.87738622824351, other_f1 : 0.4641673164235221, acc_micro : 0.87738622824351
[00:13:21.372] train iteration 10641 : loss : 0.529327, loss_ce: 0.828719
[00:13:41.099] train iteration 10691 : loss : 0.631545, loss_ce: 0.786108
[00:14:01.289] train iteration 10741 : loss : 0.443632, loss_ce: 0.563790
[00:14:23.076] val epoch 80 : f1_micro : 0.6903432587782542, f1_macro : 0.542395148674647, tumor_f1 : 0.763161532746421, stroma_f1 : 0.5887323727210363, infla_f1 : 0.5999381677971946, necr_f1 : 0.8761520544687907, other_f1 : 0.45715122965888844, acc_micro : 0.8761520544687907
[00:14:24.555] train iteration 10774 : loss : 0.670247, loss_ce: 0.994461
[00:14:44.313] train iteration 10824 : loss : 0.459274, loss_ce: 0.608667
[00:15:04.630] train iteration 10874 : loss : 0.833497, loss_ce: 1.226450
[00:15:26.291] val epoch 81 : f1_micro : 0.6881843394703335, f1_macro : 0.5257084051767985, tumor_f1 : 0.7683658050166235, stroma_f1 : 0.5943246389428775, infla_f1 : 0.5494270978521348, necr_f1 : 0.8752935197618272, other_f1 : 0.443748467332787, acc_micro : 0.8752935197618272
[00:15:27.797] train iteration 10907 : loss : 0.596459, loss_ce: 0.784898
[00:15:47.548] train iteration 10957 : loss : 0.637131, loss_ce: 0.854085
[00:16:07.699] train iteration 11007 : loss : 0.429849, loss_ce: 0.668423
[00:16:29.701] val epoch 82 : f1_micro : 0.7115326152907477, f1_macro : 0.5547062940067715, tumor_f1 : 0.7657188567850325, stroma_f1 : 0.631662533680598, infla_f1 : 0.5796641409992137, necr_f1 : 0.884627538257175, other_f1 : 0.4335221086939176, acc_micro : 0.884627538257175
[00:16:31.167] train iteration 11040 : loss : 0.581350, loss_ce: 0.604049
[00:16:50.884] train iteration 11090 : loss : 0.366184, loss_ce: 0.546169
[00:17:11.227] train iteration 11140 : loss : 0.784266, loss_ce: 1.095233
[00:17:32.938] val epoch 83 : f1_micro : 0.708462784687678, f1_macro : 0.5492125335666869, tumor_f1 : 0.7718518541918861, stroma_f1 : 0.6249756392505433, infla_f1 : 0.6200609023372332, necr_f1 : 0.8833975580003527, other_f1 : 0.46132930134319594, acc_micro : 0.8833975580003527
[00:17:34.438] train iteration 11173 : loss : 0.464594, loss_ce: 0.569985
[00:17:54.160] train iteration 11223 : loss : 0.826001, loss_ce: 1.142118
[00:18:14.270] train iteration 11273 : loss : 0.433446, loss_ce: 0.598117
[00:18:36.383] val epoch 84 : f1_micro : 0.7061292635069953, f1_macro : 0.5505022121800317, tumor_f1 : 0.7684427645471361, stroma_f1 : 0.6093466225597594, infla_f1 : 0.5973629889802801, necr_f1 : 0.8824715150727166, other_f1 : 0.43845287362734475, acc_micro : 0.8824715150727166
[00:18:37.881] train iteration 11306 : loss : 0.649657, loss_ce: 0.914824
[00:18:57.613] train iteration 11356 : loss : 0.504520, loss_ce: 0.643765
[00:19:17.759] train iteration 11406 : loss : 0.426030, loss_ce: 0.618177
[00:19:39.777] val epoch 85 : f1_micro : 0.6951889236768086, f1_macro : 0.5285187953048283, tumor_f1 : 0.7681156622038947, stroma_f1 : 0.6015254792239931, infla_f1 : 0.5330009456310008, necr_f1 : 0.8780997077624003, other_f1 : 0.43522590057303506, acc_micro : 0.8780997077624003
[00:19:41.283] train iteration 11439 : loss : 0.533995, loss_ce: 0.665339
[00:20:00.974] train iteration 11489 : loss : 0.491152, loss_ce: 0.598942
[00:20:21.214] train iteration 11539 : loss : 0.420240, loss_ce: 0.581802
[00:20:43.189] val epoch 86 : f1_micro : 0.6931233180893792, f1_macro : 0.5359390298525493, tumor_f1 : 0.7674871166547139, stroma_f1 : 0.5782308912939496, infla_f1 : 0.5744851251029306, necr_f1 : 0.8772627512613932, other_f1 : 0.38585888458312384, acc_micro : 0.8772627512613932
[00:20:44.717] train iteration 11572 : loss : 0.684681, loss_ce: 1.015634
[00:21:04.512] train iteration 11622 : loss : 0.564397, loss_ce: 0.775639
[00:21:24.764] train iteration 11672 : loss : 0.645403, loss_ce: 0.945403
[00:21:46.644] val epoch 87 : f1_micro : 0.7009196420510609, f1_macro : 0.5426878902647231, tumor_f1 : 0.7707218892044492, stroma_f1 : 0.6016927474074893, infla_f1 : 0.6083225256866879, necr_f1 : 0.8803884625434876, other_f1 : 0.419031425855226, acc_micro : 0.8803884625434876
[00:21:48.163] train iteration 11705 : loss : 0.504950, loss_ce: 0.701788
[00:22:07.941] train iteration 11755 : loss : 0.522275, loss_ce: 0.711780
[00:22:28.174] train iteration 11805 : loss : 0.540676, loss_ce: 0.753586
[00:22:50.011] val epoch 88 : f1_micro : 0.6774382783306969, f1_macro : 0.5357406516869863, tumor_f1 : 0.7506637897756364, stroma_f1 : 0.5640658842192756, infla_f1 : 0.5564894602530532, necr_f1 : 0.8709890047709147, other_f1 : 0.4766232087432096, acc_micro : 0.8709890047709147
[00:22:51.549] train iteration 11838 : loss : 0.579847, loss_ce: 0.712701
[00:23:11.372] train iteration 11888 : loss : 0.505500, loss_ce: 0.622469
[00:23:31.524] train iteration 11938 : loss : 0.549916, loss_ce: 0.735077
[00:23:53.328] val epoch 89 : f1_micro : 0.7158779369460212, f1_macro : 0.5760174989700317, tumor_f1 : 0.7685318132241566, stroma_f1 : 0.6255647658266955, infla_f1 : 0.6078374186375489, necr_f1 : 0.8863668441772461, other_f1 : 0.4400463298790985, acc_micro : 0.8863668441772461
[00:23:54.851] train iteration 11971 : loss : 0.436053, loss_ce: 0.510628
[00:24:14.555] train iteration 12021 : loss : 0.528867, loss_ce: 0.743060
[00:24:34.929] train iteration 12071 : loss : 0.615179, loss_ce: 0.719647
[00:24:56.691] val epoch 90 : f1_micro : 0.6874858584668901, f1_macro : 0.5312624355157216, tumor_f1 : 0.7645864347616832, stroma_f1 : 0.5709234250916375, infla_f1 : 0.5958279627064864, necr_f1 : 0.875012191136678, other_f1 : 0.40523706709759105, acc_micro : 0.875012191136678
[00:24:58.105] train iteration 12104 : loss : 0.446121, loss_ce: 0.583795
[00:25:17.951] train iteration 12154 : loss : 0.459185, loss_ce: 0.637208
[00:25:38.239] train iteration 12204 : loss : 0.689651, loss_ce: 0.927070
[00:26:00.210] val epoch 91 : f1_micro : 0.7008033494154612, f1_macro : 0.5484400861793094, tumor_f1 : 0.7579801559448243, stroma_f1 : 0.6066574580760465, infla_f1 : 0.6088904132445653, necr_f1 : 0.8803393734825982, other_f1 : 0.45532174713702667, acc_micro : 0.8803393734825982
[00:26:01.728] train iteration 12237 : loss : 0.636102, loss_ce: 0.826029
[00:26:21.577] train iteration 12287 : loss : 0.553221, loss_ce: 0.699662
[00:26:41.759] train iteration 12337 : loss : 0.470589, loss_ce: 0.599890
[00:27:03.527] val epoch 92 : f1_micro : 0.6985869699054295, f1_macro : 0.5331498232152727, tumor_f1 : 0.7665865209367541, stroma_f1 : 0.6015466580788295, infla_f1 : 0.5923056102461285, necr_f1 : 0.8794702582889133, other_f1 : 0.4352494771178398, acc_micro : 0.8794702582889133
[00:27:05.091] train iteration 12370 : loss : 0.511993, loss_ce: 0.581066
[00:27:24.897] train iteration 12420 : loss : 0.518561, loss_ce: 0.640342
[00:27:45.216] train iteration 12470 : loss : 0.515510, loss_ce: 0.684935
[00:28:06.813] val epoch 93 : f1_micro : 0.7110431790351868, f1_macro : 0.5544686224725511, tumor_f1 : 0.7782677120632595, stroma_f1 : 0.6324397315581639, infla_f1 : 0.5498492215656572, necr_f1 : 0.8844358801841736, other_f1 : 0.4610685424672233, acc_micro : 0.8844358801841736
[00:28:08.308] train iteration 12503 : loss : 0.786753, loss_ce: 1.124813
[00:28:28.088] train iteration 12553 : loss : 0.625839, loss_ce: 0.793193
[00:28:48.389] train iteration 12603 : loss : 0.684528, loss_ce: 0.989937
[00:29:10.056] val epoch 94 : f1_micro : 0.7046543227301704, f1_macro : 0.5570237318674723, tumor_f1 : 0.7668360756503211, stroma_f1 : 0.6367773139642344, infla_f1 : 0.5384700235375527, necr_f1 : 0.8818762845463223, other_f1 : 0.4340474092298084, acc_micro : 0.8818762845463223
[00:29:11.453] train iteration 12636 : loss : 0.577149, loss_ce: 0.863256
[00:29:31.407] train iteration 12686 : loss : 0.639037, loss_ce: 0.846658
[00:29:51.588] train iteration 12736 : loss : 0.390252, loss_ce: 0.585902
[00:30:13.440] val epoch 95 : f1_micro : 0.6959134267436133, f1_macro : 0.5408964587582482, tumor_f1 : 0.7667353822125329, stroma_f1 : 0.595490085085233, infla_f1 : 0.6159087996102042, necr_f1 : 0.8783770402272543, other_f1 : 0.4291785691554348, acc_micro : 0.8783770402272543
[00:30:14.915] train iteration 12769 : loss : 0.562512, loss_ce: 0.713346
[00:30:34.652] train iteration 12819 : loss : 0.579745, loss_ce: 0.842335
[00:30:54.803] train iteration 12869 : loss : 0.487393, loss_ce: 0.502520
[00:31:16.610] val epoch 96 : f1_micro : 0.7126516328917609, f1_macro : 0.5453502383497026, tumor_f1 : 0.7756537795066833, stroma_f1 : 0.6281344592571259, infla_f1 : 0.5901668105921191, necr_f1 : 0.8850762645403544, other_f1 : 0.44334941164383457, acc_micro : 0.8850762645403544
[00:31:18.051] train iteration 12902 : loss : 0.631337, loss_ce: 0.861668
[00:31:37.875] train iteration 12952 : loss : 0.646718, loss_ce: 0.915600
[00:31:58.016] train iteration 13002 : loss : 0.465838, loss_ce: 0.534123
[00:32:19.815] val epoch 97 : f1_micro : 0.7224328809314304, f1_macro : 0.5796331140730117, tumor_f1 : 0.7757795082198249, stroma_f1 : 0.6349232249582807, infla_f1 : 0.6126149379544787, necr_f1 : 0.8889834615919325, other_f1 : 0.4064779526657528, acc_micro : 0.8889834615919325
[00:32:21.331] train iteration 13035 : loss : 0.475714, loss_ce: 0.698578
[00:32:41.136] train iteration 13085 : loss : 0.587701, loss_ce: 0.715290
[00:33:01.301] train iteration 13135 : loss : 0.581022, loss_ce: 0.697401
[00:33:23.408] val epoch 98 : f1_micro : 0.7073003106647068, f1_macro : 0.5631381637520261, tumor_f1 : 0.762884259223938, stroma_f1 : 0.6296819508075714, infla_f1 : 0.5849043768313196, necr_f1 : 0.8829422805044386, other_f1 : 0.46692446304692165, acc_micro : 0.8829422805044386
[00:33:24.877] train iteration 13168 : loss : 0.393276, loss_ce: 0.401814
[00:33:44.666] train iteration 13218 : loss : 0.578503, loss_ce: 0.802622
[00:34:04.806] train iteration 13268 : loss : 0.433282, loss_ce: 0.546626
[00:34:26.700] val epoch 99 : f1_micro : 0.716417811314265, f1_macro : 0.5491430746184455, tumor_f1 : 0.7784219947126176, stroma_f1 : 0.6219055446485678, infla_f1 : 0.5572545907149712, necr_f1 : 0.8865816248787775, other_f1 : 0.4387270462181833, acc_micro : 0.8865816248787775
[00:34:27.540] save model to ./logs/frac_0.5/fold_0/epoch_99.pth
[00:34:29.084] train iteration 13301 : loss : 0.434561, loss_ce: 0.634339
[00:34:48.838] train iteration 13351 : loss : 0.401384, loss_ce: 0.487046
[00:35:09.035] train iteration 13401 : loss : 0.404428, loss_ce: 0.567488
[00:35:30.606] val epoch 100 : f1_micro : 0.704010647535324, f1_macro : 0.5387813356187608, tumor_f1 : 0.7722635593679216, stroma_f1 : 0.6028664689924982, infla_f1 : 0.6138927438192897, necr_f1 : 0.8816295027732849, other_f1 : 0.43277423402501475, acc_micro : 0.8816295027732849
[00:35:32.127] train iteration 13434 : loss : 0.478419, loss_ce: 0.640151
[00:35:51.904] train iteration 13484 : loss : 0.572690, loss_ce: 0.754998
[00:36:12.308] train iteration 13534 : loss : 0.558712, loss_ce: 0.776518
[00:36:34.228] val epoch 101 : f1_micro : 0.7082603560553656, f1_macro : 0.5563280638721254, tumor_f1 : 0.7692693438794878, stroma_f1 : 0.6151657010118167, infla_f1 : 0.615076439248191, necr_f1 : 0.8833246390024821, other_f1 : 0.42392554208636285, acc_micro : 0.8833246390024821
[00:36:35.817] train iteration 13567 : loss : 0.545997, loss_ce: 0.781879
[00:36:55.593] train iteration 13617 : loss : 0.423998, loss_ce: 0.451294
[00:37:15.750] train iteration 13667 : loss : 0.358536, loss_ce: 0.409972
[00:37:37.535] val epoch 102 : f1_micro : 0.7061444408363766, f1_macro : 0.5509219196107652, tumor_f1 : 0.7712292492389679, stroma_f1 : 0.6135298848152161, infla_f1 : 0.5871316370864709, necr_f1 : 0.8824733800358242, other_f1 : 0.4667614127198855, acc_micro : 0.8824733800358242
[00:37:38.988] train iteration 13700 : loss : 0.487674, loss_ce: 0.674807
[00:37:58.715] train iteration 13750 : loss : 0.325973, loss_ce: 0.384135
[00:38:18.924] train iteration 13800 : loss : 0.463806, loss_ce: 0.595368
[00:38:40.829] val epoch 103 : f1_micro : 0.7001770834128062, f1_macro : 0.5759613318575754, tumor_f1 : 0.7570493068959978, stroma_f1 : 0.6018281577154994, infla_f1 : 0.5405215385887358, necr_f1 : 0.8800828946961297, other_f1 : 0.5036276461349594, acc_micro : 0.8800828946961297
[00:38:42.354] train iteration 13833 : loss : 0.577042, loss_ce: 0.739624
[00:39:02.135] train iteration 13883 : loss : 0.660123, loss_ce: 0.905060
[00:39:22.335] train iteration 13933 : loss : 0.667417, loss_ce: 0.954533
[00:39:44.361] val epoch 104 : f1_micro : 0.7045586731698777, f1_macro : 0.5540783282783296, tumor_f1 : 0.7784914467069838, stroma_f1 : 0.5985257416963577, infla_f1 : 0.5888467842506038, necr_f1 : 0.8818418343861898, other_f1 : 0.4593626650878125, acc_micro : 0.8818418343861898
[00:39:45.809] train iteration 13966 : loss : 0.550648, loss_ce: 0.698574
[00:40:05.576] train iteration 14016 : loss : 0.512758, loss_ce: 0.649954
[00:40:25.704] train iteration 14066 : loss : 0.412016, loss_ce: 0.558259
[00:40:47.543] val epoch 105 : f1_micro : 0.7108586668968201, f1_macro : 0.5441933612028758, tumor_f1 : 0.7683536006344689, stroma_f1 : 0.6237679304348098, infla_f1 : 0.5669802869359652, necr_f1 : 0.8843634817335341, other_f1 : 0.455412401093377, acc_micro : 0.8843634817335341
[00:40:48.916] train iteration 14099 : loss : 0.489446, loss_ce: 0.680580
[00:41:08.769] train iteration 14149 : loss : 0.446501, loss_ce: 0.501199
[00:41:28.884] train iteration 14199 : loss : 0.494078, loss_ce: 0.685630
[00:41:50.938] val epoch 106 : f1_micro : 0.7163238459163241, f1_macro : 0.5655957910749647, tumor_f1 : 0.7750896884335412, stroma_f1 : 0.6397057693865564, infla_f1 : 0.600887437351048, necr_f1 : 0.8865428672896492, other_f1 : 0.43918168794932877, acc_micro : 0.8865428672896492
[00:41:52.454] train iteration 14232 : loss : 0.478092, loss_ce: 0.604140
[00:42:12.257] train iteration 14282 : loss : 0.369281, loss_ce: 0.475775
[00:42:32.319] train iteration 14332 : loss : 0.519911, loss_ce: 0.761981
[00:42:54.430] val epoch 107 : f1_micro : 0.7037990219063229, f1_macro : 0.5536287526289622, tumor_f1 : 0.7646870712439219, stroma_f1 : 0.6046280352605714, infla_f1 : 0.609969264931149, necr_f1 : 0.8815339538786147, other_f1 : 0.4191014806429545, acc_micro : 0.8815339538786147
[00:42:55.915] train iteration 14365 : loss : 0.368172, loss_ce: 0.558584
[00:43:15.737] train iteration 14415 : loss : 0.517326, loss_ce: 0.696668
[00:43:35.953] train iteration 14465 : loss : 0.454107, loss_ce: 0.622642
[00:43:57.780] val epoch 108 : f1_micro : 0.7146247545878093, f1_macro : 0.5597656518220901, tumor_f1 : 0.7661556671063106, stroma_f1 : 0.6314180608010954, infla_f1 : 0.5710532734791438, necr_f1 : 0.8858666155073378, other_f1 : 0.46158836119704777, acc_micro : 0.8858666155073378
[00:43:59.283] train iteration 14498 : loss : 0.623831, loss_ce: 0.891636
[00:44:19.016] train iteration 14548 : loss : 0.589983, loss_ce: 0.816953
[00:44:39.183] train iteration 14598 : loss : 0.437867, loss_ce: 0.530219
[00:45:01.119] val epoch 109 : f1_micro : 0.713775513569514, f1_macro : 0.5627460380395254, tumor_f1 : 0.7682011657290988, stroma_f1 : 0.627157199051645, infla_f1 : 0.579617607096831, necr_f1 : 0.885521740383572, other_f1 : 0.4527603410080903, acc_micro : 0.885521740383572
[00:45:02.688] train iteration 14631 : loss : 0.515678, loss_ce: 0.659890
[00:45:22.514] train iteration 14681 : loss : 0.527731, loss_ce: 0.646403
[00:45:42.593] train iteration 14731 : loss : 0.361235, loss_ce: 0.476590
[00:46:04.550] val epoch 110 : f1_micro : 0.6952718926800622, f1_macro : 0.5528887887795766, tumor_f1 : 0.7663353562355042, stroma_f1 : 0.5765411670837137, infla_f1 : 0.5968136603633563, necr_f1 : 0.8781249337726169, other_f1 : 0.4365403771400452, acc_micro : 0.8781249337726169
[00:46:05.943] train iteration 14764 : loss : 0.566058, loss_ce: 0.908235
[00:46:25.656] train iteration 14814 : loss : 0.624489, loss_ce: 0.769747
[00:46:45.922] train iteration 14864 : loss : 0.481724, loss_ce: 0.711046
[00:47:07.897] val epoch 111 : f1_micro : 0.6930264466338687, f1_macro : 0.5509121934572856, tumor_f1 : 0.7679555561807421, stroma_f1 : 0.5744030353768418, infla_f1 : 0.6061200618743896, necr_f1 : 0.8772247036298116, other_f1 : 0.432023329867257, acc_micro : 0.8772247036298116
[00:47:09.367] train iteration 14897 : loss : 0.564262, loss_ce: 0.719761
[00:47:29.099] train iteration 14947 : loss : 0.671616, loss_ce: 0.890016
[00:47:49.263] train iteration 14997 : loss : 0.551853, loss_ce: 0.719485
[00:48:11.106] val epoch 112 : f1_micro : 0.7136181467109256, f1_macro : 0.5681899527708689, tumor_f1 : 0.7661552084816827, stroma_f1 : 0.6275394588708878, infla_f1 : 0.6004441123455763, necr_f1 : 0.8854626880751716, other_f1 : 0.43942365524255567, acc_micro : 0.8854626880751716
[00:48:12.532] train iteration 15030 : loss : 0.642688, loss_ce: 0.952986
[00:48:32.327] train iteration 15080 : loss : 0.548048, loss_ce: 0.752850
[00:48:52.456] train iteration 15130 : loss : 0.644535, loss_ce: 0.955181
[00:49:14.325] val epoch 113 : f1_micro : 0.7057650890615251, f1_macro : 0.5542164163457023, tumor_f1 : 0.7782452821731567, stroma_f1 : 0.5988238241109584, infla_f1 : 0.6044094163510535, necr_f1 : 0.8823225948545668, other_f1 : 0.38939311649236413, acc_micro : 0.8823225948545668
[00:49:15.763] train iteration 15163 : loss : 0.444619, loss_ce: 0.584689
[00:49:35.559] train iteration 15213 : loss : 0.564383, loss_ce: 0.849523
[00:49:55.762] train iteration 15263 : loss : 0.443833, loss_ce: 0.580291
[00:50:17.404] val epoch 114 : f1_micro : 0.7173939367135366, f1_macro : 0.5553993437025282, tumor_f1 : 0.7709528532293107, stroma_f1 : 0.6415051622523202, infla_f1 : 0.5607391276322434, necr_f1 : 0.8869737492667304, other_f1 : 0.4511297818687227, acc_micro : 0.8869737492667304
[00:50:18.930] train iteration 15296 : loss : 0.483964, loss_ce: 0.621205
[00:50:38.673] train iteration 15346 : loss : 0.368975, loss_ce: 0.477747
[00:50:58.812] train iteration 15396 : loss : 0.600544, loss_ce: 0.827955
[00:51:20.672] val epoch 115 : f1_micro : 0.7016216735045115, f1_macro : 0.5396796186765035, tumor_f1 : 0.7628736608558231, stroma_f1 : 0.620510090721978, infla_f1 : 0.5746635720133781, necr_f1 : 0.8806643459531996, other_f1 : 0.41081072966464693, acc_micro : 0.8806643459531996
[00:51:22.110] train iteration 15429 : loss : 0.490165, loss_ce: 0.595789
[00:51:41.826] train iteration 15479 : loss : 0.555077, loss_ce: 0.664467
[00:52:02.089] train iteration 15529 : loss : 0.729802, loss_ce: 0.976261
[00:52:23.837] val epoch 116 : f1_micro : 0.7127391987376743, f1_macro : 0.5758455468548669, tumor_f1 : 0.77369138929579, stroma_f1 : 0.6202143609523774, infla_f1 : 0.5951867257141404, necr_f1 : 0.8851113372378879, other_f1 : 0.4581665207942327, acc_micro : 0.8851113372378879
[00:52:25.397] train iteration 15562 : loss : 0.606483, loss_ce: 0.744921
[00:52:45.188] train iteration 15612 : loss : 0.459277, loss_ce: 0.541292
[00:53:05.332] train iteration 15662 : loss : 0.460406, loss_ce: 0.568619
[00:53:27.148] val epoch 117 : f1_micro : 0.7144753277301789, f1_macro : 0.5600330604447259, tumor_f1 : 0.7711084372467465, stroma_f1 : 0.6233297283450763, infla_f1 : 0.5770184308290481, necr_f1 : 0.8858034253120423, other_f1 : 0.45478439943657983, acc_micro : 0.8858034253120423
[00:53:28.605] train iteration 15695 : loss : 0.404871, loss_ce: 0.524681
[00:53:48.338] train iteration 15745 : loss : 0.460605, loss_ce: 0.683758
[00:54:08.530] train iteration 15795 : loss : 0.469712, loss_ce: 0.549039
[00:54:30.335] val epoch 118 : f1_micro : 0.7033822668923272, f1_macro : 0.5591695679558648, tumor_f1 : 0.7718203511503008, stroma_f1 : 0.5965710824355483, infla_f1 : 0.5640370950930649, necr_f1 : 0.881370911333296, other_f1 : 0.5022041899876462, acc_micro : 0.881370911333296
[00:54:31.841] train iteration 15828 : loss : 0.485928, loss_ce: 0.734657
[00:54:51.630] train iteration 15878 : loss : 0.537683, loss_ce: 0.707172
[00:55:11.730] train iteration 15928 : loss : 0.560423, loss_ce: 0.821320
[00:55:33.533] val epoch 119 : f1_micro : 0.72409345375167, f1_macro : 0.5761340419451396, tumor_f1 : 0.776410706837972, stroma_f1 : 0.6470798240767585, infla_f1 : 0.5817427715390093, necr_f1 : 0.8896507342656453, other_f1 : 0.4410346786491573, acc_micro : 0.8896507342656453
[00:55:35.009] train iteration 15961 : loss : 0.580873, loss_ce: 0.819220
[00:55:54.762] train iteration 16011 : loss : 0.563713, loss_ce: 0.762824
[00:56:14.932] train iteration 16061 : loss : 0.361402, loss_ce: 0.549358
[00:56:36.830] val epoch 120 : f1_micro : 0.7152358671029408, f1_macro : 0.5728879723283979, tumor_f1 : 0.7701458262072669, stroma_f1 : 0.6219239185253779, infla_f1 : 0.576432329405927, necr_f1 : 0.8861104263199701, other_f1 : 0.47546562262707287, acc_micro : 0.8861104263199701
[00:56:38.325] train iteration 16094 : loss : 0.637087, loss_ce: 0.932028
[00:56:58.058] train iteration 16144 : loss : 0.676059, loss_ce: 0.911155
[00:57:18.335] train iteration 16194 : loss : 0.398140, loss_ce: 0.624375
[00:57:40.065] val epoch 121 : f1_micro : 0.727048381169637, f1_macro : 0.6038310428460439, tumor_f1 : 0.7782973057693905, stroma_f1 : 0.6464337206549114, infla_f1 : 0.5897670477628708, necr_f1 : 0.8908355606926812, other_f1 : 0.49983226953902177, acc_micro : 0.8908355606926812
[00:57:41.455] train iteration 16227 : loss : 0.377018, loss_ce: 0.439471
[00:58:01.150] train iteration 16277 : loss : 0.442648, loss_ce: 0.588893
[00:58:21.430] train iteration 16327 : loss : 0.551266, loss_ce: 0.771121
[00:58:43.271] val epoch 122 : f1_micro : 0.7016092068619199, f1_macro : 0.556965254412757, tumor_f1 : 0.7727807872825199, stroma_f1 : 0.5821506168770915, infla_f1 : 0.6241482082340453, necr_f1 : 0.8806552410125732, other_f1 : 0.4769621334142155, acc_micro : 0.8806552410125732
[00:58:44.794] train iteration 16360 : loss : 0.525369, loss_ce: 0.542994
[00:59:04.600] train iteration 16410 : loss : 0.461284, loss_ce: 0.611033
[00:59:24.804] train iteration 16460 : loss : 0.381694, loss_ce: 0.458015
[00:59:46.697] val epoch 123 : f1_micro : 0.7186227917671204, f1_macro : 0.57109132276641, tumor_f1 : 0.7757823447386424, stroma_f1 : 0.6362332532803218, infla_f1 : 0.5976297169716822, necr_f1 : 0.8874623205926683, other_f1 : 0.4415511062575711, acc_micro : 0.8874623205926683
[00:59:48.185] train iteration 16493 : loss : 0.513734, loss_ce: 0.697039
[01:00:07.922] train iteration 16543 : loss : 0.544606, loss_ce: 0.683115
[01:00:28.079] train iteration 16593 : loss : 0.701641, loss_ce: 0.873172
[01:00:49.925] val epoch 124 : f1_micro : 0.7048627886507246, f1_macro : 0.5581058637963401, tumor_f1 : 0.7744273503621419, stroma_f1 : 0.6109394898017247, infla_f1 : 0.589390641119745, necr_f1 : 0.88196286227968, other_f1 : 0.4485598825746112, acc_micro : 0.88196286227968
[01:00:51.473] train iteration 16626 : loss : 0.512221, loss_ce: 0.748936
[01:01:11.212] train iteration 16676 : loss : 0.583080, loss_ce: 0.782281
[01:01:31.310] train iteration 16726 : loss : 0.533350, loss_ce: 0.787366
[01:01:53.388] val epoch 125 : f1_micro : 0.7087016304334005, f1_macro : 0.5484557486242718, tumor_f1 : 0.7737979696856605, stroma_f1 : 0.613682169549995, infla_f1 : 0.5838002170125643, necr_f1 : 0.8834933108753629, other_f1 : 0.4305874660740503, acc_micro : 0.8834933108753629
[01:01:54.950] train iteration 16759 : loss : 0.453297, loss_ce: 0.606534
[01:02:14.651] train iteration 16809 : loss : 0.682865, loss_ce: 1.045158
[01:02:34.840] train iteration 16859 : loss : 0.500819, loss_ce: 0.676433
[01:02:56.605] val epoch 126 : f1_micro : 0.7227847622500525, f1_macro : 0.5680245975653331, tumor_f1 : 0.7785731494426728, stroma_f1 : 0.6385252853234609, infla_f1 : 0.5695660669020274, necr_f1 : 0.8891264809502496, other_f1 : 0.47842840411596826, acc_micro : 0.8891264809502496
[01:02:58.127] train iteration 16892 : loss : 0.602942, loss_ce: 0.986039
[01:03:17.898] train iteration 16942 : loss : 0.467932, loss_ce: 0.656145
[01:03:38.044] train iteration 16992 : loss : 0.331642, loss_ce: 0.484116
[01:03:59.785] val epoch 127 : f1_micro : 0.7139222681522369, f1_macro : 0.5628815558221605, tumor_f1 : 0.7742783870961931, stroma_f1 : 0.6145978760388162, infla_f1 : 0.611262544658449, necr_f1 : 0.8855818669001262, other_f1 : 0.4378309009803666, acc_micro : 0.8855818669001262
[01:04:01.336] train iteration 17025 : loss : 0.498171, loss_ce: 0.616236
[01:04:21.124] train iteration 17075 : loss : 0.661640, loss_ce: 0.962049
[01:04:41.168] train iteration 17125 : loss : 0.633849, loss_ce: 0.969100
[01:05:03.045] val epoch 128 : f1_micro : 0.7039940423435636, f1_macro : 0.5465168800618914, tumor_f1 : 0.7724970870547825, stroma_f1 : 0.6080944314599037, infla_f1 : 0.6098971918678014, necr_f1 : 0.8816158970197042, other_f1 : 0.3958335256307489, acc_micro : 0.8816158970197042
[01:05:04.577] train iteration 17158 : loss : 0.590522, loss_ce: 0.976567
[01:05:24.370] train iteration 17208 : loss : 0.572126, loss_ce: 0.848217
[01:05:44.643] train iteration 17258 : loss : 0.540607, loss_ce: 0.776573
[01:06:06.327] val epoch 129 : f1_micro : 0.731027258767022, f1_macro : 0.5849412931336297, tumor_f1 : 0.7837096916304694, stroma_f1 : 0.6544096969895893, infla_f1 : 0.5853005985005034, necr_f1 : 0.8924257715543111, other_f1 : 0.458757785293791, acc_micro : 0.8924257715543111
[01:06:07.783] train iteration 17291 : loss : 0.569492, loss_ce: 0.722810
[01:06:27.603] train iteration 17341 : loss : 0.516967, loss_ce: 0.784185
[01:06:47.685] train iteration 17391 : loss : 0.530873, loss_ce: 0.755212
[01:07:09.518] val epoch 130 : f1_micro : 0.7144107388125526, f1_macro : 0.5571974251005385, tumor_f1 : 0.7760759797361162, stroma_f1 : 0.6179158026973407, infla_f1 : 0.5981626546217336, necr_f1 : 0.8857789172066582, other_f1 : 0.43637280070947276, acc_micro : 0.8857789172066582
[01:07:10.923] train iteration 17424 : loss : 0.418607, loss_ce: 0.611978
[01:07:30.768] train iteration 17474 : loss : 0.500923, loss_ce: 0.681727
[01:07:50.953] train iteration 17524 : loss : 0.455550, loss_ce: 0.691337
[01:08:12.940] val epoch 131 : f1_micro : 0.7105606052610609, f1_macro : 0.5753198832273483, tumor_f1 : 0.7788755105601417, stroma_f1 : 0.6070501539545755, infla_f1 : 0.5949322183099058, necr_f1 : 0.88424029217826, other_f1 : 0.43531757897386947, acc_micro : 0.88424029217826
[01:08:14.415] train iteration 17557 : loss : 0.456482, loss_ce: 0.659288
[01:08:34.191] train iteration 17607 : loss : 0.638065, loss_ce: 0.991631
[01:08:54.317] train iteration 17657 : loss : 0.726160, loss_ce: 1.018175
[01:09:16.179] val epoch 132 : f1_micro : 0.7137362268235948, f1_macro : 0.5602983289294773, tumor_f1 : 0.776208739148246, stroma_f1 : 0.6164990527762307, infla_f1 : 0.5856583047244284, necr_f1 : 0.8855068922042847, other_f1 : 0.4347418559922112, acc_micro : 0.8855068922042847
[01:09:17.670] train iteration 17690 : loss : 0.413627, loss_ce: 0.466532
[01:09:37.401] train iteration 17740 : loss : 0.479420, loss_ce: 0.565470
[01:09:57.593] train iteration 17790 : loss : 0.530261, loss_ce: 0.621987
[01:10:19.585] val epoch 133 : f1_micro : 0.711800088485082, f1_macro : 0.5614971995353699, tumor_f1 : 0.7758166538344489, stroma_f1 : 0.615702168809043, infla_f1 : 0.5868729414832261, necr_f1 : 0.8847338159879049, other_f1 : 0.43470009619680544, acc_micro : 0.8847338159879049
[01:10:21.128] train iteration 17823 : loss : 0.506926, loss_ce: 0.678198
[01:10:40.838] train iteration 17873 : loss : 0.377154, loss_ce: 0.538140
[01:11:01.142] train iteration 17923 : loss : 0.484267, loss_ce: 0.641599
[01:11:23.017] val epoch 134 : f1_micro : 0.7193607403172387, f1_macro : 0.5741774254375034, tumor_f1 : 0.7772871017456054, stroma_f1 : 0.6345848275555505, infla_f1 : 0.5811512461966939, necr_f1 : 0.8877588563495212, other_f1 : 0.46680954711304773, acc_micro : 0.8877588563495212
[01:11:24.400] train iteration 17956 : loss : 0.371274, loss_ce: 0.496154
[01:11:44.177] train iteration 18006 : loss : 0.594828, loss_ce: 0.787839
[01:12:04.356] train iteration 18056 : loss : 0.465809, loss_ce: 0.644546
[01:12:26.232] val epoch 135 : f1_micro : 0.712466788954205, f1_macro : 0.5647336781024933, tumor_f1 : 0.7811156332492828, stroma_f1 : 0.6068207951055633, infla_f1 : 0.5955170258879662, necr_f1 : 0.8849984049797058, other_f1 : 0.4250363344947497, acc_micro : 0.8849984049797058
[01:12:27.703] train iteration 18089 : loss : 0.556973, loss_ce: 0.786435
[01:12:47.447] train iteration 18139 : loss : 0.490481, loss_ce: 0.714244
[01:13:07.675] train iteration 18189 : loss : 0.481103, loss_ce: 0.664831
[01:13:29.596] val epoch 136 : f1_micro : 0.718243173095915, f1_macro : 0.5677705734968186, tumor_f1 : 0.7783238940768772, stroma_f1 : 0.626609973443879, infla_f1 : 0.5630534264776442, necr_f1 : 0.8873107486300998, other_f1 : 0.45722381340132817, acc_micro : 0.8873107486300998
[01:13:31.058] train iteration 18222 : loss : 0.411526, loss_ce: 0.522179
[01:13:50.927] train iteration 18272 : loss : 0.437837, loss_ce: 0.524426
[01:14:11.090] train iteration 18322 : loss : 0.453189, loss_ce: 0.535763
[01:14:32.927] val epoch 137 : f1_micro : 0.7115134961075253, f1_macro : 0.5606777843501832, tumor_f1 : 0.767898905939526, stroma_f1 : 0.6231323869691955, infla_f1 : 0.5730561853696903, necr_f1 : 0.8846178611119588, other_f1 : 0.44139349068670225, acc_micro : 0.8846178611119588
[01:14:34.494] train iteration 18355 : loss : 0.438849, loss_ce: 0.548248
[01:14:54.271] train iteration 18405 : loss : 0.556898, loss_ce: 0.800640
[01:15:14.488] train iteration 18455 : loss : 0.552677, loss_ce: 0.696635
[01:15:36.090] val epoch 138 : f1_micro : 0.7147990259859297, f1_macro : 0.5549067397912343, tumor_f1 : 0.777241196235021, stroma_f1 : 0.6284944385290145, infla_f1 : 0.5571865712150207, necr_f1 : 0.8859376642439101, other_f1 : 0.4544142893353839, acc_micro : 0.8859376642439101
[01:15:37.689] train iteration 18488 : loss : 0.488389, loss_ce: 0.720719
[01:15:57.435] train iteration 18538 : loss : 0.403654, loss_ce: 0.367269
[01:16:17.697] train iteration 18588 : loss : 0.525716, loss_ce: 0.733889
[01:16:39.619] val epoch 139 : f1_micro : 0.7126419564088186, f1_macro : 0.5523320052358839, tumor_f1 : 0.7729084763262007, stroma_f1 : 0.6171525456839138, infla_f1 : 0.5982937006486787, necr_f1 : 0.8850709557533264, other_f1 : 0.4117690336373117, acc_micro : 0.8850709557533264
[01:16:41.145] train iteration 18621 : loss : 0.458357, loss_ce: 0.699731
[01:17:00.983] train iteration 18671 : loss : 0.324077, loss_ce: 0.496826
[01:17:21.139] train iteration 18721 : loss : 0.592890, loss_ce: 0.827212
[01:17:42.822] val epoch 140 : f1_micro : 0.7198099884721968, f1_macro : 0.572942939069536, tumor_f1 : 0.777880213658015, stroma_f1 : 0.6301361736324098, infla_f1 : 0.578630256632136, necr_f1 : 0.8879399418830871, other_f1 : 0.46465547937485907, acc_micro : 0.8879399418830871
[01:17:44.329] train iteration 18754 : loss : 0.508386, loss_ce: 0.766252
[01:18:04.117] train iteration 18804 : loss : 0.488231, loss_ce: 0.663460
[01:18:24.386] train iteration 18854 : loss : 0.357672, loss_ce: 0.385303
[01:18:46.376] val epoch 141 : f1_micro : 0.7152423785792457, f1_macro : 0.5677565170658959, tumor_f1 : 0.7780836833847894, stroma_f1 : 0.6205755045016607, infla_f1 : 0.5809608167244329, necr_f1 : 0.8861095998022291, other_f1 : 0.45083091681202253, acc_micro : 0.8861095998022291
[01:18:47.893] train iteration 18887 : loss : 0.534194, loss_ce: 0.672891
[01:19:07.598] train iteration 18937 : loss : 0.475921, loss_ce: 0.749082
[01:19:27.786] train iteration 18987 : loss : 0.638638, loss_ce: 0.739789
[01:19:49.439] val epoch 142 : f1_micro : 0.7114976697497898, f1_macro : 0.551529989308781, tumor_f1 : 0.7747452139854432, stroma_f1 : 0.6137562536531025, infla_f1 : 0.5486066166311503, necr_f1 : 0.8846144239107768, other_f1 : 0.44315964987811945, acc_micro : 0.8846144239107768
[01:19:50.909] train iteration 19020 : loss : 0.377740, loss_ce: 0.470377
[01:20:10.716] train iteration 19070 : loss : 0.423292, loss_ce: 0.559874
[01:20:30.932] train iteration 19120 : loss : 0.450846, loss_ce: 0.528497
[01:20:52.756] val epoch 143 : f1_micro : 0.7212258021036784, f1_macro : 0.5593789789411757, tumor_f1 : 0.7763033952977922, stroma_f1 : 0.6352849311298794, infla_f1 : 0.5871391791436408, necr_f1 : 0.8885030481550429, other_f1 : 0.43818722342451416, acc_micro : 0.8885030481550429
[01:20:54.205] train iteration 19153 : loss : 0.538021, loss_ce: 0.704576
[01:21:14.010] train iteration 19203 : loss : 0.451308, loss_ce: 0.586239
[01:21:34.130] train iteration 19253 : loss : 0.504678, loss_ce: 0.796573
[01:21:56.015] val epoch 144 : f1_micro : 0.7159489724371169, f1_macro : 0.5605571905771891, tumor_f1 : 0.7789474566777547, stroma_f1 : 0.6134973759452502, infla_f1 : 0.6078621346917418, necr_f1 : 0.8863931894302368, other_f1 : 0.4229641507897112, acc_micro : 0.8863931894302368
[01:21:57.502] train iteration 19286 : loss : 0.416905, loss_ce: 0.517013
[01:22:17.287] train iteration 19336 : loss : 0.364548, loss_ce: 0.463220
[01:22:37.389] train iteration 19386 : loss : 0.330961, loss_ce: 0.428996
[01:22:59.135] val epoch 145 : f1_micro : 0.7173195673359765, f1_macro : 0.5619629893038008, tumor_f1 : 0.777371832397249, stroma_f1 : 0.6257743471198611, infla_f1 : 0.5689236253499985, necr_f1 : 0.8869418528344896, other_f1 : 0.46258697029617096, acc_micro : 0.8869418528344896
[01:23:00.604] train iteration 19419 : loss : 0.421883, loss_ce: 0.589702
[01:23:20.393] train iteration 19469 : loss : 0.508976, loss_ce: 0.691377
[01:23:40.385] train iteration 19519 : loss : 0.248387, loss_ce: 0.266177
[01:24:02.333] val epoch 146 : f1_micro : 0.7210459755526648, f1_macro : 0.568262763818105, tumor_f1 : 0.7775290211041769, stroma_f1 : 0.6319206257661184, infla_f1 : 0.5841091329438819, necr_f1 : 0.8884308695793152, other_f1 : 0.4570053398609161, acc_micro : 0.8884308695793152
[01:24:03.796] train iteration 19552 : loss : 0.385684, loss_ce: 0.474845
[01:24:23.603] train iteration 19602 : loss : 0.439598, loss_ce: 0.523942
[01:24:43.757] train iteration 19652 : loss : 0.599253, loss_ce: 0.809364
[01:25:05.329] val epoch 147 : f1_micro : 0.7234957151942782, f1_macro : 0.5677574773629507, tumor_f1 : 0.7795461727513208, stroma_f1 : 0.6368722981876798, infla_f1 : 0.5749291366173161, necr_f1 : 0.8894101407792833, other_f1 : 0.44046414190282424, acc_micro : 0.8894101407792833
[01:25:06.816] train iteration 19685 : loss : 0.440914, loss_ce: 0.532379
[01:25:26.612] train iteration 19735 : loss : 0.556711, loss_ce: 0.643869
[01:25:46.776] train iteration 19785 : loss : 0.483243, loss_ce: 0.600690
[01:26:08.683] val epoch 148 : f1_micro : 0.720054112540351, f1_macro : 0.564979902903239, tumor_f1 : 0.7788772503534953, stroma_f1 : 0.6302085806926091, infla_f1 : 0.5825201270480951, necr_f1 : 0.8880342668957181, other_f1 : 0.43957128232965864, acc_micro : 0.8880342668957181
[01:26:10.244] train iteration 19818 : loss : 0.475975, loss_ce: 0.654491
[01:26:30.105] train iteration 19868 : loss : 0.489206, loss_ce: 0.683212
[01:26:50.232] train iteration 19918 : loss : 0.449644, loss_ce: 0.617313
[01:27:12.273] val epoch 149 : f1_micro : 0.7189181758297815, f1_macro : 0.5641570561461978, tumor_f1 : 0.7787333097722795, stroma_f1 : 0.628656788667043, infla_f1 : 0.5786092403862212, necr_f1 : 0.8875801669226753, other_f1 : 0.43829124313261775, acc_micro : 0.8875801669226753
[01:27:13.114] save model to ./logs/frac_0.5/fold_0/epoch_149.pth
[01:27:14.042] save model to ./logs/frac_0.5/fold_0/epoch_149.pth

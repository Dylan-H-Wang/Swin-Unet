[06:11:01.044] Namespace(root_path='../data/bcss/L0_1024_s512', dataset='bcss', list_dir='./lists/lists_Synapse', num_classes=6, output_dir='./logs/frac_0.5/fold_3', max_iterations=30000, max_epochs=150, batch_size=24, n_gpu=1, deterministic=0, base_lr=0.05, img_size=224, seed=1234, cfg='configs/swin_tiny_patch4_window7_224_lite.yaml', opts=None, zip=False, cache_mode='part', resume=None, accumulation_steps=None, use_checkpoint=False, amp_opt_level='O1', tag=None, eval=False, throughput=False, frac=0.5, fold=3)
[06:11:01.067] Reading 9897 files in ../data/bcss/L0_1024_s512/data.csv...
[06:11:01.080] Using fold 3 and keep 7036 train files only...
[06:11:01.080] Removing images with threshold of 0.1...
[06:11:01.081] Create train set with 6320 files...
[06:11:01.082] Use 0.5 percent of data to train: 3160!
[06:11:01.086] Reading 804 files in ../data/bcss/L0_1024_s512/val_data.csv...
[06:11:01.088] Using fold 3 and keep 257 val files only...
[06:11:01.088] Removing images with threshold of 0.1...
[06:11:01.089] Create val set with 220 files...
[06:11:01.952] 132 iterations per epoch. 19800 max iterations 
[06:11:04.717] train iteration 1 : loss : 1.276880, loss_ce: 1.908942
[06:11:24.363] train iteration 51 : loss : 0.954688, loss_ce: 1.221191
[06:11:44.173] train iteration 101 : loss : 0.897674, loss_ce: 1.115156
[06:12:00.592] val epoch 0 : f1_micro : 0.5621734282800129, f1_macro : 0.31044357270002365, tumor_f1 : 0.6189104637929371, stroma_f1 : 0.6429090829832214, infla_f1 : 0.07193297024514322, necr_f1 : 0.8254717290401459, other_f1 : 0.1429159866945286, acc_micro : 0.8254717290401459
[06:12:02.164] train iteration 133 : loss : 0.840654, loss_ce: 1.043979
[06:12:22.191] train iteration 183 : loss : 0.974580, loss_ce: 1.357859
[06:12:42.511] train iteration 233 : loss : 0.898146, loss_ce: 1.201496
[06:12:58.485] val epoch 1 : f1_micro : 0.579091734119824, f1_macro : 0.3463021389075688, tumor_f1 : 0.6250584146806172, stroma_f1 : 0.6526333232011113, infla_f1 : 0.08327964817207041, necr_f1 : 0.8319467604160309, other_f1 : 0.36498402188798146, acc_micro : 0.8319467604160309
[06:12:59.963] train iteration 265 : loss : 0.913719, loss_ce: 1.265569
[06:13:19.904] train iteration 315 : loss : 0.834505, loss_ce: 1.046613
[06:13:40.048] train iteration 365 : loss : 0.793896, loss_ce: 1.044204
[06:13:56.072] val epoch 2 : f1_micro : 0.5737600880009788, f1_macro : 0.40673139159168514, tumor_f1 : 0.6214454067604882, stroma_f1 : 0.6421442266021457, infla_f1 : 0.06743124792826295, necr_f1 : 0.8300757578441075, other_f1 : 0.34196509660354685, acc_micro : 0.8300757578441075
[06:13:57.476] train iteration 397 : loss : 0.861453, loss_ce: 1.068875
[06:14:17.315] train iteration 447 : loss : 0.746502, loss_ce: 0.917998
[06:14:37.697] train iteration 497 : loss : 0.794042, loss_ce: 1.139592
[06:14:53.667] val epoch 3 : f1_micro : 0.5475402027368546, f1_macro : 0.4138597164835249, tumor_f1 : 0.5700295439788273, stroma_f1 : 0.5863476778779712, infla_f1 : 0.31673024754439083, necr_f1 : 0.8193089067935944, other_f1 : 0.14624239364638925, acc_micro : 0.8193089067935944
[06:14:55.148] train iteration 529 : loss : 0.874633, loss_ce: 1.118887
[06:15:15.026] train iteration 579 : loss : 0.458272, loss_ce: 0.609729
[06:15:35.291] train iteration 629 : loss : 0.893147, loss_ce: 1.224030
[06:15:51.164] val epoch 4 : f1_micro : 0.5988832839897701, f1_macro : 0.48027046769857407, tumor_f1 : 0.6347466856241226, stroma_f1 : 0.6467273650424821, infla_f1 : 0.3711015566119126, necr_f1 : 0.8396214246749878, other_f1 : 0.320205311690058, acc_micro : 0.8396214246749878
[06:15:52.537] train iteration 661 : loss : 0.895080, loss_ce: 1.153533
[06:16:12.431] train iteration 711 : loss : 0.898277, loss_ce: 1.310509
[06:16:32.691] train iteration 761 : loss : 0.865516, loss_ce: 1.064518
[06:16:48.810] val epoch 5 : f1_micro : 0.6051173955202103, f1_macro : 0.4494735279253551, tumor_f1 : 0.6522912681102753, stroma_f1 : 0.6576782241463661, infla_f1 : 0.28804126458375584, necr_f1 : 0.8420942170279366, other_f1 : 0.35442295860100004, acc_micro : 0.8420942170279366
[06:16:50.306] train iteration 793 : loss : 0.830744, loss_ce: 1.104387
[06:17:10.210] train iteration 843 : loss : 0.711826, loss_ce: 0.880891
[06:17:30.226] train iteration 893 : loss : 0.864480, loss_ce: 1.142365
[06:17:46.274] val epoch 6 : f1_micro : 0.6230207490069526, f1_macro : 0.5237859657832554, tumor_f1 : 0.6571644672325679, stroma_f1 : 0.6105722678559167, infla_f1 : 0.5405591981751579, necr_f1 : 0.84927208508764, other_f1 : 0.3081207051873207, acc_micro : 0.84927208508764
[06:17:47.806] train iteration 925 : loss : 0.892198, loss_ce: 1.198762
[06:18:07.782] train iteration 975 : loss : 0.815448, loss_ce: 0.996944
[06:18:27.788] train iteration 1025 : loss : 0.738697, loss_ce: 0.894416
[06:18:43.728] val epoch 7 : f1_micro : 0.573624734367643, f1_macro : 0.4792317364897047, tumor_f1 : 0.6139333120414189, stroma_f1 : 0.599078041102205, infla_f1 : 0.23849856115079351, necr_f1 : 0.8294626644679478, other_f1 : 0.37322015734389424, acc_micro : 0.8294626644679478
[06:18:45.269] train iteration 1057 : loss : 0.650358, loss_ce: 0.842519
[06:19:05.224] train iteration 1107 : loss : 0.775402, loss_ce: 1.003773
[06:19:25.346] train iteration 1157 : loss : 0.758675, loss_ce: 1.032241
[06:19:41.353] val epoch 8 : f1_micro : 0.5598936336381095, f1_macro : 0.4142892765147345, tumor_f1 : 0.6097606952701297, stroma_f1 : 0.6102134164954934, infla_f1 : 0.12972697180729093, necr_f1 : 0.8239881864615849, other_f1 : 0.36460083292331547, acc_micro : 0.8239881864615849
[06:19:42.845] train iteration 1189 : loss : 0.853159, loss_ce: 1.132825
[06:20:02.659] train iteration 1239 : loss : 0.707493, loss_ce: 0.948813
[06:20:22.864] train iteration 1289 : loss : 0.682392, loss_ce: 0.919654
[06:20:38.818] val epoch 9 : f1_micro : 0.6606938413211277, f1_macro : 0.49039277008601595, tumor_f1 : 0.6864068806171417, stroma_f1 : 0.6638647136943681, infla_f1 : 0.5323584697076252, necr_f1 : 0.8643500634602138, other_f1 : 0.3550480327435902, acc_micro : 0.8643500634602138
[06:20:40.325] train iteration 1321 : loss : 0.767292, loss_ce: 0.969745
[06:21:00.137] train iteration 1371 : loss : 0.700471, loss_ce: 1.055238
[06:21:20.259] train iteration 1421 : loss : 0.911980, loss_ce: 1.333528
[06:21:36.299] val epoch 10 : f1_micro : 0.6303094902208873, f1_macro : 0.4821591175028256, tumor_f1 : 0.6723880767822266, stroma_f1 : 0.5622060251023088, infla_f1 : 0.5852921179362706, necr_f1 : 0.8521828268255506, other_f1 : 0.36246402455227716, acc_micro : 0.8521828268255506
[06:21:37.848] train iteration 1453 : loss : 0.769498, loss_ce: 1.108989
[06:21:57.688] train iteration 1503 : loss : 0.809471, loss_ce: 1.117213
[06:22:17.799] train iteration 1553 : loss : 0.697746, loss_ce: 0.882321
[06:22:33.856] val epoch 11 : f1_micro : 0.5634934519018445, f1_macro : 0.4082292190619877, tumor_f1 : 0.6169588757412774, stroma_f1 : 0.5476545707455703, infla_f1 : 0.33479752907961874, necr_f1 : 0.8254270681313106, other_f1 : 0.37812395421912826, acc_micro : 0.8254270681313106
[06:22:35.311] train iteration 1585 : loss : 0.768568, loss_ce: 1.130604
[06:22:55.128] train iteration 1635 : loss : 0.674792, loss_ce: 0.775037
[06:23:15.140] train iteration 1685 : loss : 0.566333, loss_ce: 0.634235
[06:23:31.395] val epoch 12 : f1_micro : 0.6495753739561353, f1_macro : 0.4762701168656349, tumor_f1 : 0.6888411790132523, stroma_f1 : 0.6117400016103473, infla_f1 : 0.5764444204313415, necr_f1 : 0.8599458847727094, other_f1 : 0.35955877548881937, acc_micro : 0.8599458847727094
[06:23:32.922] train iteration 1717 : loss : 0.814156, loss_ce: 1.180893
[06:23:52.647] train iteration 1767 : loss : 0.788188, loss_ce: 1.095683
[06:24:12.896] train iteration 1817 : loss : 0.682916, loss_ce: 0.748061
[06:24:28.872] val epoch 13 : f1_micro : 0.6266269151653562, f1_macro : 0.44442070594855715, tumor_f1 : 0.6947198254721505, stroma_f1 : 0.6194720246962139, infla_f1 : 0.46927810167627676, necr_f1 : 0.8507374695369175, other_f1 : 0.36516566787447247, acc_micro : 0.8507374695369175
[06:24:30.316] train iteration 1849 : loss : 0.656660, loss_ce: 0.926335
[06:24:50.138] train iteration 1899 : loss : 0.510022, loss_ce: 0.625809
[06:25:10.387] train iteration 1949 : loss : 0.688341, loss_ce: 0.836962
[06:25:26.411] val epoch 14 : f1_micro : 0.6271073328597205, f1_macro : 0.4404913878866604, tumor_f1 : 0.6693630367517471, stroma_f1 : 0.6285882922155517, infla_f1 : 0.5538013002702168, necr_f1 : 0.8509658234460014, other_f1 : 0.32068502330886467, acc_micro : 0.8509658234460014
[06:25:27.875] train iteration 1981 : loss : 0.907254, loss_ce: 1.234602
[06:25:47.702] train iteration 2031 : loss : 0.712302, loss_ce: 0.995812
[06:26:07.871] train iteration 2081 : loss : 0.831348, loss_ce: 1.190628
[06:26:23.793] val epoch 15 : f1_micro : 0.6266954700861659, f1_macro : 0.4583073907664844, tumor_f1 : 0.6728971472808293, stroma_f1 : 0.5788750659142222, infla_f1 : 0.5614322743245533, necr_f1 : 0.8509938163416726, other_f1 : 0.3798529143844332, acc_micro : 0.8509938163416726
[06:26:25.325] train iteration 2113 : loss : 0.701444, loss_ce: 0.911130
[06:26:45.099] train iteration 2163 : loss : 0.494089, loss_ce: 0.645350
[06:27:05.436] train iteration 2213 : loss : 0.771704, loss_ce: 1.100427
[06:27:21.458] val epoch 16 : f1_micro : 0.6412713570254189, f1_macro : 0.4781241842678615, tumor_f1 : 0.702440225652286, stroma_f1 : 0.5914981067180634, infla_f1 : 0.5979065703494209, necr_f1 : 0.8565634914806911, other_f1 : 0.3816296332183161, acc_micro : 0.8565634914806911
[06:27:22.919] train iteration 2245 : loss : 0.585944, loss_ce: 0.806210
[06:27:42.753] train iteration 2295 : loss : 0.771796, loss_ce: 1.010881
[06:28:02.968] train iteration 2345 : loss : 0.681408, loss_ce: 0.921694
[06:28:18.894] val epoch 17 : f1_micro : 0.5987872438771384, f1_macro : 0.47006881875651224, tumor_f1 : 0.6443655916622707, stroma_f1 : 0.5657427577035767, infla_f1 : 0.5273940450777965, necr_f1 : 0.8395798334053585, other_f1 : 0.39500874334148, acc_micro : 0.8395798334053585
[06:28:20.296] train iteration 2377 : loss : 0.453060, loss_ce: 0.715301
[06:28:40.138] train iteration 2427 : loss : 0.681268, loss_ce: 0.803131
[06:29:00.344] train iteration 2477 : loss : 0.720006, loss_ce: 1.053992
[06:29:16.208] val epoch 18 : f1_micro : 0.6580200812646321, f1_macro : 0.5213810758931297, tumor_f1 : 0.7050399886710303, stroma_f1 : 0.6105569931013244, infla_f1 : 0.6108416744640895, necr_f1 : 0.8632769286632538, other_f1 : 0.3922579541270222, acc_micro : 0.8632769286632538
[06:29:17.719] train iteration 2509 : loss : 0.774315, loss_ce: 0.999982
[06:29:37.607] train iteration 2559 : loss : 0.780216, loss_ce: 1.061373
[06:29:57.691] train iteration 2609 : loss : 0.637941, loss_ce: 0.842316
[06:30:13.746] val epoch 19 : f1_micro : 0.5763161523001534, f1_macro : 0.44403946293251856, tumor_f1 : 0.6880201612200055, stroma_f1 : 0.5362904673176152, infla_f1 : 0.5635211010064397, necr_f1 : 0.830574461391994, other_f1 : 0.3851500005860414, acc_micro : 0.830574461391994
[06:30:15.285] train iteration 2641 : loss : 0.672423, loss_ce: 0.835249
[06:30:35.156] train iteration 2691 : loss : 0.546961, loss_ce: 0.654144
[06:30:55.233] train iteration 2741 : loss : 0.838593, loss_ce: 1.113734
[06:31:13.117] val epoch 20 : f1_micro : 0.6724661439657211, f1_macro : 0.5441241871033397, tumor_f1 : 0.7005856569324221, stroma_f1 : 0.6481472828558513, infla_f1 : 0.6321367536272321, necr_f1 : 0.8690209431307656, other_f1 : 0.3825233695762498, acc_micro : 0.8690209431307656
[06:31:15.288] train iteration 2773 : loss : 0.620408, loss_ce: 0.763077
[06:31:36.801] train iteration 2823 : loss : 0.793858, loss_ce: 1.122030
[06:31:57.611] train iteration 2873 : loss : 0.836665, loss_ce: 1.159398
[06:32:13.826] val epoch 21 : f1_micro : 0.5865894130298069, f1_macro : 0.44522805352296146, tumor_f1 : 0.7096885804619107, stroma_f1 : 0.48221510648727417, infla_f1 : 0.6272442511149815, necr_f1 : 0.8347202369144985, other_f1 : 0.371715879799532, acc_micro : 0.8347202369144985
[06:32:15.279] train iteration 2905 : loss : 0.692850, loss_ce: 1.003551
[06:32:35.096] train iteration 2955 : loss : 0.619952, loss_ce: 0.737183
[06:32:55.325] train iteration 3005 : loss : 0.785128, loss_ce: 1.142645
[06:33:11.591] val epoch 22 : f1_micro : 0.6461566303457532, f1_macro : 0.5151402088148254, tumor_f1 : 0.6814244197947639, stroma_f1 : 0.607114062245403, infla_f1 : 0.5801831920232091, necr_f1 : 0.858467698097229, other_f1 : 0.3887554830206292, acc_micro : 0.858467698097229
[06:33:13.045] train iteration 3037 : loss : 0.768450, loss_ce: 0.887489
[06:33:32.904] train iteration 3087 : loss : 0.675644, loss_ce: 0.854541
[06:33:53.086] train iteration 3137 : loss : 0.689388, loss_ce: 0.871497
[06:34:09.154] val epoch 23 : f1_micro : 0.645074684705053, f1_macro : 0.5360646354300636, tumor_f1 : 0.7229015827178955, stroma_f1 : 0.5663282285843577, infla_f1 : 0.733664944767952, necr_f1 : 0.858075703893389, other_f1 : 0.4004912850047861, acc_micro : 0.858075703893389
[06:34:10.652] train iteration 3169 : loss : 0.677507, loss_ce: 0.824379
[06:34:30.509] train iteration 3219 : loss : 0.661554, loss_ce: 0.804326
[06:34:50.717] train iteration 3269 : loss : 0.623325, loss_ce: 0.896673
[06:35:06.842] val epoch 24 : f1_micro : 0.5418850971119744, f1_macro : 0.4101579710841179, tumor_f1 : 0.6682003523622241, stroma_f1 : 0.3836867905754064, infla_f1 : 0.5204940544707435, necr_f1 : 0.8167834537369865, other_f1 : 0.3640827577827232, acc_micro : 0.8167834537369865
[06:35:08.451] train iteration 3301 : loss : 0.554456, loss_ce: 0.737262
[06:35:28.324] train iteration 3351 : loss : 0.627859, loss_ce: 0.829622
[06:35:48.468] train iteration 3401 : loss : 0.653522, loss_ce: 0.810143
[06:36:04.504] val epoch 25 : f1_micro : 0.6406764877693993, f1_macro : 0.5140840304749352, tumor_f1 : 0.7012058219739369, stroma_f1 : 0.5987565261977059, infla_f1 : 0.6167406673942294, necr_f1 : 0.856325204883303, other_f1 : 0.3992232180067471, acc_micro : 0.856325204883303
[06:36:06.054] train iteration 3433 : loss : 0.725625, loss_ce: 0.916141
[06:36:25.914] train iteration 3483 : loss : 0.651063, loss_ce: 0.939912
[06:36:46.102] train iteration 3533 : loss : 0.633974, loss_ce: 0.841547
[06:37:02.342] val epoch 26 : f1_micro : 0.5819824572120395, f1_macro : 0.4513086405183588, tumor_f1 : 0.6746962751661029, stroma_f1 : 0.5380095352884382, infla_f1 : 0.500819423368999, necr_f1 : 0.832861602306366, other_f1 : 0.387497534177133, acc_micro : 0.832861602306366
[06:37:03.894] train iteration 3565 : loss : 0.834360, loss_ce: 1.318302
[06:37:23.674] train iteration 3615 : loss : 0.756493, loss_ce: 1.000642
[06:37:43.860] train iteration 3665 : loss : 0.687462, loss_ce: 0.981748
[06:38:00.066] val epoch 27 : f1_micro : 0.6402587890625, f1_macro : 0.49249120908124105, tumor_f1 : 0.7103943228721619, stroma_f1 : 0.5949174974645887, infla_f1 : 0.5857116792883191, necr_f1 : 0.8562567021165576, other_f1 : 0.3874879141471216, acc_micro : 0.8562567021165576
[06:38:01.563] train iteration 3697 : loss : 0.632744, loss_ce: 0.760607
[06:38:21.475] train iteration 3747 : loss : 0.703916, loss_ce: 0.840299
[06:38:41.513] train iteration 3797 : loss : 0.692246, loss_ce: 0.917094
[06:38:57.480] val epoch 28 : f1_micro : 0.6384691574743816, f1_macro : 0.5354536899498531, tumor_f1 : 0.7183838742119926, stroma_f1 : 0.5689182579517365, infla_f1 : 0.6551128391708646, necr_f1 : 0.8554406889847347, other_f1 : 0.3853385778410094, acc_micro : 0.8554406889847347
[06:38:58.919] train iteration 3829 : loss : 0.629068, loss_ce: 0.661870
[06:39:18.781] train iteration 3879 : loss : 0.750171, loss_ce: 0.997166
[06:39:38.969] train iteration 3929 : loss : 0.643454, loss_ce: 0.879009
[06:39:55.147] val epoch 29 : f1_micro : 0.6472869281257901, f1_macro : 0.48151361303670065, tumor_f1 : 0.6746646815112659, stroma_f1 : 0.6451655370848519, infla_f1 : 0.5930147575480598, necr_f1 : 0.8590907284191677, other_f1 : 0.3638669731361525, acc_micro : 0.8590907284191677
[06:39:56.636] train iteration 3961 : loss : 0.609498, loss_ce: 0.889319
[06:40:16.604] train iteration 4011 : loss : 0.560388, loss_ce: 0.780176
[06:40:36.624] train iteration 4061 : loss : 0.784451, loss_ce: 1.084257
[06:40:52.676] val epoch 30 : f1_micro : 0.609494652066912, f1_macro : 0.4745103972298758, tumor_f1 : 0.7108469371284757, stroma_f1 : 0.5462741489921298, infla_f1 : 0.5977217725345066, necr_f1 : 0.8438597449234554, other_f1 : 0.3648090354233448, acc_micro : 0.8438597449234554
[06:40:54.129] train iteration 4093 : loss : 0.612132, loss_ce: 0.762870
[06:41:14.050] train iteration 4143 : loss : 0.756147, loss_ce: 0.998981
[06:41:34.156] train iteration 4193 : loss : 0.728113, loss_ce: 0.881217
[06:41:50.224] val epoch 31 : f1_micro : 0.6214348482234138, f1_macro : 0.49863321653434206, tumor_f1 : 0.7195037539516177, stroma_f1 : 0.5370758115979177, infla_f1 : 0.7035321465560368, necr_f1 : 0.8486378278051104, other_f1 : 0.3721919719661985, acc_micro : 0.8486378278051104
[06:41:51.705] train iteration 4225 : loss : 0.510356, loss_ce: 0.667052
[06:42:11.556] train iteration 4275 : loss : 0.618406, loss_ce: 0.762960
[06:42:31.824] train iteration 4325 : loss : 0.651397, loss_ce: 0.920728
[06:42:47.774] val epoch 32 : f1_micro : 0.6730479491608483, f1_macro : 0.5498424619436264, tumor_f1 : 0.7135373843567712, stroma_f1 : 0.6546549392598016, infla_f1 : 0.6355618344885963, necr_f1 : 0.8692713848182133, other_f1 : 0.37374113007847753, acc_micro : 0.8692713848182133
[06:42:49.247] train iteration 4357 : loss : 0.717842, loss_ce: 0.986780
[06:43:09.143] train iteration 4407 : loss : 0.551797, loss_ce: 0.624216
[06:43:29.286] train iteration 4457 : loss : 0.600445, loss_ce: 0.696296
[06:43:45.395] val epoch 33 : f1_micro : 0.6528366463524955, f1_macro : 0.50974176717656, tumor_f1 : 0.7076219682182584, stroma_f1 : 0.6031545815723283, infla_f1 : 0.5947904246194022, necr_f1 : 0.8611874963556018, other_f1 : 0.3729579108101981, acc_micro : 0.8611874963556018
[06:43:46.872] train iteration 4489 : loss : 0.827049, loss_ce: 1.104414
[06:44:06.737] train iteration 4539 : loss : 0.621081, loss_ce: 0.724223
[06:44:26.838] train iteration 4589 : loss : 0.663753, loss_ce: 0.912714
[06:44:43.032] val epoch 34 : f1_micro : 0.5996202060154506, f1_macro : 0.46839659235307146, tumor_f1 : 0.7323925942182541, stroma_f1 : 0.4674899864143559, infla_f1 : 0.6507409725870404, necr_f1 : 0.8399161142962319, other_f1 : 0.370619964153905, acc_micro : 0.8399161142962319
[06:44:44.581] train iteration 4621 : loss : 0.771494, loss_ce: 1.102048
[06:45:04.334] train iteration 4671 : loss : 0.557594, loss_ce: 0.666917
[06:45:24.577] train iteration 4721 : loss : 0.748767, loss_ce: 0.871464
[06:45:40.671] val epoch 35 : f1_micro : 0.5969612587775502, f1_macro : 0.4660817746605192, tumor_f1 : 0.6866086593696049, stroma_f1 : 0.5199049269514424, infla_f1 : 0.645248955597968, necr_f1 : 0.8388700442654746, other_f1 : 0.3597141227551869, acc_micro : 0.8388700442654746
[06:45:42.120] train iteration 4753 : loss : 0.748160, loss_ce: 0.985466
[06:46:01.860] train iteration 4803 : loss : 0.584921, loss_ce: 0.858069
[06:46:22.103] train iteration 4853 : loss : 0.540978, loss_ce: 0.639928
[06:46:38.069] val epoch 36 : f1_micro : 0.6491828645978656, f1_macro : 0.5200143733194896, tumor_f1 : 0.7316417140620095, stroma_f1 : 0.5804373047181538, infla_f1 : 0.6629122367927006, necr_f1 : 0.8597184930528913, other_f1 : 0.3874536784631865, acc_micro : 0.8597184930528913
[06:46:39.575] train iteration 4885 : loss : 0.545357, loss_ce: 0.678799
[06:46:59.402] train iteration 4935 : loss : 0.679887, loss_ce: 0.906632
[06:47:19.539] train iteration 4985 : loss : 0.608388, loss_ce: 0.803817
[06:47:35.622] val epoch 37 : f1_micro : 0.6463526849235807, f1_macro : 0.495320234979902, tumor_f1 : 0.7007015688078744, stroma_f1 : 0.5901563867394414, infla_f1 : 0.6373519961323056, necr_f1 : 0.8586225254195077, other_f1 : 0.3610135093331337, acc_micro : 0.8586225254195077
[06:47:37.133] train iteration 5017 : loss : 0.727598, loss_ce: 1.000385
[06:47:56.962] train iteration 5067 : loss : 0.537104, loss_ce: 0.768957
[06:48:17.220] train iteration 5117 : loss : 0.550300, loss_ce: 0.715420
[06:48:33.232] val epoch 38 : f1_micro : 0.6468831109149116, f1_macro : 0.49581935576030184, tumor_f1 : 0.7179821346487317, stroma_f1 : 0.5886199027299881, infla_f1 : 0.6486722273486001, necr_f1 : 0.8588238230773381, other_f1 : 0.39121417089232374, acc_micro : 0.8588238230773381
[06:48:34.765] train iteration 5149 : loss : 0.658751, loss_ce: 0.802028
[06:48:54.623] train iteration 5199 : loss : 0.673894, loss_ce: 0.957755
[06:49:14.732] train iteration 5249 : loss : 0.475637, loss_ce: 0.670844
[06:49:30.856] val epoch 39 : f1_micro : 0.6375282853841782, f1_macro : 0.48945337321077076, tumor_f1 : 0.7060037383011409, stroma_f1 : 0.568035861460625, infla_f1 : 0.7062762890543256, necr_f1 : 0.855083921125957, other_f1 : 0.34661331666367395, acc_micro : 0.855083921125957
[06:49:32.304] train iteration 5281 : loss : 0.541720, loss_ce: 0.786155
[06:49:52.079] train iteration 5331 : loss : 0.497398, loss_ce: 0.686030
[06:50:12.333] train iteration 5381 : loss : 0.607628, loss_ce: 0.744530
[06:50:28.405] val epoch 40 : f1_micro : 0.6476614390100751, f1_macro : 0.5186446660331318, tumor_f1 : 0.7374526049409594, stroma_f1 : 0.5642744925405297, infla_f1 : 0.6424255690404347, necr_f1 : 0.859131361757006, other_f1 : 0.41316977994782583, acc_micro : 0.859131361757006
[06:50:29.905] train iteration 5413 : loss : 0.827619, loss_ce: 1.330979
[06:50:49.785] train iteration 5463 : loss : 0.668913, loss_ce: 0.840168
[06:51:09.958] train iteration 5513 : loss : 0.445631, loss_ce: 0.576988
[06:51:25.935] val epoch 41 : f1_micro : 0.6639655785901206, f1_macro : 0.5512614250183105, tumor_f1 : 0.7312473633459636, stroma_f1 : 0.5965402355151517, infla_f1 : 0.6993922676358905, necr_f1 : 0.8656406913484845, other_f1 : 0.37365234506848666, acc_micro : 0.8656406913484845
[06:51:27.458] train iteration 5545 : loss : 0.568741, loss_ce: 0.652357
[06:51:47.414] train iteration 5595 : loss : 0.624491, loss_ce: 0.773078
[06:52:07.605] train iteration 5645 : loss : 0.500778, loss_ce: 0.589781
[06:52:23.523] val epoch 42 : f1_micro : 0.6568838251488549, f1_macro : 0.5146956528936114, tumor_f1 : 0.726964071393013, stroma_f1 : 0.5882940962910652, infla_f1 : 0.6820785914148603, necr_f1 : 0.862848984343665, other_f1 : 0.36980099505620145, acc_micro : 0.862848984343665
[06:52:24.969] train iteration 5677 : loss : 0.589665, loss_ce: 0.729165
[06:52:44.860] train iteration 5727 : loss : 0.657331, loss_ce: 0.901212
[06:53:05.073] train iteration 5777 : loss : 0.505095, loss_ce: 0.653923
[06:53:21.133] val epoch 43 : f1_micro : 0.6036156990698406, f1_macro : 0.48441822613988605, tumor_f1 : 0.7286152392625809, stroma_f1 : 0.4833628066948482, infla_f1 : 0.6822472587227821, necr_f1 : 0.841504190649305, other_f1 : 0.3831307752324002, acc_micro : 0.841504190649305
[06:53:22.585] train iteration 5809 : loss : 0.702960, loss_ce: 0.950662
[06:53:42.528] train iteration 5859 : loss : 0.739504, loss_ce: 1.011889
[06:54:02.589] train iteration 5909 : loss : 0.694242, loss_ce: 0.932832
[06:54:18.748] val epoch 44 : f1_micro : 0.6554317985262189, f1_macro : 0.49313728085586, tumor_f1 : 0.7136068727288928, stroma_f1 : 0.6300248322742326, infla_f1 : 0.5948937418205398, necr_f1 : 0.8622110996927533, other_f1 : 0.39268883294425905, acc_micro : 0.8622110996927533
[06:54:20.299] train iteration 5941 : loss : 0.482731, loss_ce: 0.586347
[06:54:40.228] train iteration 5991 : loss : 0.534202, loss_ce: 0.752829
[06:55:00.353] train iteration 6041 : loss : 0.583325, loss_ce: 0.705374
[06:55:16.406] val epoch 45 : f1_micro : 0.6839155725070408, f1_macro : 0.5526358368141311, tumor_f1 : 0.7344800936324256, stroma_f1 : 0.63490793215377, infla_f1 : 0.65668543108872, necr_f1 : 0.8736105561256409, other_f1 : 0.407403113586562, acc_micro : 0.8736105561256409
[06:55:17.887] train iteration 6073 : loss : 0.523829, loss_ce: 0.554831
[06:55:37.696] train iteration 6123 : loss : 0.499861, loss_ce: 0.558194
[06:55:57.936] train iteration 6173 : loss : 0.641142, loss_ce: 0.628442
[06:56:14.006] val epoch 46 : f1_micro : 0.6454837726695197, f1_macro : 0.5236002738986697, tumor_f1 : 0.7279029020241329, stroma_f1 : 0.5774656576769692, infla_f1 : 0.6415638966219765, necr_f1 : 0.8582628411906106, other_f1 : 0.3774415565255497, acc_micro : 0.8582628411906106
[06:56:15.488] train iteration 6205 : loss : 0.613165, loss_ce: 0.817117
[06:56:35.301] train iteration 6255 : loss : 0.686899, loss_ce: 0.997464
[06:56:55.418] train iteration 6305 : loss : 0.662561, loss_ce: 0.944219
[06:57:11.573] val epoch 47 : f1_micro : 0.6959170166935239, f1_macro : 0.549319928245885, tumor_f1 : 0.7404289543628693, stroma_f1 : 0.6530289266790662, infla_f1 : 0.6389606265085084, necr_f1 : 0.8784421597208295, other_f1 : 0.38517880932028803, acc_micro : 0.8784421597208295
[06:57:13.073] train iteration 6337 : loss : 0.522974, loss_ce: 0.585557
[06:57:32.913] train iteration 6387 : loss : 0.478206, loss_ce: 0.667592
[06:57:52.978] train iteration 6437 : loss : 0.489995, loss_ce: 0.644439
[06:58:09.220] val epoch 48 : f1_micro : 0.6184807483639035, f1_macro : 0.5010835586913994, tumor_f1 : 0.7207528735910144, stroma_f1 : 0.5317787185776979, infla_f1 : 0.6412606835365295, necr_f1 : 0.8474587457520621, other_f1 : 0.3860607546355043, acc_micro : 0.8474587457520621
[06:58:10.739] train iteration 6469 : loss : 0.552580, loss_ce: 0.660452
[06:58:30.638] train iteration 6519 : loss : 0.497041, loss_ce: 0.590103
[06:58:50.722] train iteration 6569 : loss : 0.712283, loss_ce: 1.064295
[06:59:06.729] val epoch 49 : f1_micro : 0.626947640308312, f1_macro : 0.521415902035577, tumor_f1 : 0.7259563739810672, stroma_f1 : 0.5520397927612066, infla_f1 : 0.7238365922655378, necr_f1 : 0.8508267785821643, other_f1 : 0.39272945527253406, acc_micro : 0.8508267785821643
[06:59:08.276] train iteration 6601 : loss : 0.459845, loss_ce: 0.562276
[06:59:28.166] train iteration 6651 : loss : 0.670575, loss_ce: 0.903024
[06:59:48.399] train iteration 6701 : loss : 0.633685, loss_ce: 0.788687
[07:00:04.290] val epoch 50 : f1_micro : 0.618966027029923, f1_macro : 0.4814993515610695, tumor_f1 : 0.7114171790225166, stroma_f1 : 0.5444254300424031, infla_f1 : 0.6090617158583232, necr_f1 : 0.8476323911121914, other_f1 : 0.39466479580317226, acc_micro : 0.8476323911121914
[07:00:05.747] train iteration 6733 : loss : 0.583153, loss_ce: 0.887567
[07:00:25.560] train iteration 6783 : loss : 0.631906, loss_ce: 0.846025
[07:00:45.838] train iteration 6833 : loss : 0.662084, loss_ce: 0.983232
[07:01:01.975] val epoch 51 : f1_micro : 0.6237132166113172, f1_macro : 0.5056950513805661, tumor_f1 : 0.6938748423542295, stroma_f1 : 0.5732116677931377, infla_f1 : 0.57777096756867, necr_f1 : 0.8495434096881321, other_f1 : 0.373283743193107, acc_micro : 0.8495434096881321
[07:01:03.557] train iteration 6865 : loss : 0.793197, loss_ce: 1.199906
[07:01:23.358] train iteration 6915 : loss : 0.667996, loss_ce: 0.999358
[07:01:43.689] train iteration 6965 : loss : 0.641487, loss_ce: 0.901193
[07:01:59.759] val epoch 52 : f1_micro : 0.6908844709396362, f1_macro : 0.5734414969171796, tumor_f1 : 0.7145180915083204, stroma_f1 : 0.6581741592713765, infla_f1 : 0.6540465099470956, necr_f1 : 0.8764888388769967, other_f1 : 0.37695189468961743, acc_micro : 0.8764888388769967
[07:02:01.283] train iteration 6997 : loss : 0.709535, loss_ce: 0.973108
[07:02:21.076] train iteration 7047 : loss : 0.569417, loss_ce: 0.861321
[07:02:41.365] train iteration 7097 : loss : 0.623893, loss_ce: 0.860688
[07:02:57.359] val epoch 53 : f1_micro : 0.6101535728999546, f1_macro : 0.49800889513322283, tumor_f1 : 0.7266153927360263, stroma_f1 : 0.4986017808052046, infla_f1 : 0.6230641262871879, necr_f1 : 0.8441105825560433, other_f1 : 0.36336628028324675, acc_micro : 0.8441105825560433
[07:02:58.861] train iteration 7129 : loss : 0.526425, loss_ce: 0.858745
[07:03:18.780] train iteration 7179 : loss : 0.774294, loss_ce: 1.021239
[07:03:39.058] train iteration 7229 : loss : 0.501908, loss_ce: 0.678195
[07:03:55.094] val epoch 54 : f1_micro : 0.6595157533884048, f1_macro : 0.5051109886595181, tumor_f1 : 0.7201557968344007, stroma_f1 : 0.5965814994914191, infla_f1 : 0.6052723157086543, necr_f1 : 0.8638941475323269, other_f1 : 0.3866612058398979, acc_micro : 0.8638941475323269
[07:03:56.526] train iteration 7261 : loss : 0.505401, loss_ce: 0.710942
[07:04:16.440] train iteration 7311 : loss : 0.709412, loss_ce: 0.965539
[07:04:36.622] train iteration 7361 : loss : 0.670403, loss_ce: 0.953049
[07:04:52.811] val epoch 55 : f1_micro : 0.6557820162602833, f1_macro : 0.5337853516851153, tumor_f1 : 0.7387142947741917, stroma_f1 : 0.5728692933917046, infla_f1 : 0.6853458402412278, necr_f1 : 0.8623453634125846, other_f1 : 0.3943822309374809, acc_micro : 0.8623453634125846
[07:04:54.298] train iteration 7393 : loss : 0.564867, loss_ce: 0.773494
[07:05:14.132] train iteration 7443 : loss : 0.545780, loss_ce: 0.891218
[07:05:34.325] train iteration 7493 : loss : 0.494341, loss_ce: 0.667969
[07:05:50.354] val epoch 56 : f1_micro : 0.5935656364474978, f1_macro : 0.457640573914562, tumor_f1 : 0.7066986603396279, stroma_f1 : 0.4909009337425232, infla_f1 : 0.5706015835915293, necr_f1 : 0.8374908013003213, other_f1 : 0.3836578085153763, acc_micro : 0.8374908013003213
[07:05:51.875] train iteration 7525 : loss : 0.669403, loss_ce: 0.933270
[07:06:11.838] train iteration 7575 : loss : 0.654446, loss_ce: 0.764614
[07:06:32.086] train iteration 7625 : loss : 0.799744, loss_ce: 1.139614
[07:06:48.125] val epoch 57 : f1_micro : 0.6794894358941487, f1_macro : 0.5267149784735271, tumor_f1 : 0.7329085554395404, stroma_f1 : 0.634535306266376, infla_f1 : 0.6679079415542739, necr_f1 : 0.8718973100185394, other_f1 : 0.40561716364962713, acc_micro : 0.8718973100185394
[07:06:49.583] train iteration 7657 : loss : 0.593925, loss_ce: 0.798295
[07:07:09.521] train iteration 7707 : loss : 0.620045, loss_ce: 0.825186
[07:07:29.751] train iteration 7757 : loss : 0.730354, loss_ce: 0.950268
[07:07:45.952] val epoch 58 : f1_micro : 0.6712305290358407, f1_macro : 0.5412419076476779, tumor_f1 : 0.7468438042061669, stroma_f1 : 0.6035365153636251, infla_f1 : 0.7034810078995568, necr_f1 : 0.8685323936598641, other_f1 : 0.37588251664835426, acc_micro : 0.8685323936598641
[07:07:47.393] train iteration 7789 : loss : 0.507877, loss_ce: 0.713429
[07:08:07.212] train iteration 7839 : loss : 0.495995, loss_ce: 0.716384
[07:08:27.348] train iteration 7889 : loss : 0.517287, loss_ce: 0.699504
[07:08:43.507] val epoch 59 : f1_micro : 0.6556817921144622, f1_macro : 0.5021006315946579, tumor_f1 : 0.7260646713631493, stroma_f1 : 0.595756362591471, infla_f1 : 0.6657387961167842, necr_f1 : 0.8623169703142983, other_f1 : 0.3717909444655691, acc_micro : 0.8623169703142983
[07:08:45.086] train iteration 7921 : loss : 0.489650, loss_ce: 0.664551
[07:09:04.916] train iteration 7971 : loss : 0.572483, loss_ce: 0.778697
[07:09:25.124] train iteration 8021 : loss : 0.632537, loss_ce: 0.636355
[07:09:41.014] val epoch 60 : f1_micro : 0.6644850948027202, f1_macro : 0.5260039184774671, tumor_f1 : 0.7402403141771045, stroma_f1 : 0.5801333000085184, infla_f1 : 0.7043505159339735, necr_f1 : 0.8658493757247925, other_f1 : 0.3890899867983535, acc_micro : 0.8658493757247925
[07:09:42.500] train iteration 8053 : loss : 0.507100, loss_ce: 0.683535
[07:10:02.457] train iteration 8103 : loss : 0.549448, loss_ce: 0.616126
[07:10:22.594] train iteration 8153 : loss : 0.594228, loss_ce: 0.767230
[07:10:38.791] val epoch 61 : f1_micro : 0.6270327610628945, f1_macro : 0.496786287852696, tumor_f1 : 0.7405897613082614, stroma_f1 : 0.5388521349855832, infla_f1 : 0.6773555971615549, necr_f1 : 0.8508732702050891, other_f1 : 0.3823447844957367, acc_micro : 0.8508732702050891
[07:10:40.359] train iteration 8185 : loss : 0.609321, loss_ce: 0.794759
[07:11:00.226] train iteration 8235 : loss : 0.578166, loss_ce: 0.668895
[07:11:20.376] train iteration 8285 : loss : 0.488292, loss_ce: 0.690265
[07:11:36.352] val epoch 62 : f1_micro : 0.6715048189674105, f1_macro : 0.5332011069570269, tumor_f1 : 0.7366446384361812, stroma_f1 : 0.6097004626478467, infla_f1 : 0.6281716552163873, necr_f1 : 0.8686432455267225, other_f1 : 0.39481585738914354, acc_micro : 0.8686432455267225
[07:11:37.890] train iteration 8317 : loss : 0.405460, loss_ce: 0.572386
[07:11:57.919] train iteration 8367 : loss : 0.449549, loss_ce: 0.546736
[07:12:18.046] train iteration 8417 : loss : 0.558322, loss_ce: 0.792681
[07:12:34.131] val epoch 63 : f1_micro : 0.6052824578114918, f1_macro : 0.49679031329495565, tumor_f1 : 0.6890783246074405, stroma_f1 : 0.5282891893626324, infla_f1 : 0.6026958014283862, necr_f1 : 0.8421545795031956, other_f1 : 0.38206921198538374, acc_micro : 0.8421545795031956
[07:12:35.614] train iteration 8449 : loss : 0.547905, loss_ce: 0.674594
[07:12:55.458] train iteration 8499 : loss : 0.405666, loss_ce: 0.532630
[07:13:15.590] train iteration 8549 : loss : 0.633293, loss_ce: 0.880840
[07:13:31.718] val epoch 64 : f1_micro : 0.611987224646977, f1_macro : 0.45679832994937897, tumor_f1 : 0.739943380866732, stroma_f1 : 0.5088537564235074, infla_f1 : 0.628904002053397, necr_f1 : 0.8448423828397479, other_f1 : 0.3234188596584967, acc_micro : 0.8448423828397479
[07:13:33.329] train iteration 8581 : loss : 0.446610, loss_ce: 0.603913
[07:13:53.160] train iteration 8631 : loss : 0.484675, loss_ce: 0.789870
[07:14:13.344] train iteration 8681 : loss : 0.537272, loss_ce: 0.684444
[07:14:29.469] val epoch 65 : f1_micro : 0.6280117630958557, f1_macro : 0.4882233270577022, tumor_f1 : 0.7128835937806538, stroma_f1 : 0.552200656916414, infla_f1 : 0.6530607965375695, necr_f1 : 0.8512475277696337, other_f1 : 0.3916944970509836, acc_micro : 0.8512475277696337
[07:14:30.958] train iteration 8713 : loss : 0.527831, loss_ce: 0.736698
[07:14:50.724] train iteration 8763 : loss : 0.587183, loss_ce: 0.726814
[07:15:11.033] train iteration 8813 : loss : 0.609231, loss_ce: 0.886751
[07:15:27.191] val epoch 66 : f1_micro : 0.6413957348891667, f1_macro : 0.5125115471226829, tumor_f1 : 0.7186868148190635, stroma_f1 : 0.5748158884899957, infla_f1 : 0.5996721546564784, necr_f1 : 0.8565892619746072, other_f1 : 0.39905461030347006, acc_micro : 0.8565892619746072
[07:15:28.612] train iteration 8845 : loss : 0.350565, loss_ce: 0.467114
[07:15:48.444] train iteration 8895 : loss : 0.407582, loss_ce: 0.579538
[07:16:08.600] train iteration 8945 : loss : 0.529002, loss_ce: 0.719318
[07:16:24.694] val epoch 67 : f1_micro : 0.6250064564602715, f1_macro : 0.5199526058776038, tumor_f1 : 0.7424448004790715, stroma_f1 : 0.5346718419875417, infla_f1 : 0.6182228199842419, necr_f1 : 0.8500448720795768, other_f1 : 0.3974235389780785, acc_micro : 0.8500448720795768
[07:16:26.249] train iteration 8977 : loss : 0.448798, loss_ce: 0.500145
[07:16:46.214] train iteration 9027 : loss : 0.592922, loss_ce: 0.772231
[07:17:06.303] train iteration 9077 : loss : 0.487125, loss_ce: 0.697184
[07:17:22.496] val epoch 68 : f1_micro : 0.6201974685703006, f1_macro : 0.47986663452216555, tumor_f1 : 0.7399691598755973, stroma_f1 : 0.5070513518793243, infla_f1 : 0.661670238843986, necr_f1 : 0.84813705938203, other_f1 : 0.39441263146831523, acc_micro : 0.84813705938203
[07:17:24.033] train iteration 9109 : loss : 0.411524, loss_ce: 0.511461
[07:17:44.010] train iteration 9159 : loss : 0.356073, loss_ce: 0.409940
[07:18:04.052] train iteration 9209 : loss : 0.664998, loss_ce: 0.834062
[07:18:20.056] val epoch 69 : f1_micro : 0.6725574561527797, f1_macro : 0.5336883621556419, tumor_f1 : 0.7517731445176261, stroma_f1 : 0.6021420721496854, infla_f1 : 0.6350567014887929, necr_f1 : 0.869056224822998, other_f1 : 0.37557282937424524, acc_micro : 0.869056224822998
[07:18:21.488] train iteration 9241 : loss : 0.383738, loss_ce: 0.529365
[07:18:41.361] train iteration 9291 : loss : 0.573750, loss_ce: 0.719833
[07:19:01.574] train iteration 9341 : loss : 0.480645, loss_ce: 0.583691
[07:19:17.546] val epoch 70 : f1_micro : 0.6600000006811959, f1_macro : 0.5183685762541634, tumor_f1 : 0.7158940519605365, stroma_f1 : 0.6330396916185107, infla_f1 : 0.6264711043664387, necr_f1 : 0.8640372369970594, other_f1 : 0.3981016854023827, acc_micro : 0.8640372369970594
[07:19:18.947] train iteration 9373 : loss : 0.369308, loss_ce: 0.439207
[07:19:38.895] train iteration 9423 : loss : 0.587939, loss_ce: 0.620591
[07:19:58.963] train iteration 9473 : loss : 0.567047, loss_ce: 0.796345
[07:20:15.105] val epoch 71 : f1_micro : 0.6690291741064617, f1_macro : 0.5330420540911811, tumor_f1 : 0.7352261670998165, stroma_f1 : 0.6211091152259282, infla_f1 : 0.6704318842717579, necr_f1 : 0.8676692587988717, other_f1 : 0.37472052765744074, acc_micro : 0.8676692587988717
[07:20:16.676] train iteration 9505 : loss : 0.457684, loss_ce: 0.672200
[07:20:36.510] train iteration 9555 : loss : 0.577330, loss_ce: 0.759511
[07:20:56.669] train iteration 9605 : loss : 0.605320, loss_ce: 0.773154
[07:21:12.700] val epoch 72 : f1_micro : 0.6071092316082546, f1_macro : 0.47553551835673197, tumor_f1 : 0.7296139299869537, stroma_f1 : 0.4791833630629948, infla_f1 : 0.6532418972679547, necr_f1 : 0.842875348670142, other_f1 : 0.33126152732542585, acc_micro : 0.842875348670142
[07:21:14.193] train iteration 9637 : loss : 0.431879, loss_ce: 0.675052
[07:21:34.015] train iteration 9687 : loss : 0.625497, loss_ce: 0.863111
[07:21:54.293] train iteration 9737 : loss : 0.607649, loss_ce: 0.799236
[07:22:10.222] val epoch 73 : f1_micro : 0.6495321989059448, f1_macro : 0.49023437180689405, tumor_f1 : 0.7238078202520098, stroma_f1 : 0.5624110174498388, infla_f1 : 0.6300070754119328, necr_f1 : 0.8598714470863342, other_f1 : 0.39274356121729526, acc_micro : 0.8598714470863342
[07:22:11.789] train iteration 9769 : loss : 0.444982, loss_ce: 0.624139
[07:22:31.665] train iteration 9819 : loss : 0.491714, loss_ce: 0.588424
[07:22:51.821] train iteration 9869 : loss : 0.651502, loss_ce: 0.978278
[07:23:07.934] val epoch 74 : f1_micro : 0.6602362160171781, f1_macro : 0.5010115482977459, tumor_f1 : 0.7380824387073517, stroma_f1 : 0.580682390502521, infla_f1 : 0.6493691514645304, necr_f1 : 0.8641249367168972, other_f1 : 0.3346657763634409, acc_micro : 0.8641249367168972
[07:23:09.438] train iteration 9901 : loss : 0.702139, loss_ce: 0.850046
[07:23:29.281] train iteration 9951 : loss : 0.635383, loss_ce: 0.717464
[07:23:49.362] train iteration 10001 : loss : 0.582734, loss_ce: 0.601612
[07:24:05.568] val epoch 75 : f1_micro : 0.6895817645958492, f1_macro : 0.562539707337107, tumor_f1 : 0.7380729147366115, stroma_f1 : 0.6303082225578172, infla_f1 : 0.6694812072174889, necr_f1 : 0.8758589327335358, other_f1 : 0.40096595297966686, acc_micro : 0.8758589327335358
[07:24:07.066] train iteration 10033 : loss : 0.486399, loss_ce: 0.504548
[07:24:26.834] train iteration 10083 : loss : 0.595043, loss_ce: 0.862159
[07:24:47.057] train iteration 10133 : loss : 0.534521, loss_ce: 0.683055
[07:25:03.151] val epoch 76 : f1_micro : 0.697765690939767, f1_macro : 0.5658596796648843, tumor_f1 : 0.7508171839373452, stroma_f1 : 0.6416065543889999, infla_f1 : 0.6775567723172051, necr_f1 : 0.879158513886588, other_f1 : 0.39214769804051947, acc_micro : 0.879158513886588
[07:25:04.682] train iteration 10165 : loss : 0.626497, loss_ce: 0.814477
[07:25:24.610] train iteration 10215 : loss : 0.577400, loss_ce: 0.703967
[07:25:44.656] train iteration 10265 : loss : 0.385529, loss_ce: 0.504409
[07:26:00.788] val epoch 77 : f1_micro : 0.6684681006840297, f1_macro : 0.5584373474121094, tumor_f1 : 0.7449317233903068, stroma_f1 : 0.6076925833310399, infla_f1 : 0.6716735916478294, necr_f1 : 0.8674185190882001, other_f1 : 0.400625256555421, acc_micro : 0.8674185190882001
[07:26:02.257] train iteration 10297 : loss : 0.531040, loss_ce: 0.798554
[07:26:22.142] train iteration 10347 : loss : 0.604760, loss_ce: 0.853184
[07:26:42.248] train iteration 10397 : loss : 0.645403, loss_ce: 0.798412
[07:26:58.384] val epoch 78 : f1_micro : 0.6658251115253994, f1_macro : 0.528046435543469, tumor_f1 : 0.7059928349086216, stroma_f1 : 0.623792194894382, infla_f1 : 0.641433155962399, necr_f1 : 0.8663576713630131, other_f1 : 0.3799135824332812, acc_micro : 0.8663576713630131
[07:26:59.877] train iteration 10429 : loss : 0.694217, loss_ce: 0.865936
[07:27:19.689] train iteration 10479 : loss : 0.733318, loss_ce: 1.023040
[07:27:39.845] train iteration 10529 : loss : 0.599172, loss_ce: 0.650338
[07:27:55.843] val epoch 79 : f1_micro : 0.6503910890647343, f1_macro : 0.49384156827415737, tumor_f1 : 0.7428305659975324, stroma_f1 : 0.5639963131397963, infla_f1 : 0.5862310011205929, necr_f1 : 0.8601827067988259, other_f1 : 0.39486826181278695, acc_micro : 0.8601827067988259
[07:27:57.308] train iteration 10561 : loss : 0.481907, loss_ce: 0.552720
[07:28:17.154] train iteration 10611 : loss : 0.598033, loss_ce: 0.802525
[07:28:37.316] train iteration 10661 : loss : 0.553537, loss_ce: 0.809203
[07:28:53.378] val epoch 80 : f1_micro : 0.6897874389375959, f1_macro : 0.5482095586402076, tumor_f1 : 0.7310846958841596, stroma_f1 : 0.6558953034026282, infla_f1 : 0.6429882294365338, necr_f1 : 0.8759596475533077, other_f1 : 0.3766115772138749, acc_micro : 0.8759596475533077
[07:28:54.845] train iteration 10693 : loss : 0.528344, loss_ce: 0.684520
[07:29:14.777] train iteration 10743 : loss : 0.522422, loss_ce: 0.733073
[07:29:34.897] train iteration 10793 : loss : 0.470611, loss_ce: 0.642584
[07:29:51.080] val epoch 81 : f1_micro : 0.6234931349754333, f1_macro : 0.4955141842365265, tumor_f1 : 0.7298508818660464, stroma_f1 : 0.5267181513564927, infla_f1 : 0.6558855001681617, necr_f1 : 0.8494393357208797, other_f1 : 0.39593305425452335, acc_micro : 0.8494393357208797
[07:29:52.635] train iteration 10825 : loss : 0.476261, loss_ce: 0.638595
[07:30:12.580] train iteration 10875 : loss : 0.624418, loss_ce: 0.767764
[07:30:32.597] train iteration 10925 : loss : 0.451722, loss_ce: 0.626546
[07:30:48.596] val epoch 82 : f1_micro : 0.6238722034863063, f1_macro : 0.5023491701909474, tumor_f1 : 0.7522013293845313, stroma_f1 : 0.4971008098551205, infla_f1 : 0.6849907032155897, necr_f1 : 0.8495917447975704, other_f1 : 0.3916756608980774, acc_micro : 0.8495917447975704
[07:30:50.014] train iteration 10957 : loss : 0.691036, loss_ce: 0.963447
[07:31:09.903] train iteration 11007 : loss : 0.602796, loss_ce: 0.887713
[07:31:30.221] train iteration 11057 : loss : 0.671275, loss_ce: 0.887809
[07:31:46.359] val epoch 83 : f1_micro : 0.6696071369307381, f1_macro : 0.5312796256371907, tumor_f1 : 0.752336887376649, stroma_f1 : 0.5947119477870209, infla_f1 : 0.6486925865922656, necr_f1 : 0.8678870499134064, other_f1 : 0.40581872606916086, acc_micro : 0.8678870499134064
[07:31:47.880] train iteration 11089 : loss : 0.606784, loss_ce: 0.663981
[07:32:07.698] train iteration 11139 : loss : 0.299297, loss_ce: 0.389905
[07:32:27.922] train iteration 11189 : loss : 0.627614, loss_ce: 0.811974
[07:32:44.127] val epoch 84 : f1_micro : 0.6749578969819205, f1_macro : 0.5212987278188977, tumor_f1 : 0.7579506593091148, stroma_f1 : 0.598592680479799, infla_f1 : 0.6424883252808026, necr_f1 : 0.8700095670563834, other_f1 : 0.3847269555221179, acc_micro : 0.8700095670563834
[07:32:45.583] train iteration 11221 : loss : 0.342365, loss_ce: 0.368837
[07:33:05.427] train iteration 11271 : loss : 0.485652, loss_ce: 0.509927
[07:33:25.644] train iteration 11321 : loss : 0.670288, loss_ce: 0.851481
[07:33:41.768] val epoch 85 : f1_micro : 0.613903956753867, f1_macro : 0.47192755341529846, tumor_f1 : 0.7206061993326459, stroma_f1 : 0.5014492397895083, infla_f1 : 0.6317815056868962, necr_f1 : 0.8455866490091596, other_f1 : 0.39303168842369424, acc_micro : 0.8455866490091596
[07:33:43.248] train iteration 11353 : loss : 0.614246, loss_ce: 0.825921
[07:34:03.135] train iteration 11403 : loss : 0.448302, loss_ce: 0.633204
[07:34:23.273] train iteration 11453 : loss : 0.511502, loss_ce: 0.658286
[07:34:39.557] val epoch 86 : f1_micro : 0.6228459477424622, f1_macro : 0.49954463115760256, tumor_f1 : 0.7207845811332975, stroma_f1 : 0.5484004989266396, infla_f1 : 0.5905085442853826, necr_f1 : 0.8491771008287158, other_f1 : 0.3860531466115, acc_micro : 0.8491771008287158
[07:34:41.031] train iteration 11485 : loss : 0.403329, loss_ce: 0.573599
[07:35:00.897] train iteration 11535 : loss : 0.512271, loss_ce: 0.745475
[07:35:21.050] train iteration 11585 : loss : 0.537891, loss_ce: 0.735768
[07:35:37.332] val epoch 87 : f1_micro : 0.5990507655910083, f1_macro : 0.5008882071290698, tumor_f1 : 0.7310173256056649, stroma_f1 : 0.46937799879482817, infla_f1 : 0.6844793196235385, necr_f1 : 0.839652589389256, other_f1 : 0.3881142183711615, acc_micro : 0.839652589389256
[07:35:38.864] train iteration 11617 : loss : 0.488750, loss_ce: 0.659852
[07:35:58.819] train iteration 11667 : loss : 0.455475, loss_ce: 0.682639
[07:36:18.960] train iteration 11717 : loss : 0.452301, loss_ce: 0.602444
[07:36:35.067] val epoch 88 : f1_micro : 0.6574657814843314, f1_macro : 0.5304954860891614, tumor_f1 : 0.7269854460443769, stroma_f1 : 0.6002576798200607, infla_f1 : 0.6590212689978736, necr_f1 : 0.8630084139960152, other_f1 : 0.3916294747697456, acc_micro : 0.8630084139960152
[07:36:36.524] train iteration 11749 : loss : 0.446401, loss_ce: 0.452196
[07:36:56.515] train iteration 11799 : loss : 0.436641, loss_ce: 0.480212
[07:37:16.742] train iteration 11849 : loss : 0.586717, loss_ce: 0.826149
[07:37:32.869] val epoch 89 : f1_micro : 0.6622979428086962, f1_macro : 0.5309934062617165, tumor_f1 : 0.7286072884287152, stroma_f1 : 0.6249638838427407, infla_f1 : 0.6610487933669772, necr_f1 : 0.8649363730634961, other_f1 : 0.39572437819359557, acc_micro : 0.8649363730634961
[07:37:34.402] train iteration 11881 : loss : 0.448807, loss_ce: 0.552155
[07:37:54.221] train iteration 11931 : loss : 0.542539, loss_ce: 0.685761
[07:38:14.506] train iteration 11981 : loss : 0.310212, loss_ce: 0.379305
[07:38:30.516] val epoch 90 : f1_micro : 0.6338059306144714, f1_macro : 0.4927588381937572, tumor_f1 : 0.7311302551201412, stroma_f1 : 0.5529018299920219, infla_f1 : 0.6208709457090923, necr_f1 : 0.8535475347723279, other_f1 : 0.3273490388611598, acc_micro : 0.8535475347723279
[07:38:31.989] train iteration 12013 : loss : 0.322642, loss_ce: 0.410077
[07:38:52.012] train iteration 12063 : loss : 0.603007, loss_ce: 0.924283
[07:39:12.203] train iteration 12113 : loss : 0.624738, loss_ce: 0.834638
[07:39:28.380] val epoch 91 : f1_micro : 0.6377009217228208, f1_macro : 0.4842656393136297, tumor_f1 : 0.7303952361856189, stroma_f1 : 0.5623839518853596, infla_f1 : 0.6471387360777173, necr_f1 : 0.8551109475748879, other_f1 : 0.3235140897366883, acc_micro : 0.8551109475748879
[07:39:29.811] train iteration 12145 : loss : 0.612068, loss_ce: 0.822531
[07:39:49.676] train iteration 12195 : loss : 0.512501, loss_ce: 0.659545
[07:40:09.816] train iteration 12245 : loss : 0.388003, loss_ce: 0.402999
[07:40:25.984] val epoch 92 : f1_micro : 0.672923567039626, f1_macro : 0.5325887841837746, tumor_f1 : 0.7464013951165336, stroma_f1 : 0.6266164141041892, infla_f1 : 0.6669662456427302, necr_f1 : 0.8691888110978263, other_f1 : 0.39974655297451783, acc_micro : 0.8691888110978263
[07:40:27.480] train iteration 12277 : loss : 0.612325, loss_ce: 0.745581
[07:40:47.531] train iteration 12327 : loss : 0.409775, loss_ce: 0.512169
[07:41:07.579] train iteration 12377 : loss : 0.640109, loss_ce: 0.826641
[07:41:23.717] val epoch 93 : f1_micro : 0.6340014785528183, f1_macro : 0.48177337859358105, tumor_f1 : 0.7443259869303022, stroma_f1 : 0.5211012443261487, infla_f1 : 0.5913399591343997, necr_f1 : 0.8536314836570195, other_f1 : 0.38234384381212294, acc_micro : 0.8536314836570195
[07:41:25.129] train iteration 12409 : loss : 0.440789, loss_ce: 0.623215
[07:41:45.177] train iteration 12459 : loss : 0.564924, loss_ce: 0.637977
[07:42:05.286] train iteration 12509 : loss : 0.684978, loss_ce: 0.825754
[07:42:21.331] val epoch 94 : f1_micro : 0.6552459640162331, f1_macro : 0.5049090683460236, tumor_f1 : 0.7330931999853679, stroma_f1 : 0.5654616206884384, infla_f1 : 0.6509443776948112, necr_f1 : 0.8621349973337991, other_f1 : 0.3766755310685507, acc_micro : 0.8621349973337991
[07:42:22.936] train iteration 12541 : loss : 0.508412, loss_ce: 0.741059
[07:42:42.786] train iteration 12591 : loss : 0.686059, loss_ce: 0.895217
[07:43:03.059] train iteration 12641 : loss : 0.419509, loss_ce: 0.492004
[07:43:19.156] val epoch 95 : f1_micro : 0.6859042005879539, f1_macro : 0.5563918054103851, tumor_f1 : 0.7431901480470385, stroma_f1 : 0.6480213063103812, infla_f1 : 0.6818000589098249, necr_f1 : 0.8743877708911896, other_f1 : 0.40134378602462156, acc_micro : 0.8743877708911896
[07:43:20.655] train iteration 12673 : loss : 0.343664, loss_ce: 0.458970
[07:43:40.657] train iteration 12723 : loss : 0.415852, loss_ce: 0.479359
[07:44:00.792] train iteration 12773 : loss : 0.436989, loss_ce: 0.541498
[07:44:16.866] val epoch 96 : f1_micro : 0.6733496146542686, f1_macro : 0.5381143114396504, tumor_f1 : 0.7252717273575919, stroma_f1 : 0.6374626117093223, infla_f1 : 0.6578137076326779, necr_f1 : 0.8693619455610003, other_f1 : 0.4103092221277101, acc_micro : 0.8693619455610003
[07:44:18.400] train iteration 12805 : loss : 0.537406, loss_ce: 0.714105
[07:44:38.225] train iteration 12855 : loss : 0.640546, loss_ce: 0.765081
[07:44:58.546] train iteration 12905 : loss : 0.672159, loss_ce: 0.931088
[07:45:14.640] val epoch 97 : f1_micro : 0.655698469706944, f1_macro : 0.5303304259266172, tumor_f1 : 0.7435118683746883, stroma_f1 : 0.5754343494772911, infla_f1 : 0.7106151186994144, necr_f1 : 0.8623137814658028, other_f1 : 0.36045899991378455, acc_micro : 0.8623137814658028
[07:45:16.145] train iteration 12937 : loss : 0.370740, loss_ce: 0.466946
[07:45:36.120] train iteration 12987 : loss : 0.399056, loss_ce: 0.501542
[07:45:56.268] train iteration 13037 : loss : 0.439856, loss_ce: 0.496837
[07:46:12.369] val epoch 98 : f1_micro : 0.667107458625521, f1_macro : 0.5314830052001136, tumor_f1 : 0.7392752447298595, stroma_f1 : 0.6124556639364788, infla_f1 : 0.6462962254881859, necr_f1 : 0.8668703990323203, other_f1 : 0.39789700910582076, acc_micro : 0.8668703990323203
[07:46:13.865] train iteration 13069 : loss : 0.408449, loss_ce: 0.467898
[07:46:33.623] train iteration 13119 : loss : 0.634329, loss_ce: 0.988733
[07:46:53.892] train iteration 13169 : loss : 0.404264, loss_ce: 0.434823
[07:47:10.088] val epoch 99 : f1_micro : 0.6364121926682336, f1_macro : 0.49579022186143057, tumor_f1 : 0.7508859208651951, stroma_f1 : 0.5248626247048378, infla_f1 : 0.6837838441133499, necr_f1 : 0.8546187196459089, other_f1 : 0.400727632788143, acc_micro : 0.8546187196459089
[07:47:10.999] save model to ./logs/frac_0.5/fold_3/epoch_99.pth
[07:47:12.446] train iteration 13201 : loss : 0.238229, loss_ce: 0.292980
[07:47:32.288] train iteration 13251 : loss : 0.507155, loss_ce: 0.779638
[07:47:52.548] train iteration 13301 : loss : 0.543023, loss_ce: 0.717822
[07:48:08.474] val epoch 100 : f1_micro : 0.6650531653847013, f1_macro : 0.535923685346331, tumor_f1 : 0.7298563101461956, stroma_f1 : 0.6063103782279151, infla_f1 : 0.6567357134606157, necr_f1 : 0.8660443765776498, other_f1 : 0.38517671703760115, acc_micro : 0.8660443765776498
[07:48:10.051] train iteration 13333 : loss : 0.551731, loss_ce: 0.699546
[07:48:29.935] train iteration 13383 : loss : 0.640934, loss_ce: 0.894950
[07:48:50.185] train iteration 13433 : loss : 0.425264, loss_ce: 0.634587
[07:49:06.159] val epoch 101 : f1_micro : 0.6616845450231007, f1_macro : 0.541576868721417, tumor_f1 : 0.7411126664706639, stroma_f1 : 0.5936996415257454, infla_f1 : 0.7003359305007117, necr_f1 : 0.8646988996437618, other_f1 : 0.3990175649523735, acc_micro : 0.8646988996437618
[07:49:07.608] train iteration 13465 : loss : 0.488856, loss_ce: 0.502213
[07:49:27.515] train iteration 13515 : loss : 0.446700, loss_ce: 0.451419
[07:49:47.764] train iteration 13565 : loss : 0.403407, loss_ce: 0.488869
[07:50:03.794] val epoch 102 : f1_micro : 0.6792136984212058, f1_macro : 0.5213420476232257, tumor_f1 : 0.7387221562010902, stroma_f1 : 0.6194166668823787, infla_f1 : 0.6837339316095624, necr_f1 : 0.8717074734824044, other_f1 : 0.392154864434685, acc_micro : 0.8717074734824044
[07:50:05.256] train iteration 13597 : loss : 0.470596, loss_ce: 0.591833
[07:50:25.197] train iteration 13647 : loss : 0.492889, loss_ce: 0.727147
[07:50:45.370] train iteration 13697 : loss : 0.354731, loss_ce: 0.474856
[07:51:01.586] val epoch 103 : f1_micro : 0.6747293216841561, f1_macro : 0.5147214563829559, tumor_f1 : 0.7201049966471536, stroma_f1 : 0.6481706936444555, infla_f1 : 0.5419074424675533, necr_f1 : 0.869921590600695, other_f1 : 0.39649711263232995, acc_micro : 0.869921590600695
[07:51:03.126] train iteration 13729 : loss : 0.489732, loss_ce: 0.631945
[07:51:23.003] train iteration 13779 : loss : 0.438247, loss_ce: 0.501181
[07:51:43.160] train iteration 13829 : loss : 0.575258, loss_ce: 0.775536
[07:51:59.329] val epoch 104 : f1_micro : 0.6895898027079446, f1_macro : 0.557135956627982, tumor_f1 : 0.7261134151901517, stroma_f1 : 0.6488351949623653, infla_f1 : 0.6817506892340524, necr_f1 : 0.8758710026741028, other_f1 : 0.391319263992565, acc_micro : 0.8758710026741028
[07:52:00.887] train iteration 13861 : loss : 0.480168, loss_ce: 0.539064
[07:52:20.826] train iteration 13911 : loss : 0.665335, loss_ce: 0.825817
[07:52:40.981] train iteration 13961 : loss : 0.353581, loss_ce: 0.414449
[07:52:57.056] val epoch 105 : f1_micro : 0.6502045903887067, f1_macro : 0.5102206298283168, tumor_f1 : 0.7289752279009137, stroma_f1 : 0.5815296737211091, infla_f1 : 0.63942687106984, necr_f1 : 0.8601089801107135, other_f1 : 0.38955758698284626, acc_micro : 0.8601089801107135
[07:52:58.603] train iteration 13993 : loss : 0.490164, loss_ce: 0.642820
[07:53:18.440] train iteration 14043 : loss : 0.450885, loss_ce: 0.604616
[07:53:38.567] train iteration 14093 : loss : 0.546958, loss_ce: 0.657960
[07:53:54.636] val epoch 106 : f1_micro : 0.5993173963257244, f1_macro : 0.4805105860744204, tumor_f1 : 0.7345021877970014, stroma_f1 : 0.47834035222019466, infla_f1 : 0.6344012383903775, necr_f1 : 0.83976663010461, other_f1 : 0.4076109432748386, acc_micro : 0.83976663010461
[07:53:56.179] train iteration 14125 : loss : 0.254098, loss_ce: 0.386974
[07:54:16.092] train iteration 14175 : loss : 0.255533, loss_ce: 0.288345
[07:54:36.184] train iteration 14225 : loss : 0.445511, loss_ce: 0.677980
[07:54:52.405] val epoch 107 : f1_micro : 0.6838742111410413, f1_macro : 0.5464092599494117, tumor_f1 : 0.7366093801600593, stroma_f1 : 0.6453588083386421, infla_f1 : 0.6815007669585091, necr_f1 : 0.8735657419477191, other_f1 : 0.3856699800484681, acc_micro : 0.8735657419477191
[07:54:53.783] train iteration 14257 : loss : 0.491704, loss_ce: 0.530666
[07:55:13.631] train iteration 14307 : loss : 0.475062, loss_ce: 0.638552
[07:55:33.827] train iteration 14357 : loss : 0.418008, loss_ce: 0.482228
[07:55:49.933] val epoch 108 : f1_micro : 0.6295773493392127, f1_macro : 0.5076566870723452, tumor_f1 : 0.7132062550101962, stroma_f1 : 0.5558209270238876, infla_f1 : 0.6603635129784899, necr_f1 : 0.8518565765448979, other_f1 : 0.404477076072778, acc_micro : 0.8518565765448979
[07:55:51.494] train iteration 14389 : loss : 0.369519, loss_ce: 0.532822
[07:56:11.302] train iteration 14439 : loss : 0.326823, loss_ce: 0.460571
[07:56:31.510] train iteration 14489 : loss : 0.534858, loss_ce: 0.747841
[07:56:47.585] val epoch 109 : f1_micro : 0.6529072161231723, f1_macro : 0.5399224864585059, tumor_f1 : 0.7266074057136264, stroma_f1 : 0.5955173713820321, infla_f1 : 0.6825021803379059, necr_f1 : 0.8611895910331181, other_f1 : 0.3852587164645748, acc_micro : 0.8611895910331181
[07:56:49.067] train iteration 14521 : loss : 0.398190, loss_ce: 0.547082
[07:57:08.899] train iteration 14571 : loss : 0.501869, loss_ce: 0.671409
[07:57:29.045] train iteration 14621 : loss : 0.476629, loss_ce: 0.718558
[07:57:45.199] val epoch 110 : f1_micro : 0.6290461421012878, f1_macro : 0.5111701084034783, tumor_f1 : 0.7392777417387281, stroma_f1 : 0.5376416551215308, infla_f1 : 0.6618851966091565, necr_f1 : 0.8516558068139213, other_f1 : 0.38472619227000643, acc_micro : 0.8516558068139213
[07:57:46.694] train iteration 14653 : loss : 0.435283, loss_ce: 0.579821
[07:58:06.670] train iteration 14703 : loss : 0.456781, loss_ce: 0.660822
[07:58:26.792] train iteration 14753 : loss : 0.332414, loss_ce: 0.447045
[07:58:42.737] val epoch 111 : f1_micro : 0.6763850003480911, f1_macro : 0.5582531775747027, tumor_f1 : 0.7348901927471161, stroma_f1 : 0.6054061693804604, infla_f1 : 0.6901620200702122, necr_f1 : 0.870585207428251, other_f1 : 0.40134016830208047, acc_micro : 0.870585207428251
[07:58:44.221] train iteration 14785 : loss : 0.585389, loss_ce: 0.791673
[07:59:04.086] train iteration 14835 : loss : 0.597460, loss_ce: 0.726131
[07:59:24.287] train iteration 14885 : loss : 0.537508, loss_ce: 0.779881
[07:59:40.356] val epoch 112 : f1_micro : 0.6746102912085397, f1_macro : 0.5324998476675579, tumor_f1 : 0.7404462439673287, stroma_f1 : 0.6105889933449882, infla_f1 : 0.6566214564123324, necr_f1 : 0.8698651237147195, other_f1 : 0.3917970817003931, acc_micro : 0.8698651237147195
[07:59:41.870] train iteration 14917 : loss : 0.394367, loss_ce: 0.610749
[08:00:01.672] train iteration 14967 : loss : 0.381239, loss_ce: 0.539151
[08:00:21.831] train iteration 15017 : loss : 0.725487, loss_ce: 0.934135
[08:00:37.878] val epoch 113 : f1_micro : 0.6470941007137299, f1_macro : 0.5076947276081357, tumor_f1 : 0.7332068937165397, stroma_f1 : 0.5481050099645343, infla_f1 : 0.6883024055776852, necr_f1 : 0.8588723242282867, other_f1 : 0.41541288008115124, acc_micro : 0.8588723242282867
[08:00:39.386] train iteration 15049 : loss : 0.584400, loss_ce: 0.789708
[08:00:59.247] train iteration 15099 : loss : 0.468531, loss_ce: 0.519464
[08:01:19.387] train iteration 15149 : loss : 0.382479, loss_ce: 0.516461
[08:01:35.368] val epoch 114 : f1_micro : 0.680369319660323, f1_macro : 0.5467429842267718, tumor_f1 : 0.7390911855867931, stroma_f1 : 0.6436980898891177, infla_f1 : 0.6057794157947812, necr_f1 : 0.8721708995955331, other_f1 : 0.39394609610150966, acc_micro : 0.8721708995955331
[08:01:36.912] train iteration 15181 : loss : 0.424015, loss_ce: 0.658100
[08:01:56.803] train iteration 15231 : loss : 0.423442, loss_ce: 0.630621
[08:02:17.009] train iteration 15281 : loss : 0.483597, loss_ce: 0.571868
[08:02:33.055] val epoch 115 : f1_micro : 0.6708917830671582, f1_macro : 0.5609290174075535, tumor_f1 : 0.7414613344839641, stroma_f1 : 0.6159405963761466, infla_f1 : 0.6634532779987369, necr_f1 : 0.8683812192508152, other_f1 : 0.41356314944901634, acc_micro : 0.8683812192508152
[08:02:34.492] train iteration 15313 : loss : 0.437439, loss_ce: 0.574973
[08:02:54.345] train iteration 15363 : loss : 0.572318, loss_ce: 0.806052
[08:03:14.523] train iteration 15413 : loss : 0.380427, loss_ce: 0.482337
[08:03:30.525] val epoch 116 : f1_micro : 0.6146813418184008, f1_macro : 0.5237380010741097, tumor_f1 : 0.7272110113075801, stroma_f1 : 0.5260134807654789, infla_f1 : 0.6825518693242755, necr_f1 : 0.8459080372537885, other_f1 : 0.39247073219822987, acc_micro : 0.8459080372537885
[08:03:31.967] train iteration 15445 : loss : 0.427875, loss_ce: 0.688959
[08:03:51.873] train iteration 15495 : loss : 0.504423, loss_ce: 0.656679
[08:04:12.063] train iteration 15545 : loss : 0.389990, loss_ce: 0.492969
[08:04:28.162] val epoch 117 : f1_micro : 0.6694263134683881, f1_macro : 0.5666244179010391, tumor_f1 : 0.7364597831453595, stroma_f1 : 0.6257150034819331, infla_f1 : 0.6878114755132368, necr_f1 : 0.8678130890641894, other_f1 : 0.39631433778309394, acc_micro : 0.8678130890641894
[08:04:29.667] train iteration 15577 : loss : 0.459763, loss_ce: 0.628143
[08:04:49.460] train iteration 15627 : loss : 0.339047, loss_ce: 0.501673
[08:05:09.625] train iteration 15677 : loss : 0.523250, loss_ce: 0.624692
[08:05:25.909] val epoch 118 : f1_micro : 0.6513397970369884, f1_macro : 0.49314713903835844, tumor_f1 : 0.7482967334134238, stroma_f1 : 0.5741854182311467, infla_f1 : 0.6592250003346375, necr_f1 : 0.8605759314128331, other_f1 : 0.37989374356610434, acc_micro : 0.8605759314128331
[08:05:27.341] train iteration 15709 : loss : 0.441614, loss_ce: 0.606631
[08:05:47.197] train iteration 15759 : loss : 0.595826, loss_ce: 0.857657
[08:06:07.344] train iteration 15809 : loss : 0.590854, loss_ce: 0.766838
[08:06:23.450] val epoch 119 : f1_micro : 0.6302468138081687, f1_macro : 0.5067343030657087, tumor_f1 : 0.738563807947295, stroma_f1 : 0.5562148009027753, infla_f1 : 0.6653262203825372, necr_f1 : 0.8521314646516528, other_f1 : 0.4024053326076163, acc_micro : 0.8521314646516528
[08:06:24.887] train iteration 15841 : loss : 0.422083, loss_ce: 0.383405
[08:06:44.699] train iteration 15891 : loss : 0.409399, loss_ce: 0.376184
[08:07:04.829] train iteration 15941 : loss : 0.405595, loss_ce: 0.599868
[08:07:20.941] val epoch 120 : f1_micro : 0.6304766429322106, f1_macro : 0.5024181114775794, tumor_f1 : 0.7290237098932266, stroma_f1 : 0.5494130168642316, infla_f1 : 0.70832295609372, necr_f1 : 0.8522161585944039, other_f1 : 0.3986835952382535, acc_micro : 0.8522161585944039
[08:07:22.508] train iteration 15973 : loss : 0.516312, loss_ce: 0.768751
[08:07:42.280] train iteration 16023 : loss : 0.481329, loss_ce: 0.554664
[08:08:02.486] train iteration 16073 : loss : 0.529392, loss_ce: 0.662514
[08:08:18.487] val epoch 121 : f1_micro : 0.6329119077750615, f1_macro : 0.48529123195580076, tumor_f1 : 0.7455159957919802, stroma_f1 : 0.550274417336498, infla_f1 : 0.616120206458228, necr_f1 : 0.8531970168863025, other_f1 : 0.410766432993114, acc_micro : 0.8531970168863025
[08:08:19.940] train iteration 16105 : loss : 0.528627, loss_ce: 0.757069
[08:08:39.777] train iteration 16155 : loss : 0.656168, loss_ce: 0.862386
[08:09:00.145] train iteration 16205 : loss : 0.269913, loss_ce: 0.364973
[08:09:16.042] val epoch 122 : f1_micro : 0.6856482880456107, f1_macro : 0.5592104036893163, tumor_f1 : 0.7330446030412402, stroma_f1 : 0.6496634728142193, infla_f1 : 0.6134159936835724, necr_f1 : 0.8742772681372506, other_f1 : 0.3986140432368432, acc_micro : 0.8742772681372506
[08:09:17.577] train iteration 16237 : loss : 0.405667, loss_ce: 0.570345
[08:09:37.545] train iteration 16287 : loss : 0.365695, loss_ce: 0.570259
[08:09:57.626] train iteration 16337 : loss : 0.527570, loss_ce: 0.613350
[08:10:13.670] val epoch 123 : f1_micro : 0.66887814445155, f1_macro : 0.5510915028197425, tumor_f1 : 0.7439604912485395, stroma_f1 : 0.5963190346956253, infla_f1 : 0.6796371775812337, necr_f1 : 0.8675758114882878, other_f1 : 0.3868986942938396, acc_micro : 0.8675758114882878
[08:10:15.248] train iteration 16369 : loss : 0.717242, loss_ce: 1.073241
[08:10:35.192] train iteration 16419 : loss : 0.466057, loss_ce: 0.577803
[08:10:55.346] train iteration 16469 : loss : 0.500716, loss_ce: 0.672055
[08:11:11.502] val epoch 124 : f1_micro : 0.6604180335998535, f1_macro : 0.5324959797518594, tumor_f1 : 0.7503536343574524, stroma_f1 : 0.5958914182015828, infla_f1 : 0.6416375402893338, necr_f1 : 0.8642033083098275, other_f1 : 0.3531346338401948, acc_micro : 0.8642033083098275
[08:11:13.051] train iteration 16501 : loss : 0.474855, loss_ce: 0.698227
[08:11:32.846] train iteration 16551 : loss : 0.487241, loss_ce: 0.671936
[08:11:53.166] train iteration 16601 : loss : 0.518784, loss_ce: 0.657310
[08:12:09.165] val epoch 125 : f1_micro : 0.6652108239276069, f1_macro : 0.5397618945155825, tumor_f1 : 0.7468550247805459, stroma_f1 : 0.6046111466629165, infla_f1 : 0.6560526256050382, necr_f1 : 0.8661087155342102, other_f1 : 0.3517566882073879, acc_micro : 0.8661087155342102
[08:12:10.715] train iteration 16633 : loss : 0.581254, loss_ce: 0.919694
[08:12:30.618] train iteration 16683 : loss : 0.556948, loss_ce: 0.659032
[08:12:50.879] train iteration 16733 : loss : 0.563648, loss_ce: 0.826750
[08:13:06.893] val epoch 126 : f1_micro : 0.6702041625976562, f1_macro : 0.5411425403186253, tumor_f1 : 0.7480997294187546, stroma_f1 : 0.6119530360613551, infla_f1 : 0.6531773428183182, necr_f1 : 0.8681063737188067, other_f1 : 0.3995530814198511, acc_micro : 0.8681063737188067
[08:13:08.298] train iteration 16765 : loss : 0.387986, loss_ce: 0.461379
[08:13:28.169] train iteration 16815 : loss : 0.427885, loss_ce: 0.642405
[08:13:48.233] train iteration 16865 : loss : 0.548098, loss_ce: 0.715483
[08:14:04.495] val epoch 127 : f1_micro : 0.6846374039139066, f1_macro : 0.5717688649892807, tumor_f1 : 0.7326594846589225, stroma_f1 : 0.6564393895012992, infla_f1 : 0.666166867661689, necr_f1 : 0.873880820614951, other_f1 : 0.39298995288221966, acc_micro : 0.873880820614951
[08:14:05.957] train iteration 16897 : loss : 0.541294, loss_ce: 0.851023
[08:14:25.934] train iteration 16947 : loss : 0.435298, loss_ce: 0.592108
[08:14:45.976] train iteration 16997 : loss : 0.260403, loss_ce: 0.303646
[08:15:02.058] val epoch 128 : f1_micro : 0.6763739373002734, f1_macro : 0.5504717890705381, tumor_f1 : 0.737663039139339, stroma_f1 : 0.6205027885735035, infla_f1 : 0.6659079236643655, necr_f1 : 0.8705759048461914, other_f1 : 0.4097171115822026, acc_micro : 0.8705759048461914
[08:15:03.685] train iteration 17029 : loss : 0.567319, loss_ce: 0.815818
[08:15:23.472] train iteration 17079 : loss : 0.513847, loss_ce: 0.555877
[08:15:43.696] train iteration 17129 : loss : 0.480876, loss_ce: 0.627111
[08:15:59.699] val epoch 129 : f1_micro : 0.6875418360744204, f1_macro : 0.5327793444905963, tumor_f1 : 0.741305410861969, stroma_f1 : 0.6559943067176002, infla_f1 : 0.6511111408472061, necr_f1 : 0.8750416381018502, other_f1 : 0.4042936053925327, acc_micro : 0.8750416381018502
[08:16:01.191] train iteration 17161 : loss : 0.431766, loss_ce: 0.582322
[08:16:21.099] train iteration 17211 : loss : 0.591057, loss_ce: 0.749864
[08:16:41.258] train iteration 17261 : loss : 0.599412, loss_ce: 0.747854
[08:16:57.367] val epoch 130 : f1_micro : 0.638337071452822, f1_macro : 0.5052949360438755, tumor_f1 : 0.7410384672028678, stroma_f1 : 0.550333172082901, infla_f1 : 0.6578724542632699, necr_f1 : 0.8553621428353446, other_f1 : 0.3535074698073523, acc_micro : 0.8553621428353446
[08:16:58.806] train iteration 17293 : loss : 0.500215, loss_ce: 0.690405
[08:17:18.614] train iteration 17343 : loss : 0.409555, loss_ce: 0.502423
[08:17:38.851] train iteration 17393 : loss : 0.423279, loss_ce: 0.445043
[08:17:55.045] val epoch 131 : f1_micro : 0.6547523949827466, f1_macro : 0.5238578574998038, tumor_f1 : 0.7435565484421593, stroma_f1 : 0.5965395271778107, infla_f1 : 0.6294729369027274, necr_f1 : 0.861933559179306, other_f1 : 0.40260775280850275, acc_micro : 0.861933559179306
[08:17:56.562] train iteration 17425 : loss : 0.618042, loss_ce: 0.845589
[08:18:16.335] train iteration 17475 : loss : 0.462818, loss_ce: 0.673340
[08:18:36.646] train iteration 17525 : loss : 0.348793, loss_ce: 0.458842
[08:18:52.691] val epoch 132 : f1_micro : 0.6760701984167099, f1_macro : 0.5450263502342361, tumor_f1 : 0.7400376690285546, stroma_f1 : 0.6240166457636016, infla_f1 : 0.615117257727044, necr_f1 : 0.8704503391470227, other_f1 : 0.38286625099967103, acc_micro : 0.8704503391470227
[08:18:54.129] train iteration 17557 : loss : 0.525037, loss_ce: 0.753116
[08:19:14.101] train iteration 17607 : loss : 0.504054, loss_ce: 0.671895
[08:19:34.152] train iteration 17657 : loss : 0.298617, loss_ce: 0.408125
[08:19:50.295] val epoch 133 : f1_micro : 0.6701758929661342, f1_macro : 0.5335244302238736, tumor_f1 : 0.74082464831216, stroma_f1 : 0.6288651057652065, infla_f1 : 0.6319658724325043, necr_f1 : 0.8680978076798576, other_f1 : 0.4113654652610421, acc_micro : 0.8680978076798576
[08:19:51.781] train iteration 17689 : loss : 0.358485, loss_ce: 0.495425
[08:20:11.641] train iteration 17739 : loss : 0.514342, loss_ce: 0.597903
[08:20:31.709] train iteration 17789 : loss : 0.390731, loss_ce: 0.521533
[08:20:47.725] val epoch 134 : f1_micro : 0.6756554182086673, f1_macro : 0.5536302434546607, tumor_f1 : 0.746905328971999, stroma_f1 : 0.6165470172251973, infla_f1 : 0.6713104423667703, necr_f1 : 0.8702915353434426, other_f1 : 0.4094903389258044, acc_micro : 0.8702915353434426
[08:20:49.236] train iteration 17821 : loss : 0.351485, loss_ce: 0.520343
[08:21:09.268] train iteration 17871 : loss : 0.350551, loss_ce: 0.479397
[08:21:29.425] train iteration 17921 : loss : 0.518067, loss_ce: 0.740095
[08:21:45.351] val epoch 135 : f1_micro : 0.6990270721060889, f1_macro : 0.5706924029758998, tumor_f1 : 0.7488516398838588, stroma_f1 : 0.6552635910255569, infla_f1 : 0.6762882492371968, necr_f1 : 0.8796325623989105, other_f1 : 0.4162547629592674, acc_micro : 0.8796325623989105
[08:21:46.826] train iteration 17953 : loss : 0.436076, loss_ce: 0.574244
[08:22:06.799] train iteration 18003 : loss : 0.373995, loss_ce: 0.534611
[08:22:27.016] train iteration 18053 : loss : 0.426608, loss_ce: 0.478584
[08:22:43.102] val epoch 136 : f1_micro : 0.6655258217028209, f1_macro : 0.5542724643434797, tumor_f1 : 0.7476420147078378, stroma_f1 : 0.5885964472379003, infla_f1 : 0.6585459186545839, necr_f1 : 0.8662399223872593, other_f1 : 0.42028869555464815, acc_micro : 0.8662399223872593
[08:22:44.553] train iteration 18085 : loss : 0.324683, loss_ce: 0.429136
[08:23:04.349] train iteration 18135 : loss : 0.306673, loss_ce: 0.343916
[08:23:24.516] train iteration 18185 : loss : 0.345613, loss_ce: 0.442019
[08:23:40.637] val epoch 137 : f1_micro : 0.6817858240434101, f1_macro : 0.5343287033694131, tumor_f1 : 0.7405491194554737, stroma_f1 : 0.6297493225761822, infla_f1 : 0.6615968051233462, necr_f1 : 0.872739166021347, other_f1 : 0.3975019973835775, acc_micro : 0.872739166021347
[08:23:42.160] train iteration 18217 : loss : 0.447285, loss_ce: 0.719437
[08:24:02.062] train iteration 18267 : loss : 0.390929, loss_ce: 0.531348
[08:24:22.126] train iteration 18317 : loss : 0.322142, loss_ce: 0.438187
[08:24:38.101] val epoch 138 : f1_micro : 0.6859603545495442, f1_macro : 0.5605411508253643, tumor_f1 : 0.7451054986034121, stroma_f1 : 0.6392951458692551, infla_f1 : 0.6732608291453549, necr_f1 : 0.8744056735719953, other_f1 : 0.4089769249050213, acc_micro : 0.8744056735719953
[08:24:39.633] train iteration 18349 : loss : 0.518928, loss_ce: 0.881631
[08:24:59.593] train iteration 18399 : loss : 0.353013, loss_ce: 0.374517
[08:25:19.740] train iteration 18449 : loss : 0.396148, loss_ce: 0.444605
[08:25:35.824] val epoch 139 : f1_micro : 0.6706588608877999, f1_macro : 0.5363970058304923, tumor_f1 : 0.7389954924583435, stroma_f1 : 0.6196312478610447, infla_f1 : 0.6742567739316395, necr_f1 : 0.8682899602821895, other_f1 : 0.3966106828302145, acc_micro : 0.8682899602821895
[08:25:37.328] train iteration 18481 : loss : 0.438323, loss_ce: 0.542855
[08:25:57.186] train iteration 18531 : loss : 0.445553, loss_ce: 0.556822
[08:26:17.253] train iteration 18581 : loss : 0.513913, loss_ce: 0.762825
[08:26:33.537] val epoch 140 : f1_micro : 0.6604342460632324, f1_macro : 0.5171355158090591, tumor_f1 : 0.737363691840853, stroma_f1 : 0.6130871006420681, infla_f1 : 0.5938957680232956, necr_f1 : 0.8642028229577201, other_f1 : 0.4062090744264424, acc_micro : 0.8642028229577201
[08:26:35.065] train iteration 18613 : loss : 0.394410, loss_ce: 0.531373
[08:26:54.899] train iteration 18663 : loss : 0.459275, loss_ce: 0.573060
[08:27:15.076] train iteration 18713 : loss : 0.325618, loss_ce: 0.414654
[08:27:31.185] val epoch 141 : f1_micro : 0.6589049590485436, f1_macro : 0.516512183206422, tumor_f1 : 0.7375357363905225, stroma_f1 : 0.6131403361048017, infla_f1 : 0.5809076136377241, necr_f1 : 0.8635863278593335, other_f1 : 0.41502725718809025, acc_micro : 0.8635863278593335
[08:27:32.670] train iteration 18745 : loss : 0.404539, loss_ce: 0.496833
[08:27:52.622] train iteration 18795 : loss : 0.481304, loss_ce: 0.624162
[08:28:12.795] train iteration 18845 : loss : 0.304895, loss_ce: 0.425949
[08:28:28.688] val epoch 142 : f1_micro : 0.6724577120372227, f1_macro : 0.5280572644301823, tumor_f1 : 0.736287574682917, stroma_f1 : 0.6318758449384144, infla_f1 : 0.6589035970558014, necr_f1 : 0.8690045731408256, other_f1 : 0.4112706856935152, acc_micro : 0.8690045731408256
[08:28:30.188] train iteration 18877 : loss : 0.392833, loss_ce: 0.372471
[08:28:50.030] train iteration 18927 : loss : 0.442549, loss_ce: 0.504723
[08:29:10.240] train iteration 18977 : loss : 0.308422, loss_ce: 0.464401
[08:29:26.232] val epoch 143 : f1_micro : 0.6757205171244485, f1_macro : 0.5213286259344646, tumor_f1 : 0.7345744520425797, stroma_f1 : 0.6376608120543616, infla_f1 : 0.5905123767443001, necr_f1 : 0.8703119669641767, other_f1 : 0.4128721454513392, acc_micro : 0.8703119669641767
[08:29:27.767] train iteration 19009 : loss : 0.654519, loss_ce: 0.890266
[08:29:47.706] train iteration 19059 : loss : 0.354386, loss_ce: 0.500082
[08:30:07.787] train iteration 19109 : loss : 0.479645, loss_ce: 0.675682
[08:30:23.994] val epoch 144 : f1_micro : 0.6839671965156283, f1_macro : 0.5408635011741093, tumor_f1 : 0.7433479981763023, stroma_f1 : 0.642205111682415, infla_f1 : 0.5889014994526016, necr_f1 : 0.8736094066074916, other_f1 : 0.4081957901694945, acc_micro : 0.8736094066074916
[08:30:25.530] train iteration 19141 : loss : 0.308567, loss_ce: 0.456021
[08:30:45.309] train iteration 19191 : loss : 0.382332, loss_ce: 0.492637
[08:31:05.493] train iteration 19241 : loss : 0.436566, loss_ce: 0.553249
[08:31:21.459] val epoch 145 : f1_micro : 0.6822746161903653, f1_macro : 0.538173741527966, tumor_f1 : 0.7399795800447464, stroma_f1 : 0.643741773707526, infla_f1 : 0.6595848726906947, necr_f1 : 0.8729345372744969, other_f1 : 0.40462788862974514, acc_micro : 0.8729345372744969
[08:31:23.061] train iteration 19273 : loss : 0.624373, loss_ce: 0.909106
[08:31:42.892] train iteration 19323 : loss : 0.511625, loss_ce: 0.612904
[08:32:03.225] train iteration 19373 : loss : 0.368266, loss_ce: 0.480877
[08:32:19.196] val epoch 146 : f1_micro : 0.6825689460550036, f1_macro : 0.541213041969708, tumor_f1 : 0.7429634183645248, stroma_f1 : 0.6450047024658748, infla_f1 : 0.6550397127866745, necr_f1 : 0.8730499574116298, other_f1 : 0.41313034881438526, acc_micro : 0.8730499574116298
[08:32:20.802] train iteration 19405 : loss : 0.385533, loss_ce: 0.598730
[08:32:40.639] train iteration 19455 : loss : 0.378227, loss_ce: 0.497635
[08:33:00.978] train iteration 19505 : loss : 0.258752, loss_ce: 0.365261
[08:33:17.035] val epoch 147 : f1_micro : 0.6802164401326861, f1_macro : 0.5355922005006245, tumor_f1 : 0.744814144713538, stroma_f1 : 0.6378277859517506, infla_f1 : 0.6594763142721993, necr_f1 : 0.8721092087881905, other_f1 : 0.4074800245330802, acc_micro : 0.8721092087881905
[08:33:18.555] train iteration 19537 : loss : 0.417478, loss_ce: 0.629700
[08:33:38.423] train iteration 19587 : loss : 0.394318, loss_ce: 0.538557
[08:33:58.708] train iteration 19637 : loss : 0.525133, loss_ce: 0.710077
[08:34:14.798] val epoch 148 : f1_micro : 0.6711845695972443, f1_macro : 0.5399894863367081, tumor_f1 : 0.7419697642326355, stroma_f1 : 0.6205229429262025, infla_f1 : 0.6605989425775728, necr_f1 : 0.8684994067464556, other_f1 : 0.41327647784990923, acc_micro : 0.8684994067464556
[08:34:16.348] train iteration 19669 : loss : 0.475375, loss_ce: 0.653660
[08:34:36.287] train iteration 19719 : loss : 0.385005, loss_ce: 0.472623
[08:34:56.418] train iteration 19769 : loss : 0.329859, loss_ce: 0.535242
[08:35:12.590] val epoch 149 : f1_micro : 0.6652305126190186, f1_macro : 0.5493522818599429, tumor_f1 : 0.7407296640532357, stroma_f1 : 0.6121104178684098, infla_f1 : 0.6596223022788763, necr_f1 : 0.8661184438637325, other_f1 : 0.4137287133240274, acc_micro : 0.8661184438637325
[08:35:13.468] save model to ./logs/frac_0.5/fold_3/epoch_149.pth
[08:35:14.373] save model to ./logs/frac_0.5/fold_3/epoch_149.pth

[03:48:11.042] Namespace(root_path='../data/bcss/L0_1024_s512', dataset='bcss', list_dir='./lists/lists_Synapse', num_classes=6, output_dir='./logs/frac_0.5/fold_2', max_iterations=30000, max_epochs=150, batch_size=24, n_gpu=1, deterministic=0, base_lr=0.05, img_size=224, seed=1234, cfg='configs/swin_tiny_patch4_window7_224_lite.yaml', opts=None, zip=False, cache_mode='part', resume=None, accumulation_steps=None, use_checkpoint=False, amp_opt_level='O1', tag=None, eval=False, throughput=False, frac=0.5, fold=2)
[03:48:11.066] Reading 9897 files in ../data/bcss/L0_1024_s512/data.csv...
[03:48:11.078] Using fold 2 and keep 7011 train files only...
[03:48:11.078] Removing images with threshold of 0.1...
[03:48:11.079] Create train set with 6253 files...
[03:48:11.080] Use 0.5 percent of data to train: 3126!
[03:48:11.084] Reading 804 files in ../data/bcss/L0_1024_s512/val_data.csv...
[03:48:11.087] Using fold 2 and keep 257 val files only...
[03:48:11.087] Removing images with threshold of 0.1...
[03:48:11.087] Create val set with 220 files...
[03:48:11.943] 131 iterations per epoch. 19650 max iterations 
[03:48:14.794] train iteration 1 : loss : 1.295725, loss_ce: 1.921390
[03:48:34.455] train iteration 51 : loss : 0.932902, loss_ce: 1.196828
[03:48:54.255] train iteration 101 : loss : 0.936185, loss_ce: 1.237482
[03:49:10.250] val epoch 0 : f1_micro : 0.5411486625671387, f1_macro : 0.29082884586283136, tumor_f1 : 0.5982530457632882, stroma_f1 : 0.6048453460846629, infla_f1 : 0.07972326250949534, necr_f1 : 0.8175211548805237, other_f1 : 0.1558842329998567, acc_micro : 0.8175211548805237
[03:49:11.756] train iteration 132 : loss : 0.874933, loss_ce: 1.062859
[03:49:31.781] train iteration 182 : loss : 0.861446, loss_ce: 1.101131
[03:49:52.229] train iteration 232 : loss : 0.918072, loss_ce: 1.272241
[03:50:07.781] val epoch 1 : f1_micro : 0.5555463603564671, f1_macro : 0.3847228256719453, tumor_f1 : 0.6003317109176091, stroma_f1 : 0.593680702149868, infla_f1 : 0.1917037510845278, necr_f1 : 0.8235716095992497, other_f1 : 0.322270353262346, acc_micro : 0.8235716095992497
[03:50:09.255] train iteration 263 : loss : 0.774454, loss_ce: 0.949107
[03:50:29.287] train iteration 313 : loss : 0.953394, loss_ce: 1.312474
[03:50:49.626] train iteration 363 : loss : 0.854595, loss_ce: 1.064776
[03:51:05.185] val epoch 2 : f1_micro : 0.5149882159062794, f1_macro : 0.35730699662651333, tumor_f1 : 0.581051664693015, stroma_f1 : 0.49234455078840256, infla_f1 : 0.3255117264177118, necr_f1 : 0.8060708258833204, other_f1 : 0.36256395067487446, acc_micro : 0.8060708258833204
[03:51:06.639] train iteration 394 : loss : 0.951754, loss_ce: 1.306163
[03:51:26.492] train iteration 444 : loss : 0.711135, loss_ce: 1.053983
[03:51:46.949] train iteration 494 : loss : 0.995488, loss_ce: 1.370109
[03:52:02.548] val epoch 3 : f1_micro : 0.48837792554071974, f1_macro : 0.41443399659224917, tumor_f1 : 0.5534123863492694, stroma_f1 : 0.40902398712933064, infla_f1 : 0.21617593819142453, necr_f1 : 0.7953872978687286, other_f1 : 0.3221290752823864, acc_micro : 0.7953872978687286
[03:52:04.033] train iteration 525 : loss : 0.841648, loss_ce: 1.034040
[03:52:23.980] train iteration 575 : loss : 0.949552, loss_ce: 1.323581
[03:52:44.143] train iteration 625 : loss : 0.717180, loss_ce: 0.923289
[03:52:59.697] val epoch 4 : f1_micro : 0.552217002425875, f1_macro : 0.4164301667894636, tumor_f1 : 0.6064877957105637, stroma_f1 : 0.6039406981851373, infla_f1 : 0.06763377745768853, necr_f1 : 0.8209991114480155, other_f1 : 0.3040885158947536, acc_micro : 0.8209991114480155
[03:53:01.244] train iteration 656 : loss : 0.847031, loss_ce: 1.071140
[03:53:21.139] train iteration 706 : loss : 0.909117, loss_ce: 1.280579
[03:53:41.367] train iteration 756 : loss : 0.928540, loss_ce: 1.260200
[03:53:56.804] val epoch 5 : f1_micro : 0.6146521376711982, f1_macro : 0.5073155590466091, tumor_f1 : 0.6468797070639474, stroma_f1 : 0.6522516645491123, infla_f1 : 0.37170431204140186, necr_f1 : 0.8459448090621403, other_f1 : 0.29417246766388416, acc_micro : 0.8459448090621403
[03:53:58.300] train iteration 787 : loss : 0.858286, loss_ce: 1.150932
[03:54:18.332] train iteration 837 : loss : 0.738210, loss_ce: 1.034345
[03:54:38.554] train iteration 887 : loss : 0.906094, loss_ce: 1.326284
[03:54:54.034] val epoch 6 : f1_micro : 0.6058036174092974, f1_macro : 0.5044649158205304, tumor_f1 : 0.645350803221975, stroma_f1 : 0.6184279460992131, infla_f1 : 0.3888770030545337, necr_f1 : 0.8424164567674909, other_f1 : 0.29824026035411016, acc_micro : 0.8424164567674909
[03:54:55.553] train iteration 918 : loss : 0.739351, loss_ce: 0.899431
[03:55:15.511] train iteration 968 : loss : 0.857650, loss_ce: 1.153881
[03:55:35.551] train iteration 1018 : loss : 0.886126, loss_ce: 1.329620
[03:55:51.267] val epoch 7 : f1_micro : 0.6140322004045758, f1_macro : 0.44513432894434246, tumor_f1 : 0.6472939678600856, stroma_f1 : 0.6376765200069973, infla_f1 : 0.4161464633154018, necr_f1 : 0.8457867758614677, other_f1 : 0.3584439636075071, acc_micro : 0.8457867758614677
[03:55:52.735] train iteration 1049 : loss : 0.876807, loss_ce: 1.187720
[03:56:12.607] train iteration 1099 : loss : 0.850707, loss_ce: 1.133074
[03:56:32.802] train iteration 1149 : loss : 0.894689, loss_ce: 1.309213
[03:56:48.131] val epoch 8 : f1_micro : 0.6002871521881649, f1_macro : 0.43704879922526224, tumor_f1 : 0.6547708873237882, stroma_f1 : 0.5848103341247354, infla_f1 : 0.45364160409995485, necr_f1 : 0.840289614030293, other_f1 : 0.3355159700814901, acc_micro : 0.840289614030293
[03:56:49.549] train iteration 1180 : loss : 0.744543, loss_ce: 0.975625
[03:57:09.457] train iteration 1230 : loss : 0.680533, loss_ce: 0.843846
[03:57:29.824] train iteration 1280 : loss : 0.628221, loss_ce: 0.784725
[03:57:45.279] val epoch 9 : f1_micro : 0.6305058747529984, f1_macro : 0.5134979731270245, tumor_f1 : 0.6195499833141055, stroma_f1 : 0.6533365590231759, infla_f1 : 0.5262205174991063, necr_f1 : 0.8523675075599125, other_f1 : 0.3372724063561431, acc_micro : 0.8523675075599125
[03:57:46.750] train iteration 1311 : loss : 0.847161, loss_ce: 1.150733
[03:58:06.690] train iteration 1361 : loss : 0.735015, loss_ce: 1.003079
[03:58:26.772] train iteration 1411 : loss : 0.753718, loss_ce: 1.035235
[03:58:42.361] val epoch 10 : f1_micro : 0.5854419044085911, f1_macro : 0.4467936136892864, tumor_f1 : 0.6763669082096645, stroma_f1 : 0.5540863626769611, infla_f1 : 0.5043556285755975, necr_f1 : 0.8342758161681039, other_f1 : 0.3865825332967298, acc_micro : 0.8342758161681039
[03:58:43.820] train iteration 1442 : loss : 0.833478, loss_ce: 1.100657
[03:59:03.814] train iteration 1492 : loss : 0.723848, loss_ce: 0.925518
[03:59:23.844] train iteration 1542 : loss : 0.640775, loss_ce: 0.968287
[03:59:39.336] val epoch 11 : f1_micro : 0.6178894277129855, f1_macro : 0.4755702699933733, tumor_f1 : 0.651469811797142, stroma_f1 : 0.6043714423264775, infla_f1 : 0.49980189970561434, necr_f1 : 0.8472307239259992, other_f1 : 0.38673364158187595, acc_micro : 0.8472307239259992
[03:59:40.758] train iteration 1573 : loss : 0.601261, loss_ce: 0.724100
[04:00:00.630] train iteration 1623 : loss : 0.894679, loss_ce: 1.147610
[04:00:20.842] train iteration 1673 : loss : 0.703085, loss_ce: 0.885885
[04:00:36.399] val epoch 12 : f1_micro : 0.622054289494242, f1_macro : 0.41760419734886717, tumor_f1 : 0.6664090220417295, stroma_f1 : 0.6496785080858639, infla_f1 : 0.3197646463023765, necr_f1 : 0.848902702331543, other_f1 : 0.3729180176742375, acc_micro : 0.848902702331543
[04:00:37.934] train iteration 1704 : loss : 0.770752, loss_ce: 1.060147
[04:00:57.795] train iteration 1754 : loss : 0.721042, loss_ce: 0.975522
[04:01:17.975] train iteration 1804 : loss : 0.709639, loss_ce: 0.891320
[04:01:33.383] val epoch 13 : f1_micro : 0.6087438464164734, f1_macro : 0.4731725539479937, tumor_f1 : 0.6475455058472497, stroma_f1 : 0.57078703386443, infla_f1 : 0.5456805931670325, necr_f1 : 0.8436028574194226, other_f1 : 0.357762728950807, acc_micro : 0.8436028574194226
[04:01:34.877] train iteration 1835 : loss : 0.783034, loss_ce: 0.966697
[04:01:54.805] train iteration 1885 : loss : 0.543481, loss_ce: 0.687895
[04:02:14.962] train iteration 1935 : loss : 0.828577, loss_ce: 1.234890
[04:02:30.551] val epoch 14 : f1_micro : 0.6266580990382603, f1_macro : 0.4524754605122975, tumor_f1 : 0.6549632187400546, stroma_f1 : 0.6186849591987473, infla_f1 : 0.49295773782900404, necr_f1 : 0.8507986579622541, other_f1 : 0.35144740662404467, acc_micro : 0.8507986579622541
[04:02:32.043] train iteration 1966 : loss : 0.913188, loss_ce: 1.272774
[04:02:51.942] train iteration 2016 : loss : 0.870161, loss_ce: 1.212149
[04:03:12.063] train iteration 2066 : loss : 0.775498, loss_ce: 1.107451
[04:03:27.581] val epoch 15 : f1_micro : 0.608452096581459, f1_macro : 0.4556013324431011, tumor_f1 : 0.672188475728035, stroma_f1 : 0.5513007640838623, infla_f1 : 0.5288245260183301, necr_f1 : 0.8435951045581273, other_f1 : 0.380636247673205, acc_micro : 0.8435951045581273
[04:03:29.065] train iteration 2097 : loss : 0.764176, loss_ce: 0.899985
[04:03:48.949] train iteration 2147 : loss : 0.769310, loss_ce: 1.131050
[04:04:09.179] train iteration 2197 : loss : 0.751845, loss_ce: 0.982971
[04:04:24.667] val epoch 16 : f1_micro : 0.6445104820387704, f1_macro : 0.5107507428952626, tumor_f1 : 0.6734059048550469, stroma_f1 : 0.6155232223016875, infla_f1 : 0.5919128262570926, necr_f1 : 0.8579411421503339, other_f1 : 0.3947215540600674, acc_micro : 0.8579411421503339
[04:04:26.147] train iteration 2228 : loss : 0.763692, loss_ce: 0.975188
[04:04:46.045] train iteration 2278 : loss : 0.690544, loss_ce: 0.976886
[04:05:06.207] train iteration 2328 : loss : 0.786044, loss_ce: 1.091999
[04:05:21.774] val epoch 17 : f1_micro : 0.6072096164737429, f1_macro : 0.48310808198792593, tumor_f1 : 0.6653462733541217, stroma_f1 : 0.5278900936245918, infla_f1 : 0.5877612297024045, necr_f1 : 0.8429513999394008, other_f1 : 0.3774135804269463, acc_micro : 0.8429513999394008
[04:05:23.325] train iteration 2359 : loss : 0.742146, loss_ce: 1.089270
[04:05:43.354] train iteration 2409 : loss : 0.723506, loss_ce: 1.011195
[04:06:03.481] train iteration 2459 : loss : 0.689787, loss_ce: 0.961239
[04:06:19.177] val epoch 18 : f1_micro : 0.6021572564329419, f1_macro : 0.49071858397551943, tumor_f1 : 0.6879659869841167, stroma_f1 : 0.570214529122625, infla_f1 : 0.5542647753443036, necr_f1 : 0.8409368438380105, other_f1 : 0.39750573092273306, acc_micro : 0.8409368438380105
[04:06:20.637] train iteration 2490 : loss : 0.774593, loss_ce: 1.119974
[04:06:40.478] train iteration 2540 : loss : 0.993620, loss_ce: 1.532225
[04:07:00.860] train iteration 2590 : loss : 0.955166, loss_ce: 1.463100
[04:07:16.364] val epoch 19 : f1_micro : 0.6305787840059826, f1_macro : 0.5121541363852364, tumor_f1 : 0.6710956926856723, stroma_f1 : 0.6137163085596902, infla_f1 : 0.5766455743994031, necr_f1 : 0.8523313658578056, other_f1 : 0.39099316777927534, acc_micro : 0.8523313658578056
[04:07:17.822] train iteration 2621 : loss : 0.670776, loss_ce: 0.872450
[04:07:37.724] train iteration 2671 : loss : 0.725101, loss_ce: 0.982390
[04:07:57.980] train iteration 2721 : loss : 0.590364, loss_ce: 0.790956
[04:08:13.414] val epoch 20 : f1_micro : 0.6286228682313647, f1_macro : 0.487856354032244, tumor_f1 : 0.66693562907832, stroma_f1 : 0.6495403328112194, infla_f1 : 0.5075960627623967, necr_f1 : 0.8515282060418811, other_f1 : 0.40968971593039377, acc_micro : 0.8515282060418811
[04:08:14.889] train iteration 2752 : loss : 0.669303, loss_ce: 0.844037
[04:08:34.852] train iteration 2802 : loss : 0.546256, loss_ce: 0.764920
[04:08:55.212] train iteration 2852 : loss : 0.752682, loss_ce: 1.064702
[04:09:10.657] val epoch 21 : f1_micro : 0.6164245328732899, f1_macro : 0.4855550889457975, tumor_f1 : 0.6681127335344043, stroma_f1 : 0.6368735916912556, infla_f1 : 0.4601101695692965, necr_f1 : 0.8466084344046456, other_f1 : 0.40477080962487627, acc_micro : 0.8466084344046456
[04:09:12.165] train iteration 2883 : loss : 0.696028, loss_ce: 0.876420
[04:09:32.012] train iteration 2933 : loss : 0.735724, loss_ce: 1.013701
[04:09:52.277] train iteration 2983 : loss : 0.560504, loss_ce: 0.696162
[04:10:07.754] val epoch 22 : f1_micro : 0.652770704456738, f1_macro : 0.5192847358328956, tumor_f1 : 0.6950228682586125, stroma_f1 : 0.6026125348040036, infla_f1 : 0.6301078200340271, necr_f1 : 0.861179952110563, other_f1 : 0.3500939075435911, acc_micro : 0.861179952110563
[04:10:09.290] train iteration 3014 : loss : 0.674884, loss_ce: 0.972929
[04:10:29.142] train iteration 3064 : loss : 0.582915, loss_ce: 0.767150
[04:10:49.362] train iteration 3114 : loss : 0.747381, loss_ce: 1.091463
[04:11:04.963] val epoch 23 : f1_micro : 0.6412647323948997, f1_macro : 0.5013695880770683, tumor_f1 : 0.6948465236595699, stroma_f1 : 0.6255041382142476, infla_f1 : 0.5200026748435838, necr_f1 : 0.8565263875893184, other_f1 : 0.40537193530638305, acc_micro : 0.8565263875893184
[04:11:06.421] train iteration 3145 : loss : 0.685037, loss_ce: 0.927971
[04:11:26.283] train iteration 3195 : loss : 0.614024, loss_ce: 0.734737
[04:11:46.519] train iteration 3245 : loss : 0.628253, loss_ce: 0.797406
[04:12:02.118] val epoch 24 : f1_micro : 0.6111283557755607, f1_macro : 0.5309079672609057, tumor_f1 : 0.6988799870014191, stroma_f1 : 0.5449865875499589, infla_f1 : 0.6498654612473079, necr_f1 : 0.8444880715438298, other_f1 : 0.40717982394354685, acc_micro : 0.8444880715438298
[04:12:03.557] train iteration 3276 : loss : 0.698273, loss_ce: 0.905027
[04:12:23.422] train iteration 3326 : loss : 0.760771, loss_ce: 1.009261
[04:12:43.628] train iteration 3376 : loss : 0.666631, loss_ce: 0.929771
[04:12:59.238] val epoch 25 : f1_micro : 0.6269543362515313, f1_macro : 0.48402355504887445, tumor_f1 : 0.6952372257198606, stroma_f1 : 0.5533702549125467, infla_f1 : 0.5888272609029498, necr_f1 : 0.8510253557137081, other_f1 : 0.36879193995680126, acc_micro : 0.8510253557137081
[04:13:00.733] train iteration 3407 : loss : 0.681230, loss_ce: 0.867177
[04:13:20.537] train iteration 3457 : loss : 0.649546, loss_ce: 0.849414
[04:13:40.763] train iteration 3507 : loss : 0.720985, loss_ce: 0.857220
[04:13:56.274] val epoch 26 : f1_micro : 0.5993690554584775, f1_macro : 0.46033965796232224, tumor_f1 : 0.7167811415025166, stroma_f1 : 0.5006738156080246, infla_f1 : 0.6070143410137722, necr_f1 : 0.8398821609360831, other_f1 : 0.3739220518618822, acc_micro : 0.8398821609360831
[04:13:57.710] train iteration 3538 : loss : 0.739894, loss_ce: 0.980420
[04:14:17.579] train iteration 3588 : loss : 0.540257, loss_ce: 0.770642
[04:14:37.788] train iteration 3638 : loss : 0.768929, loss_ce: 1.022501
[04:14:53.325] val epoch 27 : f1_micro : 0.6617184813533511, f1_macro : 0.5306394334350314, tumor_f1 : 0.7210503561156136, stroma_f1 : 0.6164962191666875, infla_f1 : 0.6792981805545943, necr_f1 : 0.8647344197545733, other_f1 : 0.38432202328528675, acc_micro : 0.8647344197545733
[04:14:54.894] train iteration 3669 : loss : 0.601349, loss_ce: 0.825584
[04:15:14.748] train iteration 3719 : loss : 0.668831, loss_ce: 0.828698
[04:15:34.882] train iteration 3769 : loss : 0.568389, loss_ce: 0.709949
[04:15:50.325] val epoch 28 : f1_micro : 0.6113799661397934, f1_macro : 0.5065631068178585, tumor_f1 : 0.6812191094670977, stroma_f1 : 0.5352242461272648, infla_f1 : 0.5829255708626339, necr_f1 : 0.8446260222366878, other_f1 : 0.4029450459139688, acc_micro : 0.8446260222366878
[04:15:51.864] train iteration 3800 : loss : 0.714381, loss_ce: 0.935846
[04:16:11.807] train iteration 3850 : loss : 0.664555, loss_ce: 0.847352
[04:16:32.043] train iteration 3900 : loss : 0.785547, loss_ce: 1.009557
[04:16:47.565] val epoch 29 : f1_micro : 0.6484977986131396, f1_macro : 0.520589251603399, tumor_f1 : 0.6950664051941463, stroma_f1 : 0.6174944766930172, infla_f1 : 0.57895456467356, necr_f1 : 0.8594882403101239, other_f1 : 0.3525788625702262, acc_micro : 0.8594882403101239
[04:16:49.054] train iteration 3931 : loss : 0.590162, loss_ce: 0.756755
[04:17:08.877] train iteration 3981 : loss : 0.504456, loss_ce: 0.726979
[04:17:29.096] train iteration 4031 : loss : 0.655303, loss_ce: 0.817244
[04:17:44.520] val epoch 30 : f1_micro : 0.6341030831847873, f1_macro : 0.5066173672676086, tumor_f1 : 0.6636437225554671, stroma_f1 : 0.6137139147945813, infla_f1 : 0.6127233292375293, necr_f1 : 0.8537149386746543, other_f1 : 0.40417245030403137, acc_micro : 0.8537149386746543
[04:17:46.039] train iteration 4062 : loss : 0.774467, loss_ce: 1.057805
[04:18:05.925] train iteration 4112 : loss : 0.670055, loss_ce: 0.782246
[04:18:26.085] train iteration 4162 : loss : 0.843847, loss_ce: 1.206309
[04:18:41.624] val epoch 31 : f1_micro : 0.6106806035552707, f1_macro : 0.49167113857609884, tumor_f1 : 0.7002291807106563, stroma_f1 : 0.5578664450773171, infla_f1 : 0.561315370457513, necr_f1 : 0.8443123485360827, other_f1 : 0.37589036114513874, acc_micro : 0.8443123485360827
[04:18:43.072] train iteration 4193 : loss : 0.453164, loss_ce: 0.610363
[04:19:02.967] train iteration 4243 : loss : 0.468887, loss_ce: 0.714780
[04:19:23.081] train iteration 4293 : loss : 0.628783, loss_ce: 0.819093
[04:19:38.818] val epoch 32 : f1_micro : 0.6486670672893524, f1_macro : 0.5218220140252795, tumor_f1 : 0.715513812644141, stroma_f1 : 0.5883731639810971, infla_f1 : 0.6284314606870923, necr_f1 : 0.8595205758299146, other_f1 : 0.3927086777985096, acc_micro : 0.8595205758299146
[04:19:40.256] train iteration 4324 : loss : 0.520487, loss_ce: 0.727006
[04:20:00.138] train iteration 4374 : loss : 0.483173, loss_ce: 0.528832
[04:20:20.226] train iteration 4424 : loss : 0.569339, loss_ce: 0.882557
[04:20:35.762] val epoch 33 : f1_micro : 0.6663617087262017, f1_macro : 0.5492175498179027, tumor_f1 : 0.7100939005613327, stroma_f1 : 0.6539580821990967, infla_f1 : 0.6472233937654112, necr_f1 : 0.8665678671428135, other_f1 : 0.37657461648008655, acc_micro : 0.8665678671428135
[04:20:37.202] train iteration 4455 : loss : 0.643919, loss_ce: 0.914013
[04:20:57.101] train iteration 4505 : loss : 0.809666, loss_ce: 1.100679
[04:21:17.427] train iteration 4555 : loss : 0.628442, loss_ce: 0.868765
[04:21:32.785] val epoch 34 : f1_micro : 0.6339746585914067, f1_macro : 0.5067282074264118, tumor_f1 : 0.6632794610091618, stroma_f1 : 0.6220632472208568, infla_f1 : 0.5893215260335377, necr_f1 : 0.8536645344325474, other_f1 : 0.3659895399053182, acc_micro : 0.8536645344325474
[04:21:34.216] train iteration 4586 : loss : 0.604565, loss_ce: 0.904944
[04:21:54.230] train iteration 4636 : loss : 0.452887, loss_ce: 0.548404
[04:22:14.303] train iteration 4686 : loss : 0.803245, loss_ce: 1.250869
[04:22:29.652] val epoch 35 : f1_micro : 0.6440122553280422, f1_macro : 0.5107111611536571, tumor_f1 : 0.6963992949043002, stroma_f1 : 0.6007752514311245, infla_f1 : 0.6058755210999932, necr_f1 : 0.8576657686914716, other_f1 : 0.37489842703299864, acc_micro : 0.8576657686914716
[04:22:31.113] train iteration 4717 : loss : 0.493969, loss_ce: 0.624259
[04:22:51.011] train iteration 4767 : loss : 0.460089, loss_ce: 0.535595
[04:23:11.324] train iteration 4817 : loss : 0.614661, loss_ce: 0.757011
[04:23:26.798] val epoch 36 : f1_micro : 0.6569568663835526, f1_macro : 0.5349328156028476, tumor_f1 : 0.7040926516056061, stroma_f1 : 0.6021304726600647, infla_f1 : 0.6446884998253414, necr_f1 : 0.8628054346357074, other_f1 : 0.38827401246609433, acc_micro : 0.8628054346357074
[04:23:28.323] train iteration 4848 : loss : 0.597632, loss_ce: 0.772550
[04:23:48.105] train iteration 4898 : loss : 0.743758, loss_ce: 1.016669
[04:24:08.346] train iteration 4948 : loss : 0.364187, loss_ce: 0.487755
[04:24:23.908] val epoch 37 : f1_micro : 0.6466784477233887, f1_macro : 0.5252307440553393, tumor_f1 : 0.7111665819372449, stroma_f1 : 0.5844235963055066, infla_f1 : 0.6276892040457044, necr_f1 : 0.8587041582380023, other_f1 : 0.3935347077037607, acc_micro : 0.8587041582380023
[04:24:25.382] train iteration 4979 : loss : 0.516911, loss_ce: 0.748516
[04:24:45.296] train iteration 5029 : loss : 0.668726, loss_ce: 0.880326
[04:25:05.477] train iteration 5079 : loss : 0.565820, loss_ce: 0.536595
[04:25:21.074] val epoch 38 : f1_micro : 0.6235415467194149, f1_macro : 0.5142708654914584, tumor_f1 : 0.7189698900495257, stroma_f1 : 0.5318776991750512, infla_f1 : 0.6312895677983761, necr_f1 : 0.8494732635361808, other_f1 : 0.3781097290837871, acc_micro : 0.8494732635361808
[04:25:22.502] train iteration 5110 : loss : 0.701844, loss_ce: 0.892063
[04:25:42.361] train iteration 5160 : loss : 0.796814, loss_ce: 1.166381
[04:26:02.472] train iteration 5210 : loss : 0.750925, loss_ce: 1.022518
[04:26:17.910] val epoch 39 : f1_micro : 0.6364748052188328, f1_macro : 0.5264302236693246, tumor_f1 : 0.7119416700942176, stroma_f1 : 0.5695939095956939, infla_f1 : 0.6065793910196849, necr_f1 : 0.8546355281557355, other_f1 : 0.38204198806280537, acc_micro : 0.8546355281557355
[04:26:19.353] train iteration 5241 : loss : 0.433242, loss_ce: 0.548719
[04:26:39.340] train iteration 5291 : loss : 0.587165, loss_ce: 0.750606
[04:26:59.537] train iteration 5341 : loss : 0.750169, loss_ce: 1.120533
[04:27:14.853] val epoch 40 : f1_micro : 0.6586022334439414, f1_macro : 0.5258777801479612, tumor_f1 : 0.7101872180189405, stroma_f1 : 0.6276443919965199, infla_f1 : 0.5574224463530949, necr_f1 : 0.8634659435067858, other_f1 : 0.39352694266874877, acc_micro : 0.8634659435067858
[04:27:16.306] train iteration 5372 : loss : 0.696674, loss_ce: 0.844064
[04:27:36.147] train iteration 5422 : loss : 0.661609, loss_ce: 0.953259
[04:27:56.339] train iteration 5472 : loss : 0.512679, loss_ce: 0.660976
[04:28:11.845] val epoch 41 : f1_micro : 0.6378012916871479, f1_macro : 0.5201756081410817, tumor_f1 : 0.7180936464241573, stroma_f1 : 0.5542187547045094, infla_f1 : 0.6115787766341653, necr_f1 : 0.8551496522767204, other_f1 : 0.3838035891364728, acc_micro : 0.8551496522767204
[04:28:13.316] train iteration 5503 : loss : 0.640505, loss_ce: 0.932086
[04:28:33.255] train iteration 5553 : loss : 0.735684, loss_ce: 1.094329
[04:28:53.285] train iteration 5603 : loss : 0.854251, loss_ce: 1.146538
[04:29:08.710] val epoch 42 : f1_micro : 0.5840353752885546, f1_macro : 0.4987119031803949, tumor_f1 : 0.7105806171894073, stroma_f1 : 0.47290617919393946, infla_f1 : 0.6470416550125394, necr_f1 : 0.833644551890237, other_f1 : 0.38301203050650656, acc_micro : 0.833644551890237
[04:29:10.212] train iteration 5634 : loss : 0.596973, loss_ce: 0.749810
[04:29:30.032] train iteration 5684 : loss : 0.472916, loss_ce: 0.546104
[04:29:50.271] train iteration 5734 : loss : 0.709049, loss_ce: 0.907043
[04:30:05.715] val epoch 43 : f1_micro : 0.660069214446204, f1_macro : 0.5233751237392426, tumor_f1 : 0.7106546099696841, stroma_f1 : 0.6288084366491863, infla_f1 : 0.6042449538196836, necr_f1 : 0.8640495623861041, other_f1 : 0.38378634340395884, acc_micro : 0.8640495623861041
[04:30:07.229] train iteration 5765 : loss : 0.667117, loss_ce: 0.948841
[04:30:27.052] train iteration 5815 : loss : 0.645932, loss_ce: 0.814595
[04:30:47.151] train iteration 5865 : loss : 0.541143, loss_ce: 0.652819
[04:31:02.783] val epoch 44 : f1_micro : 0.6380956151655742, f1_macro : 0.5378719217010907, tumor_f1 : 0.6939656138420105, stroma_f1 : 0.5910533804978643, infla_f1 : 0.5934749586241586, necr_f1 : 0.8552703176225934, other_f1 : 0.3989841610725437, acc_micro : 0.8552703176225934
[04:31:04.248] train iteration 5896 : loss : 0.526378, loss_ce: 0.743800
[04:31:24.051] train iteration 5946 : loss : 0.609527, loss_ce: 0.771568
[04:31:44.259] train iteration 5996 : loss : 0.601879, loss_ce: 0.767752
[04:31:59.745] val epoch 45 : f1_micro : 0.6019525229930878, f1_macro : 0.5050704330205917, tumor_f1 : 0.6943432220390865, stroma_f1 : 0.4937784267323358, infla_f1 : 0.6076878096376147, necr_f1 : 0.8408217004367283, other_f1 : 0.38867656234651804, acc_micro : 0.8408217004367283
[04:32:01.228] train iteration 6027 : loss : 0.720451, loss_ce: 1.068262
[04:32:21.017] train iteration 6077 : loss : 0.653237, loss_ce: 0.958708
[04:32:41.246] train iteration 6127 : loss : 0.521015, loss_ce: 0.679276
[04:32:56.645] val epoch 46 : f1_micro : 0.6370096760136741, f1_macro : 0.4878432346241815, tumor_f1 : 0.7136205392224448, stroma_f1 : 0.5861893365425723, infla_f1 : 0.563624920057399, necr_f1 : 0.8548320063522884, other_f1 : 0.3965632394621415, acc_micro : 0.8548320063522884
[04:32:58.110] train iteration 6158 : loss : 0.587394, loss_ce: 0.609161
[04:33:17.948] train iteration 6208 : loss : 0.737323, loss_ce: 1.050952
[04:33:38.139] train iteration 6258 : loss : 0.599326, loss_ce: 0.769947
[04:33:53.530] val epoch 47 : f1_micro : 0.6463925327573504, f1_macro : 0.5079158501965659, tumor_f1 : 0.6915322691202164, stroma_f1 : 0.6254021387015071, infla_f1 : 0.6000468954443932, necr_f1 : 0.8586270766598838, other_f1 : 0.26701618184285636, acc_micro : 0.8586270766598838
[04:33:55.020] train iteration 6289 : loss : 0.603320, loss_ce: 0.804828
[04:34:14.869] train iteration 6339 : loss : 0.603992, loss_ce: 0.733876
[04:34:34.961] train iteration 6389 : loss : 0.568508, loss_ce: 0.744026
[04:34:50.522] val epoch 48 : f1_micro : 0.6467783493655068, f1_macro : 0.5283345601388386, tumor_f1 : 0.7029281748192651, stroma_f1 : 0.5907155892678669, infla_f1 : 0.5783980606190328, necr_f1 : 0.8587482912199838, other_f1 : 0.37495044795131044, acc_micro : 0.8587482912199838
[04:34:51.972] train iteration 6420 : loss : 0.675734, loss_ce: 0.881936
[04:35:11.820] train iteration 6470 : loss : 0.420218, loss_ce: 0.563176
[04:35:32.023] train iteration 6520 : loss : 0.675703, loss_ce: 1.069393
[04:35:47.539] val epoch 49 : f1_micro : 0.5853257275053433, f1_macro : 0.44931953826120924, tumor_f1 : 0.7008902558258602, stroma_f1 : 0.4743450241429465, infla_f1 : 0.5162859750645501, necr_f1 : 0.8342123329639435, other_f1 : 0.3824270347665463, acc_micro : 0.8342123329639435
[04:35:49.030] train iteration 6551 : loss : 0.562719, loss_ce: 0.666877
[04:36:08.899] train iteration 6601 : loss : 0.801232, loss_ce: 1.032577
[04:36:28.957] train iteration 6651 : loss : 0.704031, loss_ce: 1.093890
[04:36:44.457] val epoch 50 : f1_micro : 0.6242044227463859, f1_macro : 0.4673816125307764, tumor_f1 : 0.7247507359300341, stroma_f1 : 0.5397824964353016, infla_f1 : 0.5924998968839645, necr_f1 : 0.8497337400913239, other_f1 : 0.37937880121171474, acc_micro : 0.8497337400913239
[04:36:45.874] train iteration 6682 : loss : 0.441670, loss_ce: 0.616377
[04:37:05.772] train iteration 6732 : loss : 0.606049, loss_ce: 0.750198
[04:37:25.969] train iteration 6782 : loss : 0.695836, loss_ce: 0.910976
[04:37:41.451] val epoch 51 : f1_micro : 0.6371492977653231, f1_macro : 0.5215239886726651, tumor_f1 : 0.7350795311587197, stroma_f1 : 0.5452052583651883, infla_f1 : 0.6642267246331487, necr_f1 : 0.8548825000013623, other_f1 : 0.37729623700891224, acc_micro : 0.8548825000013623
[04:37:42.883] train iteration 6813 : loss : 0.519404, loss_ce: 0.660971
[04:38:02.766] train iteration 6863 : loss : 0.496284, loss_ce: 0.714784
[04:38:22.941] train iteration 6913 : loss : 0.678173, loss_ce: 0.822921
[04:38:38.436] val epoch 52 : f1_micro : 0.6725393193108695, f1_macro : 0.5437645848308291, tumor_f1 : 0.7126495561429432, stroma_f1 : 0.6462307976824897, infla_f1 : 0.6386979924780982, necr_f1 : 0.8690579235553741, other_f1 : 0.3663573297006743, acc_micro : 0.8690579235553741
[04:38:40.001] train iteration 6944 : loss : 0.605429, loss_ce: 0.735658
[04:38:59.924] train iteration 6994 : loss : 0.648921, loss_ce: 0.788573
[04:39:19.964] train iteration 7044 : loss : 0.559618, loss_ce: 0.673136
[04:39:35.596] val epoch 53 : f1_micro : 0.669208654335567, f1_macro : 0.5260989900146212, tumor_f1 : 0.7288294562271663, stroma_f1 : 0.6072054931095668, infla_f1 : 0.6039011196366378, necr_f1 : 0.8677066223961967, other_f1 : 0.37907999803844306, acc_micro : 0.8677066223961967
[04:39:37.019] train iteration 7075 : loss : 0.587467, loss_ce: 0.618544
[04:39:56.859] train iteration 7125 : loss : 0.636986, loss_ce: 0.838486
[04:40:17.080] train iteration 7175 : loss : 0.449892, loss_ce: 0.733476
[04:40:32.619] val epoch 54 : f1_micro : 0.6176485908882958, f1_macro : 0.5019110494426319, tumor_f1 : 0.7185059147221702, stroma_f1 : 0.502146874155317, infla_f1 : 0.6125481889716217, necr_f1 : 0.8470861571175712, other_f1 : 0.3901916586660913, acc_micro : 0.8470861571175712
[04:40:34.129] train iteration 7206 : loss : 0.587425, loss_ce: 0.642074
[04:40:54.014] train iteration 7256 : loss : 0.667775, loss_ce: 0.875943
[04:41:14.316] train iteration 7306 : loss : 0.645015, loss_ce: 0.942157
[04:41:29.768] val epoch 55 : f1_micro : 0.6462014402662005, f1_macro : 0.5065997072628566, tumor_f1 : 0.7163155121462685, stroma_f1 : 0.5719538671629769, infla_f1 : 0.600145798176527, necr_f1 : 0.8585023581981659, other_f1 : 0.39202754518815447, acc_micro : 0.8585023581981659
[04:41:31.283] train iteration 7337 : loss : 0.555752, loss_ce: 0.789477
[04:41:51.223] train iteration 7387 : loss : 0.597032, loss_ce: 0.791292
[04:42:11.243] train iteration 7437 : loss : 0.621832, loss_ce: 0.802535
[04:42:26.674] val epoch 56 : f1_micro : 0.6893892479794366, f1_macro : 0.5601134300231934, tumor_f1 : 0.7265576784099851, stroma_f1 : 0.6510967122656959, infla_f1 : 0.6984320016843932, necr_f1 : 0.8757758012839726, other_f1 : 0.3889687473752669, acc_micro : 0.8757758012839726
[04:42:28.142] train iteration 7468 : loss : 0.672933, loss_ce: 0.915435
[04:42:48.118] train iteration 7518 : loss : 0.600464, loss_ce: 0.733935
[04:43:08.174] train iteration 7568 : loss : 0.652407, loss_ce: 1.009537
[04:43:23.725] val epoch 57 : f1_micro : 0.6461695049490247, f1_macro : 0.516042023897171, tumor_f1 : 0.7271060645580292, stroma_f1 : 0.5610927705253873, infla_f1 : 0.6687534557921546, necr_f1 : 0.8584869461400169, other_f1 : 0.3124670976685593, acc_micro : 0.8584869461400169
[04:43:25.174] train iteration 7599 : loss : 0.569548, loss_ce: 0.752169
[04:43:45.067] train iteration 7649 : loss : 0.544231, loss_ce: 0.729199
[04:44:05.305] train iteration 7699 : loss : 0.635566, loss_ce: 0.946924
[04:44:20.770] val epoch 58 : f1_micro : 0.6636166508708682, f1_macro : 0.5417602221880641, tumor_f1 : 0.6961301937699318, stroma_f1 : 0.6285789789898055, infla_f1 : 0.6356212837355477, necr_f1 : 0.8654866175992149, other_f1 : 0.4064858561115606, acc_micro : 0.8654866175992149
[04:44:22.246] train iteration 7730 : loss : 0.524227, loss_ce: 0.763064
[04:44:42.004] train iteration 7780 : loss : 0.588758, loss_ce: 0.760352
[04:45:02.247] train iteration 7830 : loss : 0.667067, loss_ce: 0.812796
[04:45:17.837] val epoch 59 : f1_micro : 0.5873025102274758, f1_macro : 0.4710619683776583, tumor_f1 : 0.7144953565938132, stroma_f1 : 0.49760018156043123, infla_f1 : 0.5802106953092984, necr_f1 : 0.8349548833710807, other_f1 : 0.3812086454459599, acc_micro : 0.8349548833710807
[04:45:19.350] train iteration 7861 : loss : 0.697999, loss_ce: 1.121827
[04:45:39.194] train iteration 7911 : loss : 0.584754, loss_ce: 0.820441
[04:45:59.205] train iteration 7961 : loss : 0.543386, loss_ce: 0.688080
[04:46:14.822] val epoch 60 : f1_micro : 0.6561223928417478, f1_macro : 0.5382000761372703, tumor_f1 : 0.7263342993600028, stroma_f1 : 0.5949239028351647, infla_f1 : 0.6755408123800797, necr_f1 : 0.8624805510044098, other_f1 : 0.3700766031896429, acc_micro : 0.8624805510044098
[04:46:16.346] train iteration 7992 : loss : 0.654943, loss_ce: 0.718519
[04:46:36.169] train iteration 8042 : loss : 0.477809, loss_ce: 0.617548
[04:46:56.248] train iteration 8092 : loss : 0.640704, loss_ce: 0.878909
[04:47:11.780] val epoch 61 : f1_micro : 0.6488136904580253, f1_macro : 0.524866942848478, tumor_f1 : 0.697972514799663, stroma_f1 : 0.6243580654263496, infla_f1 : 0.5702336827026946, necr_f1 : 0.859541688646589, other_f1 : 0.4039030649832317, acc_micro : 0.859541688646589
[04:47:13.286] train iteration 8123 : loss : 0.809744, loss_ce: 1.202712
[04:47:33.168] train iteration 8173 : loss : 0.491675, loss_ce: 0.671150
[04:47:53.270] train iteration 8223 : loss : 0.683978, loss_ce: 0.888005
[04:48:08.739] val epoch 62 : f1_micro : 0.6009678255234446, f1_macro : 0.5051530663456235, tumor_f1 : 0.7300562283822468, stroma_f1 : 0.47067068410771234, infla_f1 : 0.6092296866388226, necr_f1 : 0.8404314943722316, other_f1 : 0.40733905539049636, acc_micro : 0.8404314943722316
[04:48:10.302] train iteration 8254 : loss : 0.600785, loss_ce: 0.725430
[04:48:30.123] train iteration 8304 : loss : 0.619957, loss_ce: 0.785443
[04:48:50.372] train iteration 8354 : loss : 0.573876, loss_ce: 0.880248
[04:49:05.859] val epoch 63 : f1_micro : 0.6055743885891778, f1_macro : 0.513914015676294, tumor_f1 : 0.6964235667671476, stroma_f1 : 0.5379544390099389, infla_f1 : 0.5464597441522139, necr_f1 : 0.8422561969075885, other_f1 : 0.3954460195132664, acc_micro : 0.8422561969075885
[04:49:07.316] train iteration 8385 : loss : 0.486546, loss_ce: 0.523611
[04:49:27.163] train iteration 8435 : loss : 0.486503, loss_ce: 0.661854
[04:49:47.395] train iteration 8485 : loss : 0.610128, loss_ce: 0.769076
[04:50:02.977] val epoch 64 : f1_micro : 0.6507430332047599, f1_macro : 0.5355242618492672, tumor_f1 : 0.7205605592046466, stroma_f1 : 0.5892630240746907, infla_f1 : 0.6624344885349274, necr_f1 : 0.8603852774415698, other_f1 : 0.37145838441626566, acc_micro : 0.8603852774415698
[04:50:04.554] train iteration 8516 : loss : 0.412054, loss_ce: 0.490884
[04:50:24.402] train iteration 8566 : loss : 0.603061, loss_ce: 0.679087
[04:50:44.497] train iteration 8616 : loss : 0.793984, loss_ce: 1.187904
[04:51:00.145] val epoch 65 : f1_micro : 0.6795906254223415, f1_macro : 0.5153379589319229, tumor_f1 : 0.75138472872121, stroma_f1 : 0.5909887797066143, infla_f1 : 0.656709862606866, necr_f1 : 0.8718985063689095, other_f1 : 0.3951506655097806, acc_micro : 0.8718985063689095
[04:51:01.534] train iteration 8647 : loss : 0.680654, loss_ce: 0.936612
[04:51:21.356] train iteration 8697 : loss : 0.481586, loss_ce: 0.681586
[04:51:41.684] train iteration 8747 : loss : 0.666427, loss_ce: 0.854458
[04:51:57.068] val epoch 66 : f1_micro : 0.6413662071738925, f1_macro : 0.514403053692409, tumor_f1 : 0.6968632233994347, stroma_f1 : 0.5733925733449203, infla_f1 : 0.6669877214091164, necr_f1 : 0.8565931192466191, other_f1 : 0.38955498090945184, acc_micro : 0.8565931192466191
[04:51:58.546] train iteration 8778 : loss : 0.701303, loss_ce: 0.983872
[04:52:18.503] train iteration 8828 : loss : 0.614233, loss_ce: 0.746042
[04:52:38.588] train iteration 8878 : loss : 0.638452, loss_ce: 0.850473
[04:52:53.995] val epoch 67 : f1_micro : 0.6275023988315037, f1_macro : 0.5101671729769025, tumor_f1 : 0.7371993022305625, stroma_f1 : 0.5364317130297422, infla_f1 : 0.6911223238067967, necr_f1 : 0.8510514072009495, other_f1 : 0.3802511308874403, acc_micro : 0.8510514072009495
[04:52:55.521] train iteration 8909 : loss : 0.550612, loss_ce: 0.820306
[04:53:15.493] train iteration 8959 : loss : 0.748982, loss_ce: 1.063243
[04:53:35.610] train iteration 9009 : loss : 0.557230, loss_ce: 0.743992
[04:53:51.138] val epoch 68 : f1_micro : 0.606773143368108, f1_macro : 0.4913965804236276, tumor_f1 : 0.7076283693313599, stroma_f1 : 0.5083124575072101, infla_f1 : 0.5749845974413412, necr_f1 : 0.8427349584443229, other_f1 : 0.38937477661030634, acc_micro : 0.8427349584443229
[04:53:52.698] train iteration 9040 : loss : 0.495697, loss_ce: 0.568677
[04:54:12.552] train iteration 9090 : loss : 0.580458, loss_ce: 0.821988
[04:54:32.658] train iteration 9140 : loss : 0.601866, loss_ce: 0.749790
[04:54:48.179] val epoch 69 : f1_micro : 0.6380120047501155, f1_macro : 0.49552910029888153, tumor_f1 : 0.7082425760371345, stroma_f1 : 0.5814812013081142, infla_f1 : 0.5959212886435645, necr_f1 : 0.8552622880254473, other_f1 : 0.3482755386763269, acc_micro : 0.8552622880254473
[04:54:49.624] train iteration 9171 : loss : 0.577672, loss_ce: 0.717409
[04:55:09.518] train iteration 9221 : loss : 0.497305, loss_ce: 0.586227
[04:55:29.695] train iteration 9271 : loss : 0.568642, loss_ce: 0.810380
[04:55:45.224] val epoch 70 : f1_micro : 0.6303082002060754, f1_macro : 0.5053554879767554, tumor_f1 : 0.7366159813744682, stroma_f1 : 0.5342146546712944, infla_f1 : 0.6485684479744772, necr_f1 : 0.8521904860224042, other_f1 : 0.4048680327832699, acc_micro : 0.8521904860224042
[04:55:46.713] train iteration 9302 : loss : 0.562508, loss_ce: 0.904493
[04:56:06.588] train iteration 9352 : loss : 0.703304, loss_ce: 0.912941
[04:56:26.781] train iteration 9402 : loss : 0.586847, loss_ce: 0.891588
[04:56:42.152] val epoch 71 : f1_micro : 0.6205849349498749, f1_macro : 0.4875817916222981, tumor_f1 : 0.7039804330893925, stroma_f1 : 0.5637697018682957, infla_f1 : 0.576669282812093, necr_f1 : 0.8482861305986132, other_f1 : 0.37943654540660127, acc_micro : 0.8482861305986132
[04:56:43.535] train iteration 9433 : loss : 0.665276, loss_ce: 0.972168
[04:57:03.414] train iteration 9483 : loss : 0.706495, loss_ce: 0.993425
[04:57:23.628] train iteration 9533 : loss : 0.488251, loss_ce: 0.637383
[04:57:39.182] val epoch 72 : f1_micro : 0.6713165427957263, f1_macro : 0.54632097695555, tumor_f1 : 0.7124888896942139, stroma_f1 : 0.6382153353520802, infla_f1 : 0.5864631501691682, necr_f1 : 0.8685784978525979, other_f1 : 0.39135799690016676, acc_micro : 0.8685784978525979
[04:57:40.590] train iteration 9564 : loss : 0.601373, loss_ce: 0.777228
[04:58:00.458] train iteration 9614 : loss : 0.620531, loss_ce: 0.856902
[04:58:20.672] train iteration 9664 : loss : 0.525853, loss_ce: 0.682337
[04:58:36.083] val epoch 73 : f1_micro : 0.6585224334682737, f1_macro : 0.5109286404081753, tumor_f1 : 0.7173449567386082, stroma_f1 : 0.6191337789808001, infla_f1 : 0.5577441134623119, necr_f1 : 0.8634422166006905, other_f1 : 0.39364979135072126, acc_micro : 0.8634422166006905
[04:58:37.643] train iteration 9695 : loss : 0.489727, loss_ce: 0.638108
[04:58:57.477] train iteration 9745 : loss : 0.727431, loss_ce: 1.143208
[04:59:17.772] train iteration 9795 : loss : 0.595885, loss_ce: 0.792720
[04:59:33.348] val epoch 74 : f1_micro : 0.6573907371078219, f1_macro : 0.5087294791425977, tumor_f1 : 0.7186678860868726, stroma_f1 : 0.6083547717758587, infla_f1 : 0.6219784851585116, necr_f1 : 0.8630169332027435, other_f1 : 0.40076018444129397, acc_micro : 0.8630169332027435
[04:59:34.810] train iteration 9826 : loss : 0.592812, loss_ce: 0.731876
[04:59:54.707] train iteration 9876 : loss : 0.840815, loss_ce: 1.204643
[05:00:14.951] train iteration 9926 : loss : 0.428810, loss_ce: 0.527349
[05:00:30.484] val epoch 75 : f1_micro : 0.6419032790831157, f1_macro : 0.5069076759474618, tumor_f1 : 0.7133697760956628, stroma_f1 : 0.5948538311890194, infla_f1 : 0.6098929664918354, necr_f1 : 0.856817147561482, other_f1 : 0.38298946007021833, acc_micro : 0.856817147561482
[05:00:31.989] train iteration 9957 : loss : 0.485142, loss_ce: 0.690742
[05:00:51.773] train iteration 10007 : loss : 0.594743, loss_ce: 0.805114
[05:01:11.968] train iteration 10057 : loss : 0.384009, loss_ce: 0.613736
[05:01:27.419] val epoch 76 : f1_micro : 0.6723829060792923, f1_macro : 0.5555538833141327, tumor_f1 : 0.7257633124079023, stroma_f1 : 0.6135560103825161, infla_f1 : 0.6368304001433509, necr_f1 : 0.8689870323453631, other_f1 : 0.40531515303467003, acc_micro : 0.8689870323453631
[05:01:28.891] train iteration 10088 : loss : 0.547414, loss_ce: 0.685866
[05:01:48.830] train iteration 10138 : loss : 0.602517, loss_ce: 0.859907
[05:02:08.983] train iteration 10188 : loss : 0.470894, loss_ce: 0.693132
[05:02:24.531] val epoch 77 : f1_micro : 0.6271358302661351, f1_macro : 0.5239375446523938, tumor_f1 : 0.7085420723472323, stroma_f1 : 0.5653404763766697, infla_f1 : 0.5948569459308471, necr_f1 : 0.8508821385247367, other_f1 : 0.4073821408674121, acc_micro : 0.8508821385247367
[05:02:25.958] train iteration 10219 : loss : 0.676988, loss_ce: 0.942080
[05:02:45.823] train iteration 10269 : loss : 0.510842, loss_ce: 0.554655
[05:03:05.994] train iteration 10319 : loss : 0.492933, loss_ce: 0.632978
[05:03:21.514] val epoch 78 : f1_micro : 0.6626669530357633, f1_macro : 0.5547972938844136, tumor_f1 : 0.7257986920220512, stroma_f1 : 0.6000407002866268, infla_f1 : 0.6720691706453051, necr_f1 : 0.8651047774723598, other_f1 : 0.39746578882581424, acc_micro : 0.8651047774723598
[05:03:22.993] train iteration 10350 : loss : 0.612995, loss_ce: 0.789424
[05:03:42.908] train iteration 10400 : loss : 0.558907, loss_ce: 0.738772
[05:04:03.045] train iteration 10450 : loss : 0.541538, loss_ce: 0.635867
[05:04:18.544] val epoch 79 : f1_micro : 0.6727710515260696, f1_macro : 0.5512920767068863, tumor_f1 : 0.7277190089225769, stroma_f1 : 0.6362234290157046, infla_f1 : 0.628029507717916, necr_f1 : 0.8692094768796649, other_f1 : 0.417016826570034, acc_micro : 0.8692094768796649
[05:04:20.065] train iteration 10481 : loss : 0.782477, loss_ce: 1.181054
[05:04:39.999] train iteration 10531 : loss : 0.415491, loss_ce: 0.506814
[05:05:00.293] train iteration 10581 : loss : 0.643230, loss_ce: 0.791286
[05:05:15.731] val epoch 80 : f1_micro : 0.6388632591281619, f1_macro : 0.5026352107524872, tumor_f1 : 0.7365929058619908, stroma_f1 : 0.5198076314159802, infla_f1 : 0.63702093064785, necr_f1 : 0.8555855623313359, other_f1 : 0.4024860149116388, acc_micro : 0.8555855623313359
[05:05:17.260] train iteration 10612 : loss : 0.514696, loss_ce: 0.671766
[05:05:37.090] train iteration 10662 : loss : 0.511208, loss_ce: 0.563329
[05:05:57.446] train iteration 10712 : loss : 0.557651, loss_ce: 0.730130
[05:06:12.854] val epoch 81 : f1_micro : 0.6293427667447499, f1_macro : 0.5184912617717471, tumor_f1 : 0.7152538789170129, stroma_f1 : 0.5654013438948563, infla_f1 : 0.6193843767978251, necr_f1 : 0.8517830116408212, other_f1 : 0.3409080963049616, acc_micro : 0.8517830116408212
[05:06:14.384] train iteration 10743 : loss : 0.457601, loss_ce: 0.591396
[05:06:34.309] train iteration 10793 : loss : 0.455808, loss_ce: 0.693114
[05:06:54.486] train iteration 10843 : loss : 0.469139, loss_ce: 0.638555
[05:07:09.853] val epoch 82 : f1_micro : 0.6449786765234811, f1_macro : 0.533574715256691, tumor_f1 : 0.722281317625727, stroma_f1 : 0.5722609077181134, infla_f1 : 0.654273271560669, necr_f1 : 0.8580425168786731, other_f1 : 0.40684539786265567, acc_micro : 0.8580425168786731
[05:07:11.376] train iteration 10874 : loss : 0.468623, loss_ce: 0.498781
[05:07:31.299] train iteration 10924 : loss : 0.488464, loss_ce: 0.652496
[05:07:51.443] train iteration 10974 : loss : 0.566795, loss_ce: 0.635491
[05:08:06.866] val epoch 83 : f1_micro : 0.6842228110347476, f1_macro : 0.5524961820670536, tumor_f1 : 0.7305353539330619, stroma_f1 : 0.6580172777175903, infla_f1 : 0.6275035930531365, necr_f1 : 0.873740234545299, other_f1 : 0.39377760800666045, acc_micro : 0.873740234545299
[05:08:08.353] train iteration 11005 : loss : 0.543321, loss_ce: 0.628734
[05:08:28.382] train iteration 11055 : loss : 0.652080, loss_ce: 0.931037
[05:08:48.629] train iteration 11105 : loss : 0.413220, loss_ce: 0.452016
[05:09:04.100] val epoch 84 : f1_micro : 0.6621232011488506, f1_macro : 0.5337714435798782, tumor_f1 : 0.7337087435381753, stroma_f1 : 0.6038611323705741, infla_f1 : 0.6014365213257926, necr_f1 : 0.864904135465622, other_f1 : 0.40096529786075863, acc_micro : 0.864904135465622
[05:09:05.551] train iteration 11136 : loss : 0.690630, loss_ce: 0.980152
[05:09:25.339] train iteration 11186 : loss : 0.534467, loss_ce: 0.791726
[05:09:45.700] train iteration 11236 : loss : 0.550457, loss_ce: 0.830476
[05:10:01.143] val epoch 85 : f1_micro : 0.641740837267467, f1_macro : 0.517161807843617, tumor_f1 : 0.716607425894056, stroma_f1 : 0.5928827034575599, infla_f1 : 0.6483071190970284, necr_f1 : 0.8567435230527606, other_f1 : 0.39159072027541697, acc_micro : 0.8567435230527606
[05:10:02.608] train iteration 11267 : loss : 0.333939, loss_ce: 0.472364
[05:10:22.512] train iteration 11317 : loss : 0.470097, loss_ce: 0.657092
[05:10:42.631] train iteration 11367 : loss : 0.347279, loss_ce: 0.403993
[05:10:58.242] val epoch 86 : f1_micro : 0.6356420772416251, f1_macro : 0.5065778259720121, tumor_f1 : 0.7283658938748496, stroma_f1 : 0.5709440239838192, infla_f1 : 0.6291825329618794, necr_f1 : 0.8543212200914111, other_f1 : 0.3764048200765891, acc_micro : 0.8543212200914111
[05:10:59.799] train iteration 11398 : loss : 0.515068, loss_ce: 0.652140
[05:11:19.673] train iteration 11448 : loss : 0.514503, loss_ce: 0.695906
[05:11:39.895] train iteration 11498 : loss : 0.572449, loss_ce: 0.730790
[05:11:55.360] val epoch 87 : f1_micro : 0.6799165265900748, f1_macro : 0.5533730813435146, tumor_f1 : 0.7451225944927761, stroma_f1 : 0.6139201553804534, infla_f1 : 0.6247056978089469, necr_f1 : 0.8720165363379887, other_f1 : 0.40385664387473036, acc_micro : 0.8720165363379887
[05:11:56.857] train iteration 11529 : loss : 0.516686, loss_ce: 0.752847
[05:12:16.815] train iteration 11579 : loss : 0.301069, loss_ce: 0.399968
[05:12:36.896] train iteration 11629 : loss : 0.476441, loss_ce: 0.612247
[05:12:52.416] val epoch 88 : f1_micro : 0.6827783116272518, f1_macro : 0.566016429236957, tumor_f1 : 0.7340457141399384, stroma_f1 : 0.6396262411560331, infla_f1 : 0.6536505829010691, necr_f1 : 0.8731290783200946, other_f1 : 0.39060347008385826, acc_micro : 0.8731290783200946
[05:12:53.945] train iteration 11660 : loss : 0.571304, loss_ce: 0.800967
[05:13:13.811] train iteration 11710 : loss : 0.581383, loss_ce: 0.643732
[05:13:34.105] train iteration 11760 : loss : 0.477724, loss_ce: 0.567421
[05:13:49.713] val epoch 89 : f1_micro : 0.6679691353014537, f1_macro : 0.5410712382623127, tumor_f1 : 0.7375917264393398, stroma_f1 : 0.5998860118644578, infla_f1 : 0.651402374463422, necr_f1 : 0.8672291593892234, other_f1 : 0.40868496602135046, acc_micro : 0.8672291593892234
[05:13:51.128] train iteration 11791 : loss : 0.687282, loss_ce: 0.955417
[05:14:10.946] train iteration 11841 : loss : 0.553285, loss_ce: 0.669990
[05:14:31.131] train iteration 11891 : loss : 0.724111, loss_ce: 0.979727
[05:14:46.684] val epoch 90 : f1_micro : 0.6570996471813747, f1_macro : 0.5340386927127838, tumor_f1 : 0.7371870066438403, stroma_f1 : 0.588153882750443, infla_f1 : 0.6066900842956134, necr_f1 : 0.8629096022674015, other_f1 : 0.4069689961948565, acc_micro : 0.8629096022674015
[05:14:48.238] train iteration 11922 : loss : 0.438361, loss_ce: 0.597008
[05:15:08.093] train iteration 11972 : loss : 0.473398, loss_ce: 0.647444
[05:15:28.293] train iteration 12022 : loss : 0.697112, loss_ce: 0.904072
[05:15:43.834] val epoch 91 : f1_micro : 0.6697841180222375, f1_macro : 0.5492329512323652, tumor_f1 : 0.7556226551532745, stroma_f1 : 0.5783419151391301, infla_f1 : 0.678433817412172, necr_f1 : 0.8679590906415667, other_f1 : 0.4025123762995853, acc_micro : 0.8679590906415667
[05:15:45.286] train iteration 12053 : loss : 0.505494, loss_ce: 0.621616
[05:16:05.158] train iteration 12103 : loss : 0.711283, loss_ce: 0.911893
[05:16:25.314] train iteration 12153 : loss : 0.535435, loss_ce: 0.726774
[05:16:40.778] val epoch 92 : f1_micro : 0.6168851256370544, f1_macro : 0.4988222909825189, tumor_f1 : 0.7199710160493851, stroma_f1 : 0.5370909859027181, infla_f1 : 0.6398804081337792, necr_f1 : 0.8467949969427926, other_f1 : 0.39256362138049944, acc_micro : 0.8467949969427926
[05:16:42.291] train iteration 12184 : loss : 0.473928, loss_ce: 0.670116
[05:17:02.261] train iteration 12234 : loss : 0.692132, loss_ce: 0.944866
[05:17:22.404] train iteration 12284 : loss : 0.579717, loss_ce: 0.642506
[05:17:37.879] val epoch 93 : f1_micro : 0.6417969124657767, f1_macro : 0.49999445570366724, tumor_f1 : 0.7595054273094449, stroma_f1 : 0.5405905289309365, infla_f1 : 0.5723244590418679, necr_f1 : 0.8567906490394047, other_f1 : 0.41556756517716814, acc_micro : 0.8567906490394047
[05:17:39.363] train iteration 12315 : loss : 0.659060, loss_ce: 0.904530
[05:17:59.232] train iteration 12365 : loss : 0.306090, loss_ce: 0.412269
[05:18:19.430] train iteration 12415 : loss : 0.645257, loss_ce: 0.852357
[05:18:34.797] val epoch 94 : f1_micro : 0.6823541351727077, f1_macro : 0.5486744344234467, tumor_f1 : 0.7505748250654766, stroma_f1 : 0.6135793796607426, infla_f1 : 0.6040136723646096, necr_f1 : 0.8730089664459229, other_f1 : 0.3903537044035537, acc_micro : 0.8730089664459229
[05:18:36.260] train iteration 12446 : loss : 0.607680, loss_ce: 0.794936
[05:18:56.266] train iteration 12496 : loss : 0.459216, loss_ce: 0.645442
[05:19:16.342] train iteration 12546 : loss : 0.598229, loss_ce: 0.835080
[05:19:31.873] val epoch 95 : f1_micro : 0.686945378780365, f1_macro : 0.5607148685625621, tumor_f1 : 0.7518163940736226, stroma_f1 : 0.600530951150826, infla_f1 : 0.6369423493742943, necr_f1 : 0.8748249411582947, other_f1 : 0.41608133619385107, acc_micro : 0.8748249411582947
[05:19:33.357] train iteration 12577 : loss : 0.512804, loss_ce: 0.527116
[05:19:53.396] train iteration 12627 : loss : 0.522703, loss_ce: 0.589059
[05:20:13.477] train iteration 12677 : loss : 0.514721, loss_ce: 0.532042
[05:20:28.996] val epoch 96 : f1_micro : 0.6692470780440739, f1_macro : 0.5203019380569458, tumor_f1 : 0.7316258060080665, stroma_f1 : 0.6227983151163373, infla_f1 : 0.5890694287206445, necr_f1 : 0.8677409248692649, other_f1 : 0.41960001337741104, acc_micro : 0.8677409248692649
[05:20:30.580] train iteration 12708 : loss : 0.581175, loss_ce: 0.868870
[05:20:50.442] train iteration 12758 : loss : 0.512168, loss_ce: 0.640928
[05:21:10.613] train iteration 12808 : loss : 0.454268, loss_ce: 0.541536
[05:21:26.016] val epoch 97 : f1_micro : 0.6303744167089462, f1_macro : 0.5307897531560489, tumor_f1 : 0.7522527873516083, stroma_f1 : 0.4850678656782423, infla_f1 : 0.723552120583398, necr_f1 : 0.8521893109594073, other_f1 : 0.39078233763575554, acc_micro : 0.8521893109594073
[05:21:27.574] train iteration 12839 : loss : 0.737603, loss_ce: 1.063283
[05:21:47.420] train iteration 12889 : loss : 0.599945, loss_ce: 0.879137
[05:22:07.720] train iteration 12939 : loss : 0.632354, loss_ce: 0.920600
[05:22:23.241] val epoch 98 : f1_micro : 0.6842399750437055, f1_macro : 0.5630637833050319, tumor_f1 : 0.7510718788419452, stroma_f1 : 0.6091534942388535, infla_f1 : 0.6560704814536231, necr_f1 : 0.8737455947058541, other_f1 : 0.41676096085991177, acc_micro : 0.8737455947058541
[05:22:24.729] train iteration 12970 : loss : 0.558723, loss_ce: 0.827566
[05:22:44.613] train iteration 13020 : loss : 0.466526, loss_ce: 0.711476
[05:23:04.903] train iteration 13070 : loss : 0.323972, loss_ce: 0.464435
[05:23:20.377] val epoch 99 : f1_micro : 0.6597651626382556, f1_macro : 0.5451875754765102, tumor_f1 : 0.7145468677793231, stroma_f1 : 0.5890732971685273, infla_f1 : 0.6721603849104473, necr_f1 : 0.8639289353575025, other_f1 : 0.4146375469863415, acc_micro : 0.8639289353575025
[05:23:21.181] save model to ./logs/frac_0.5/fold_2/epoch_99.pth
[05:23:22.691] train iteration 13101 : loss : 0.452270, loss_ce: 0.624133
[05:23:42.455] train iteration 13151 : loss : 0.523045, loss_ce: 0.553637
[05:24:02.638] train iteration 13201 : loss : 0.599007, loss_ce: 0.752789
[05:24:18.179] val epoch 100 : f1_micro : 0.6993531201566968, f1_macro : 0.5744834286825997, tumor_f1 : 0.7414959754262652, stroma_f1 : 0.6522599330970219, infla_f1 : 0.6306580581835338, necr_f1 : 0.8797902933188847, other_f1 : 0.3831400262923645, acc_micro : 0.8797902933188847
[05:24:19.671] train iteration 13232 : loss : 0.377306, loss_ce: 0.516428
[05:24:39.524] train iteration 13282 : loss : 0.449632, loss_ce: 0.594558
[05:24:59.805] train iteration 13332 : loss : 0.627231, loss_ce: 0.862043
[05:25:15.345] val epoch 101 : f1_micro : 0.6891475724322456, f1_macro : 0.5815867419753756, tumor_f1 : 0.7456709636109216, stroma_f1 : 0.6228403480989593, infla_f1 : 0.6603224298783711, necr_f1 : 0.8757355638912746, other_f1 : 0.4252227395772934, acc_micro : 0.8757355638912746
[05:25:16.854] train iteration 13363 : loss : 0.649583, loss_ce: 0.842102
[05:25:36.676] train iteration 13413 : loss : 0.264745, loss_ce: 0.349929
[05:25:56.889] train iteration 13463 : loss : 0.605223, loss_ce: 0.842419
[05:26:12.313] val epoch 102 : f1_micro : 0.6558217832020351, f1_macro : 0.5475571858031409, tumor_f1 : 0.7336779534816742, stroma_f1 : 0.602068408791508, infla_f1 : 0.6140166989394596, necr_f1 : 0.8623700567654201, other_f1 : 0.39538030116818845, acc_micro : 0.8623700567654201
[05:26:13.881] train iteration 13494 : loss : 0.532959, loss_ce: 0.780887
[05:26:33.728] train iteration 13544 : loss : 0.527952, loss_ce: 0.740850
[05:26:53.969] train iteration 13594 : loss : 0.507165, loss_ce: 0.599454
[05:27:09.541] val epoch 103 : f1_micro : 0.6875449738332203, f1_macro : 0.5778381547757557, tumor_f1 : 0.7531905600002834, stroma_f1 : 0.6196891739964485, infla_f1 : 0.711071327328682, necr_f1 : 0.8750869589192527, other_f1 : 0.40869197701769217, acc_micro : 0.8750869589192527
[05:27:11.034] train iteration 13625 : loss : 0.428669, loss_ce: 0.585171
[05:27:30.986] train iteration 13675 : loss : 0.377483, loss_ce: 0.457733
[05:27:51.131] train iteration 13725 : loss : 0.360795, loss_ce: 0.488900
[05:28:06.615] val epoch 104 : f1_micro : 0.6202208772301674, f1_macro : 0.5064386214528765, tumor_f1 : 0.7149996140173503, stroma_f1 : 0.5397769872631345, infla_f1 : 0.6422678668584142, necr_f1 : 0.8481428410325732, other_f1 : 0.4178744564165494, acc_micro : 0.8481428410325732
[05:28:08.092] train iteration 13756 : loss : 0.414499, loss_ce: 0.557438
[05:28:27.889] train iteration 13806 : loss : 0.360067, loss_ce: 0.501560
[05:28:48.108] train iteration 13856 : loss : 0.635022, loss_ce: 1.026116
[05:29:03.530] val epoch 105 : f1_micro : 0.6467218079737255, f1_macro : 0.5321758091449738, tumor_f1 : 0.7199242051158633, stroma_f1 : 0.5728321522474289, infla_f1 : 0.6611633981977191, necr_f1 : 0.8587369705949511, other_f1 : 0.3950625377308045, acc_micro : 0.8587369705949511
[05:29:05.047] train iteration 13887 : loss : 0.487664, loss_ce: 0.687937
[05:29:24.864] train iteration 13937 : loss : 0.518754, loss_ce: 0.673071
[05:29:45.105] train iteration 13987 : loss : 0.498237, loss_ce: 0.666439
[05:30:00.714] val epoch 106 : f1_micro : 0.6635769116027015, f1_macro : 0.5438189474599702, tumor_f1 : 0.7538822761603764, stroma_f1 : 0.5834841653704643, infla_f1 : 0.6303664829049792, necr_f1 : 0.8654650747776031, other_f1 : 0.41137743688055445, acc_micro : 0.8654650747776031
[05:30:02.237] train iteration 14018 : loss : 0.379716, loss_ce: 0.541030
[05:30:21.998] train iteration 14068 : loss : 0.295550, loss_ce: 0.361760
[05:30:42.251] train iteration 14118 : loss : 0.672360, loss_ce: 0.923605
[05:30:57.697] val epoch 107 : f1_micro : 0.6576507006372724, f1_macro : 0.5490896467651639, tumor_f1 : 0.7468205392360687, stroma_f1 : 0.5821853003331593, infla_f1 : 0.6861221151692527, necr_f1 : 0.8630877988679069, other_f1 : 0.4055072675858225, acc_micro : 0.8630877988679069
[05:30:59.107] train iteration 14149 : loss : 0.495586, loss_ce: 0.308739
[05:31:19.065] train iteration 14199 : loss : 0.597642, loss_ce: 0.959043
[05:31:39.172] train iteration 14249 : loss : 0.448577, loss_ce: 0.575399
[05:31:54.580] val epoch 108 : f1_micro : 0.6818863110882896, f1_macro : 0.5791403076478413, tumor_f1 : 0.7445749938488007, stroma_f1 : 0.6116753071546555, infla_f1 : 0.6800014350031104, necr_f1 : 0.8728176142488208, other_f1 : 0.4047188724258116, acc_micro : 0.8728176142488208
[05:31:56.066] train iteration 14280 : loss : 0.435332, loss_ce: 0.535569
[05:32:16.040] train iteration 14330 : loss : 0.385302, loss_ce: 0.529108
[05:32:36.256] train iteration 14380 : loss : 0.377787, loss_ce: 0.467281
[05:32:51.593] val epoch 109 : f1_micro : 0.6419890852911132, f1_macro : 0.5017294415405819, tumor_f1 : 0.7237994819879532, stroma_f1 : 0.5787086955138615, infla_f1 : 0.6450293410037246, necr_f1 : 0.8568733547415052, other_f1 : 0.4153204581567219, acc_micro : 0.8568733547415052
[05:32:53.124] train iteration 14411 : loss : 0.455301, loss_ce: 0.575797
[05:33:12.981] train iteration 14461 : loss : 0.476777, loss_ce: 0.670013
[05:33:33.219] train iteration 14511 : loss : 0.430605, loss_ce: 0.607844
[05:33:48.652] val epoch 110 : f1_micro : 0.6838111749717167, f1_macro : 0.5448494532278606, tumor_f1 : 0.729140390242849, stroma_f1 : 0.6394253947905132, infla_f1 : 0.6289694697729179, necr_f1 : 0.8735932622637067, other_f1 : 0.4139809358332838, acc_micro : 0.8735932622637067
[05:33:50.147] train iteration 14542 : loss : 0.366633, loss_ce: 0.492325
[05:34:09.991] train iteration 14592 : loss : 0.504563, loss_ce: 0.632022
[05:34:30.037] train iteration 14642 : loss : 0.403380, loss_ce: 0.555990
[05:34:45.660] val epoch 111 : f1_micro : 0.6363730302878788, f1_macro : 0.5371905224663871, tumor_f1 : 0.7340610176324844, stroma_f1 : 0.5612225372876439, infla_f1 : 0.587002864905766, necr_f1 : 0.8545880487986973, other_f1 : 0.41829468097005573, acc_micro : 0.8545880487986973
[05:34:47.081] train iteration 14673 : loss : 0.388316, loss_ce: 0.491073
[05:35:06.897] train iteration 14723 : loss : 0.565423, loss_ce: 0.781467
[05:35:27.204] train iteration 14773 : loss : 0.603643, loss_ce: 0.756025
[05:35:42.693] val epoch 112 : f1_micro : 0.6952298432588577, f1_macro : 0.5627691128424236, tumor_f1 : 0.739053704908916, stroma_f1 : 0.641834693295615, infla_f1 : 0.6293106931926948, necr_f1 : 0.8781352724347796, other_f1 : 0.41303014223064693, acc_micro : 0.8781352724347796
[05:35:44.143] train iteration 14804 : loss : 0.657416, loss_ce: 0.848287
[05:36:03.956] train iteration 14854 : loss : 0.669162, loss_ce: 0.927996
[05:36:24.092] train iteration 14904 : loss : 0.536652, loss_ce: 0.648563
[05:36:39.623] val epoch 113 : f1_micro : 0.6689867441143308, f1_macro : 0.5505336608205523, tumor_f1 : 0.7217910843236106, stroma_f1 : 0.6260400414466858, infla_f1 : 0.5902404698676297, necr_f1 : 0.8676152910505023, other_f1 : 0.4144178078110729, acc_micro : 0.8676152910505023
[05:36:41.073] train iteration 14935 : loss : 0.499058, loss_ce: 0.702960
[05:37:00.949] train iteration 14985 : loss : 0.478783, loss_ce: 0.609978
[05:37:21.147] train iteration 15035 : loss : 0.488035, loss_ce: 0.656140
[05:37:36.664] val epoch 114 : f1_micro : 0.6792810985020229, f1_macro : 0.5504299466099057, tumor_f1 : 0.7290201144559043, stroma_f1 : 0.6367582327553204, infla_f1 : 0.6103399337402412, necr_f1 : 0.8717650132519859, other_f1 : 0.41292581520974636, acc_micro : 0.8717650132519859
[05:37:38.179] train iteration 15066 : loss : 0.587159, loss_ce: 0.655751
[05:37:58.010] train iteration 15116 : loss : 0.508583, loss_ce: 0.535373
[05:38:18.059] train iteration 15166 : loss : 0.280270, loss_ce: 0.345286
[05:38:33.648] val epoch 115 : f1_micro : 0.6672618751014981, f1_macro : 0.5577504932880402, tumor_f1 : 0.7118803837469646, stroma_f1 : 0.6027127749153546, infla_f1 : 0.6265150122344494, necr_f1 : 0.8669743750776563, other_f1 : 0.4031458163101758, acc_micro : 0.8669743750776563
[05:38:35.048] train iteration 15197 : loss : 0.408108, loss_ce: 0.601646
[05:38:54.884] train iteration 15247 : loss : 0.581614, loss_ce: 0.851165
[05:39:15.130] train iteration 15297 : loss : 0.392110, loss_ce: 0.521860
[05:39:30.645] val epoch 116 : f1_micro : 0.6462961243731635, f1_macro : 0.5446799509227276, tumor_f1 : 0.7212115824222565, stroma_f1 : 0.5848005903618676, infla_f1 : 0.5751313737460545, necr_f1 : 0.8585439026355743, other_f1 : 0.41431896282093866, acc_micro : 0.8585439026355743
[05:39:32.120] train iteration 15328 : loss : 0.558854, loss_ce: 0.651115
[05:39:51.910] train iteration 15378 : loss : 0.638463, loss_ce: 0.774370
[05:40:12.142] train iteration 15428 : loss : 0.514396, loss_ce: 0.547857
[05:40:27.691] val epoch 117 : f1_micro : 0.6958304941654205, f1_macro : 0.578600845166615, tumor_f1 : 0.7408370545932225, stroma_f1 : 0.6437343678304127, infla_f1 : 0.6251271441578865, necr_f1 : 0.8783665427139827, other_f1 : 0.40300737453591345, acc_micro : 0.8783665427139827
[05:40:29.187] train iteration 15459 : loss : 0.403898, loss_ce: 0.585302
[05:40:49.043] train iteration 15509 : loss : 0.701184, loss_ce: 1.030991
[05:41:09.172] train iteration 15559 : loss : 0.670460, loss_ce: 0.992867
[05:41:24.595] val epoch 118 : f1_micro : 0.6539672549281802, f1_macro : 0.528694327388491, tumor_f1 : 0.7270953484943935, stroma_f1 : 0.5816088914871216, infla_f1 : 0.6343707048467228, necr_f1 : 0.8616914663996015, other_f1 : 0.4184171866093363, acc_micro : 0.8616914663996015
[05:41:26.125] train iteration 15590 : loss : 0.545400, loss_ce: 0.762040
[05:41:46.048] train iteration 15640 : loss : 0.568326, loss_ce: 0.641854
[05:42:06.227] train iteration 15690 : loss : 0.493395, loss_ce: 0.636936
[05:42:21.764] val epoch 119 : f1_micro : 0.6928669810295105, f1_macro : 0.559483466403825, tumor_f1 : 0.7347783893346786, stroma_f1 : 0.649012810417584, infla_f1 : 0.6033101912055697, necr_f1 : 0.8772016380514417, other_f1 : 0.41004917877061026, acc_micro : 0.8772016380514417
[05:42:23.288] train iteration 15721 : loss : 0.425126, loss_ce: 0.657596
[05:42:43.135] train iteration 15771 : loss : 0.545874, loss_ce: 0.801675
[05:43:03.398] train iteration 15821 : loss : 0.424627, loss_ce: 0.481239
[05:43:19.104] val epoch 120 : f1_micro : 0.6451496375458581, f1_macro : 0.5181822542633329, tumor_f1 : 0.7512123776333672, stroma_f1 : 0.5473585871181318, infla_f1 : 0.6040244908737284, necr_f1 : 0.8581238857337407, other_f1 : 0.39832589100115, acc_micro : 0.8581238857337407
[05:43:20.607] train iteration 15852 : loss : 0.587882, loss_ce: 0.711275
[05:43:40.446] train iteration 15902 : loss : 0.517109, loss_ce: 0.747371
[05:44:00.694] train iteration 15952 : loss : 0.454567, loss_ce: 0.516837
[05:44:16.207] val epoch 121 : f1_micro : 0.649356267281941, f1_macro : 0.5235707121235984, tumor_f1 : 0.7413702862603324, stroma_f1 : 0.5636848275150571, infla_f1 : 0.6221314117844615, necr_f1 : 0.8598033956118992, other_f1 : 0.40878439717926085, acc_micro : 0.8598033956118992
[05:44:17.728] train iteration 15983 : loss : 0.538436, loss_ce: 0.827047
[05:44:37.527] train iteration 16033 : loss : 0.425787, loss_ce: 0.531521
[05:44:57.750] train iteration 16083 : loss : 0.570191, loss_ce: 0.699186
[05:45:13.436] val epoch 122 : f1_micro : 0.6765327198164803, f1_macro : 0.5507230279701096, tumor_f1 : 0.7371095078332084, stroma_f1 : 0.6262779853173664, infla_f1 : 0.5866989019726004, necr_f1 : 0.8706323845045907, other_f1 : 0.41373113808887346, acc_micro : 0.8706323845045907
[05:45:14.925] train iteration 16114 : loss : 0.613054, loss_ce: 0.742865
[05:45:34.795] train iteration 16164 : loss : 0.365094, loss_ce: 0.453234
[05:45:54.977] train iteration 16214 : loss : 0.300730, loss_ce: 0.463215
[05:46:10.470] val epoch 123 : f1_micro : 0.6658852909292493, f1_macro : 0.5595323996884483, tumor_f1 : 0.7451162040233612, stroma_f1 : 0.5891859552689961, infla_f1 : 0.6050367946071284, necr_f1 : 0.8663971934999738, other_f1 : 0.41098775076014654, acc_micro : 0.8663971934999738
[05:46:12.028] train iteration 16245 : loss : 0.448488, loss_ce: 0.565063
[05:46:31.817] train iteration 16295 : loss : 0.434779, loss_ce: 0.615055
[05:46:52.088] train iteration 16345 : loss : 0.533279, loss_ce: 0.804141
[05:47:07.563] val epoch 124 : f1_micro : 0.6788553084645953, f1_macro : 0.5594564633710044, tumor_f1 : 0.7490233097757611, stroma_f1 : 0.616818697324821, infla_f1 : 0.6489971890114248, necr_f1 : 0.8715804772717612, other_f1 : 0.4029570385880236, acc_micro : 0.8715804772717612
[05:47:09.048] train iteration 16376 : loss : 0.565261, loss_ce: 0.858499
[05:47:28.906] train iteration 16426 : loss : 0.487840, loss_ce: 0.705284
[05:47:49.131] train iteration 16476 : loss : 0.316431, loss_ce: 0.365986
[05:48:04.571] val epoch 125 : f1_micro : 0.6611477179186684, f1_macro : 0.5340778976678848, tumor_f1 : 0.7209169524056571, stroma_f1 : 0.6205816162484032, infla_f1 : 0.6095025234722665, necr_f1 : 0.8644944897719792, other_f1 : 0.40749140413078877, acc_micro : 0.8644944897719792
[05:48:06.050] train iteration 16507 : loss : 0.532034, loss_ce: 0.610061
[05:48:25.924] train iteration 16557 : loss : 0.572390, loss_ce: 0.820086
[05:48:46.126] train iteration 16607 : loss : 0.491807, loss_ce: 0.715021
[05:49:01.566] val epoch 126 : f1_micro : 0.6896805465221405, f1_macro : 0.5432740141238485, tumor_f1 : 0.7372850946017674, stroma_f1 : 0.6418901234865189, infla_f1 : 0.6291536039539746, necr_f1 : 0.8759486888136182, other_f1 : 0.40993588604032993, acc_micro : 0.8759486888136182
[05:49:03.086] train iteration 16638 : loss : 0.433789, loss_ce: 0.642951
[05:49:22.960] train iteration 16688 : loss : 0.650706, loss_ce: 0.975763
[05:49:43.161] train iteration 16738 : loss : 0.395721, loss_ce: 0.529825
[05:49:58.692] val epoch 127 : f1_micro : 0.6513807369129998, f1_macro : 0.4923816557441439, tumor_f1 : 0.7392837532929012, stroma_f1 : 0.56993140067373, infla_f1 : 0.5740541225033147, necr_f1 : 0.8606188510145459, other_f1 : 0.42031820650611607, acc_micro : 0.8606188510145459
[05:50:00.179] train iteration 16769 : loss : 0.514916, loss_ce: 0.798232
[05:50:19.956] train iteration 16819 : loss : 0.438225, loss_ce: 0.617520
[05:50:40.214] train iteration 16869 : loss : 0.390939, loss_ce: 0.411274
[05:50:55.878] val epoch 128 : f1_micro : 0.6706804462841579, f1_macro : 0.5577600811208997, tumor_f1 : 0.7378927618265152, stroma_f1 : 0.6111960666520255, infla_f1 : 0.6521910742989608, necr_f1 : 0.8683105834892818, other_f1 : 0.41587659823043005, acc_micro : 0.8683105834892818
[05:50:57.501] train iteration 16900 : loss : 0.407141, loss_ce: 0.522411
[05:51:17.325] train iteration 16950 : loss : 0.555361, loss_ce: 0.680474
[05:51:37.518] train iteration 17000 : loss : 0.470374, loss_ce: 0.585402
[05:51:52.909] val epoch 129 : f1_micro : 0.6576936074665615, f1_macro : 0.5131364241242409, tumor_f1 : 0.7297506247247968, stroma_f1 : 0.610560227717672, infla_f1 : 0.5605553427844175, necr_f1 : 0.8631137907505035, other_f1 : 0.4088672460722072, acc_micro : 0.8631137907505035
[05:51:54.484] train iteration 17031 : loss : 0.443755, loss_ce: 0.607800
[05:52:14.523] train iteration 17081 : loss : 0.669251, loss_ce: 0.917945
[05:52:34.701] train iteration 17131 : loss : 0.486217, loss_ce: 0.762097
[05:52:50.172] val epoch 130 : f1_micro : 0.664550821696009, f1_macro : 0.5407486430236271, tumor_f1 : 0.750794285110065, stroma_f1 : 0.5835309358579772, infla_f1 : 0.6777046503765243, necr_f1 : 0.8658860325813293, other_f1 : 0.41213658531861647, acc_micro : 0.8658860325813293
[05:52:51.692] train iteration 17162 : loss : 0.399476, loss_ce: 0.485292
[05:53:11.558] train iteration 17212 : loss : 0.432286, loss_ce: 0.566809
[05:53:31.670] train iteration 17262 : loss : 0.629816, loss_ce: 0.751855
[05:53:47.400] val epoch 131 : f1_micro : 0.6809997728892735, f1_macro : 0.5614587771041053, tumor_f1 : 0.7316906792776925, stroma_f1 : 0.6430554070643016, infla_f1 : 0.6309319199728114, necr_f1 : 0.8724339732101986, other_f1 : 0.4072854753716716, acc_micro : 0.8724339732101986
[05:53:48.960] train iteration 17293 : loss : 0.456963, loss_ce: 0.616097
[05:54:08.875] train iteration 17343 : loss : 0.434031, loss_ce: 0.582166
[05:54:29.092] train iteration 17393 : loss : 0.513169, loss_ce: 0.725695
[05:54:44.627] val epoch 132 : f1_micro : 0.6865563243627548, f1_macro : 0.5437298991850444, tumor_f1 : 0.7527058976037162, stroma_f1 : 0.6282626113721302, infla_f1 : 0.6230328849383763, necr_f1 : 0.8746735581329891, other_f1 : 0.3988195631120886, acc_micro : 0.8746735581329891
[05:54:46.085] train iteration 17424 : loss : 0.459305, loss_ce: 0.684242
[05:55:06.014] train iteration 17474 : loss : 0.557942, loss_ce: 0.711289
[05:55:26.285] train iteration 17524 : loss : 0.469348, loss_ce: 0.541799
[05:55:41.789] val epoch 133 : f1_micro : 0.6362505257129669, f1_macro : 0.5424467240061078, tumor_f1 : 0.7321156625236783, stroma_f1 : 0.5569205049957547, infla_f1 : 0.6600905127291169, necr_f1 : 0.8545407439981189, other_f1 : 0.40546868884536835, acc_micro : 0.8545407439981189
[05:55:43.253] train iteration 17555 : loss : 0.597733, loss_ce: 0.767677
[05:56:03.197] train iteration 17605 : loss : 0.563142, loss_ce: 0.893415
[05:56:23.300] train iteration 17655 : loss : 0.456515, loss_ce: 0.564733
[05:56:38.892] val epoch 134 : f1_micro : 0.6872101681573051, f1_macro : 0.5850508404629571, tumor_f1 : 0.7477199009486607, stroma_f1 : 0.6242997284446444, infla_f1 : 0.6772934326103756, necr_f1 : 0.8749301220689502, other_f1 : 0.417956539030586, acc_micro : 0.8749301220689502
[05:56:40.394] train iteration 17686 : loss : 0.406256, loss_ce: 0.579901
[05:57:00.286] train iteration 17736 : loss : 0.513891, loss_ce: 0.719777
[05:57:20.566] train iteration 17786 : loss : 0.482197, loss_ce: 0.625197
[05:57:36.076] val epoch 135 : f1_micro : 0.7002043830496925, f1_macro : 0.538954713514873, tumor_f1 : 0.742059833237103, stroma_f1 : 0.6645708680152893, infla_f1 : 0.602656427770853, necr_f1 : 0.8801422502313342, other_f1 : 0.39959360499467167, acc_micro : 0.8801422502313342
[05:57:37.582] train iteration 17817 : loss : 0.657831, loss_ce: 0.820088
[05:57:57.434] train iteration 17867 : loss : 0.432871, loss_ce: 0.603715
[05:58:17.669] train iteration 17917 : loss : 0.328444, loss_ce: 0.466272
[05:58:33.127] val epoch 136 : f1_micro : 0.6997128405741283, f1_macro : 0.5754549545901162, tumor_f1 : 0.7469758433955056, stroma_f1 : 0.6500463294131416, infla_f1 : 0.6133331805467606, necr_f1 : 0.8799407269273486, other_f1 : 0.41277467938406126, acc_micro : 0.8799407269273486
[05:58:34.657] train iteration 17948 : loss : 0.510365, loss_ce: 0.652509
[05:58:54.598] train iteration 17998 : loss : 0.406824, loss_ce: 0.548884
[05:59:14.765] train iteration 18048 : loss : 0.776535, loss_ce: 1.084205
[05:59:30.402] val epoch 137 : f1_micro : 0.66981854396207, f1_macro : 0.5424128515379769, tumor_f1 : 0.7401548240865979, stroma_f1 : 0.6008500371660505, infla_f1 : 0.6127238561000142, necr_f1 : 0.8679845120225634, other_f1 : 0.4062240926016654, acc_micro : 0.8679845120225634
[05:59:31.940] train iteration 18079 : loss : 0.591455, loss_ce: 0.651338
[05:59:51.827] train iteration 18129 : loss : 0.444070, loss_ce: 0.566895
[06:00:11.987] train iteration 18179 : loss : 0.527752, loss_ce: 0.719177
[06:00:27.535] val epoch 138 : f1_micro : 0.6813398748636246, f1_macro : 0.5529460310935974, tumor_f1 : 0.7413298955985478, stroma_f1 : 0.6290402604000909, infla_f1 : 0.6133847321782794, necr_f1 : 0.8725717493465969, other_f1 : 0.4117505598281111, acc_micro : 0.8725717493465969
[06:00:29.015] train iteration 18210 : loss : 0.392929, loss_ce: 0.523141
[06:00:48.877] train iteration 18260 : loss : 0.299277, loss_ce: 0.463556
[06:01:08.981] train iteration 18310 : loss : 0.397486, loss_ce: 0.574807
[06:01:24.414] val epoch 139 : f1_micro : 0.6801871423210416, f1_macro : 0.5602974423340389, tumor_f1 : 0.754204232777868, stroma_f1 : 0.6110267511435917, infla_f1 : 0.6063607037067413, necr_f1 : 0.872119379895074, other_f1 : 0.4051210153847933, acc_micro : 0.872119379895074
[06:01:25.971] train iteration 18341 : loss : 0.468083, loss_ce: 0.514529
[06:01:45.925] train iteration 18391 : loss : 0.390923, loss_ce: 0.524921
[06:02:06.081] train iteration 18441 : loss : 0.390889, loss_ce: 0.392844
[06:02:21.622] val epoch 140 : f1_micro : 0.6999218123299735, f1_macro : 0.5635305600506919, tumor_f1 : 0.754079880458968, stroma_f1 : 0.6485314071178436, infla_f1 : 0.6137662681617907, necr_f1 : 0.8800287842750549, other_f1 : 0.41774644516408443, acc_micro : 0.8800287842750549
[06:02:23.105] train iteration 18472 : loss : 0.398971, loss_ce: 0.531865
[06:02:42.941] train iteration 18522 : loss : 0.227055, loss_ce: 0.237590
[06:03:03.273] train iteration 18572 : loss : 0.390775, loss_ce: 0.573104
[06:03:18.560] val epoch 141 : f1_micro : 0.6828602296965463, f1_macro : 0.5612860172986984, tumor_f1 : 0.7467183236564908, stroma_f1 : 0.6245123488562447, infla_f1 : 0.6044324157493455, necr_f1 : 0.8731895089149475, other_f1 : 0.4159654916397163, acc_micro : 0.8731895089149475
[06:03:20.026] train iteration 18603 : loss : 0.434627, loss_ce: 0.560539
[06:03:39.927] train iteration 18653 : loss : 0.453853, loss_ce: 0.615928
[06:04:00.137] train iteration 18703 : loss : 0.568787, loss_ce: 0.742905
[06:04:15.617] val epoch 142 : f1_micro : 0.6927486402647836, f1_macro : 0.5581603241818291, tumor_f1 : 0.7511880631957736, stroma_f1 : 0.6378584567989621, infla_f1 : 0.6090556308627129, necr_f1 : 0.8771538691861289, other_f1 : 0.4151351023465395, acc_micro : 0.8771538691861289
[06:04:17.084] train iteration 18734 : loss : 0.513174, loss_ce: 0.560915
[06:04:36.995] train iteration 18784 : loss : 0.411686, loss_ce: 0.570189
[06:04:57.031] train iteration 18834 : loss : 0.372273, loss_ce: 0.546259
[06:05:12.647] val epoch 143 : f1_micro : 0.6640792105879102, f1_macro : 0.5174849980643818, tumor_f1 : 0.7529805366482053, stroma_f1 : 0.5950422180550439, infla_f1 : 0.6237668560019561, necr_f1 : 0.8656933903694153, other_f1 : 0.4025450431342636, acc_micro : 0.8656933903694153
[06:05:14.183] train iteration 18865 : loss : 0.443253, loss_ce: 0.670731
[06:05:34.149] train iteration 18915 : loss : 0.555846, loss_ce: 0.666672
[06:05:54.277] train iteration 18965 : loss : 0.488533, loss_ce: 0.732694
[06:06:09.741] val epoch 144 : f1_micro : 0.6850112101861409, f1_macro : 0.5872505924531392, tumor_f1 : 0.7522062552826745, stroma_f1 : 0.627378482903753, infla_f1 : 0.6848905363253185, necr_f1 : 0.8740512643541608, other_f1 : 0.41793451298560413, acc_micro : 0.8740512643541608
[06:06:11.218] train iteration 18996 : loss : 0.326337, loss_ce: 0.475809
[06:06:31.198] train iteration 19046 : loss : 0.493932, loss_ce: 0.666610
[06:06:51.315] train iteration 19096 : loss : 0.403720, loss_ce: 0.539249
[06:07:06.721] val epoch 145 : f1_micro : 0.6864441377776009, f1_macro : 0.5850437028067452, tumor_f1 : 0.7537728760923658, stroma_f1 : 0.6274923171315875, infla_f1 : 0.6924429014325142, necr_f1 : 0.8746358369077954, other_f1 : 0.4109959179269416, acc_micro : 0.8746358369077954
[06:07:08.265] train iteration 19127 : loss : 0.345825, loss_ce: 0.460179
[06:07:28.085] train iteration 19177 : loss : 0.335829, loss_ce: 0.353244
[06:07:48.329] train iteration 19227 : loss : 0.352754, loss_ce: 0.484742
[06:08:03.868] val epoch 146 : f1_micro : 0.6734701756920133, f1_macro : 0.5664810080613408, tumor_f1 : 0.7521378653390067, stroma_f1 : 0.6072824363197599, infla_f1 : 0.6246654676007373, necr_f1 : 0.8694328963756561, other_f1 : 0.415447042456695, acc_micro : 0.8694328963756561
[06:08:05.275] train iteration 19258 : loss : 0.445826, loss_ce: 0.652451
[06:08:25.054] train iteration 19308 : loss : 0.256111, loss_ce: 0.254303
[06:08:45.264] train iteration 19358 : loss : 0.421789, loss_ce: 0.474642
[06:09:01.023] val epoch 147 : f1_micro : 0.6871164334671838, f1_macro : 0.5754843673535756, tumor_f1 : 0.7549225687980652, stroma_f1 : 0.6241493991443089, infla_f1 : 0.6349823432309287, necr_f1 : 0.8748935759067535, other_f1 : 0.41625911369919777, acc_micro : 0.8748935759067535
[06:09:02.481] train iteration 19389 : loss : 0.576572, loss_ce: 0.684637
[06:09:22.319] train iteration 19439 : loss : 0.545453, loss_ce: 0.700048
[06:09:42.605] train iteration 19489 : loss : 0.329954, loss_ce: 0.437661
[06:09:58.038] val epoch 148 : f1_micro : 0.6970798543521336, f1_macro : 0.5920235535928181, tumor_f1 : 0.7531435000044959, stroma_f1 : 0.6444872894457409, infla_f1 : 0.6978181978421552, necr_f1 : 0.8788792661258152, other_f1 : 0.4152383330677237, acc_micro : 0.8788792661258152
[06:09:59.502] train iteration 19520 : loss : 0.565678, loss_ce: 0.677850
[06:10:19.409] train iteration 19570 : loss : 0.399612, loss_ce: 0.499401
[06:10:39.586] train iteration 19620 : loss : 0.415450, loss_ce: 0.605445
[06:10:55.054] val epoch 149 : f1_micro : 0.6925342849322728, f1_macro : 0.5769796371459961, tumor_f1 : 0.7524576080696923, stroma_f1 : 0.6375426139150348, infla_f1 : 0.6297832626317229, necr_f1 : 0.8770621589251927, other_f1 : 0.4166728031954595, acc_micro : 0.8770621589251927
[06:10:55.894] save model to ./logs/frac_0.5/fold_2/epoch_149.pth
[06:10:56.828] save model to ./logs/frac_0.5/fold_2/epoch_149.pth

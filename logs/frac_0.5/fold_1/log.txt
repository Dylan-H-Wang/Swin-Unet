[01:27:18.192] Namespace(root_path='../data/bcss/L0_1024_s512', dataset='bcss', list_dir='./lists/lists_Synapse', num_classes=6, output_dir='./logs/frac_0.5/fold_1', max_iterations=30000, max_epochs=150, batch_size=24, n_gpu=1, deterministic=0, base_lr=0.05, img_size=224, seed=1234, cfg='configs/swin_tiny_patch4_window7_224_lite.yaml', opts=None, zip=False, cache_mode='part', resume=None, accumulation_steps=None, use_checkpoint=False, amp_opt_level='O1', tag=None, eval=False, throughput=False, frac=0.5, fold=1)
[01:27:18.216] Reading 9897 files in ../data/bcss/L0_1024_s512/data.csv...
[01:27:18.228] Using fold 1 and keep 6439 train files only...
[01:27:18.228] Removing images with threshold of 0.1...
[01:27:18.229] Create train set with 5830 files...
[01:27:18.231] Use 0.5 percent of data to train: 2915!
[01:27:18.239] Reading 804 files in ../data/bcss/L0_1024_s512/val_data.csv...
[01:27:18.242] Using fold 1 and keep 520 val files only...
[01:27:18.242] Removing images with threshold of 0.1...
[01:27:18.243] Create val set with 439 files...
[01:27:19.117] 122 iterations per epoch. 18300 max iterations 
[01:27:21.932] train iteration 1 : loss : 1.282894, loss_ce: 1.921635
[01:27:41.576] train iteration 51 : loss : 0.957314, loss_ce: 1.208152
[01:28:01.444] train iteration 101 : loss : 1.106953, loss_ce: 1.611799
[01:28:16.933] val epoch 0 : f1_micro : 0.6261384911262072, f1_macro : 0.306618458376481, tumor_f1 : 0.686273639018719, stroma_f1 : 0.6450918196485593, infla_f1 : 0.03672461349588747, necr_f1 : 0.8509697570250585, other_f1 : 0.0011203662131895097, acc_micro : 0.8509697570250585
[01:28:18.491] train iteration 123 : loss : 0.983725, loss_ce: 1.347463
[01:28:38.589] train iteration 173 : loss : 0.673402, loss_ce: 0.975446
[01:28:58.816] train iteration 223 : loss : 0.988512, loss_ce: 1.387069
[01:29:13.813] val epoch 1 : f1_micro : 0.6307739168405533, f1_macro : 0.45764633783927333, tumor_f1 : 0.6603538359587009, stroma_f1 : 0.6527492423506024, infla_f1 : 0.042553505764002554, necr_f1 : 0.8523541482595297, other_f1 : 0.3941135522551261, acc_micro : 0.8523541482595297
[01:29:15.197] train iteration 245 : loss : 0.759595, loss_ce: 0.998418
[01:29:35.125] train iteration 295 : loss : 0.875560, loss_ce: 1.178393
[01:29:55.501] train iteration 345 : loss : 0.820036, loss_ce: 1.004629
[01:30:10.266] val epoch 2 : f1_micro : 0.6354035414182223, f1_macro : 0.45902533485339236, tumor_f1 : 0.6772130487056879, stroma_f1 : 0.6556288083621229, infla_f1 : 0.03305007446313259, necr_f1 : 0.8541746047826914, other_f1 : 0.390773185242254, acc_micro : 0.8541746047826914
[01:30:11.700] train iteration 367 : loss : 0.790810, loss_ce: 0.964451
[01:30:31.579] train iteration 417 : loss : 0.921418, loss_ce: 1.330178
[01:30:51.859] train iteration 467 : loss : 1.044575, loss_ce: 1.505831
[01:31:06.575] val epoch 3 : f1_micro : 0.623450328524296, f1_macro : 0.3825230546868764, tumor_f1 : 0.6991697549819946, stroma_f1 : 0.613930108742072, infla_f1 : 0.07345473317680164, necr_f1 : 0.8494017766072199, other_f1 : 0.39055719236449266, acc_micro : 0.8494017766072199
[01:31:08.088] train iteration 489 : loss : 0.794426, loss_ce: 1.006493
[01:31:27.930] train iteration 539 : loss : 0.734226, loss_ce: 0.886312
[01:31:48.179] train iteration 589 : loss : 0.986668, loss_ce: 1.409192
[01:32:02.711] val epoch 4 : f1_micro : 0.6401173552641501, f1_macro : 0.40675370223247087, tumor_f1 : 0.686677859379695, stroma_f1 : 0.6569695859574355, infla_f1 : 0.04279555921507731, necr_f1 : 0.856073627105126, other_f1 : 0.33284568224245537, acc_micro : 0.856073627105126
[01:32:04.198] train iteration 611 : loss : 0.778803, loss_ce: 1.249929
[01:32:24.202] train iteration 661 : loss : 0.725487, loss_ce: 0.875846
[01:32:44.326] train iteration 711 : loss : 0.824436, loss_ce: 1.144539
[01:32:59.063] val epoch 5 : f1_micro : 0.6593538110072796, f1_macro : 0.476532260958965, tumor_f1 : 0.7205289556429937, stroma_f1 : 0.6613772491422983, infla_f1 : 0.16424927428866234, necr_f1 : 0.8637568515080672, other_f1 : 0.44544959489184505, acc_micro : 0.8637568515080672
[01:33:00.564] train iteration 733 : loss : 0.792430, loss_ce: 0.998579
[01:33:20.504] train iteration 783 : loss : 0.753511, loss_ce: 0.999591
[01:33:40.648] train iteration 833 : loss : 0.821603, loss_ce: 1.094948
[01:33:55.317] val epoch 6 : f1_micro : 0.6762629621303998, f1_macro : 0.49737823009490967, tumor_f1 : 0.7464492000066317, stroma_f1 : 0.6574036312791017, infla_f1 : 0.2991584917673698, necr_f1 : 0.8705175312665793, other_f1 : 0.3801742377623808, acc_micro : 0.8705175312665793
[01:33:56.738] train iteration 855 : loss : 0.815743, loss_ce: 1.154175
[01:34:16.477] train iteration 905 : loss : 0.752246, loss_ce: 0.938686
[01:34:36.748] train iteration 955 : loss : 0.821852, loss_ce: 1.094957
[01:34:51.629] val epoch 7 : f1_micro : 0.6977729533727353, f1_macro : 0.5294002993748739, tumor_f1 : 0.7633576026329627, stroma_f1 : 0.6636881816845673, infla_f1 : 0.4628470385303864, necr_f1 : 0.8791192128108098, other_f1 : 0.40953335182544276, acc_micro : 0.8791192128108098
[01:34:53.127] train iteration 977 : loss : 0.789319, loss_ce: 1.081803
[01:35:12.972] train iteration 1027 : loss : 0.711189, loss_ce: 0.926529
[01:35:33.142] train iteration 1077 : loss : 0.798776, loss_ce: 1.009002
[01:35:47.869] val epoch 8 : f1_micro : 0.6460848267261798, f1_macro : 0.4732910222732104, tumor_f1 : 0.7474345622154382, stroma_f1 : 0.5708436699440846, infla_f1 : 0.48770181834697723, necr_f1 : 0.8584479322800269, other_f1 : 0.46035853133966714, acc_micro : 0.8584479322800269
[01:35:49.346] train iteration 1099 : loss : 0.806065, loss_ce: 1.088653
[01:36:09.161] train iteration 1149 : loss : 0.794644, loss_ce: 1.008923
[01:36:29.375] train iteration 1199 : loss : 0.728476, loss_ce: 0.949629
[01:36:44.038] val epoch 9 : f1_micro : 0.6980406045913696, f1_macro : 0.5384511810082656, tumor_f1 : 0.7618973495868536, stroma_f1 : 0.6538934409618378, infla_f1 : 0.48050186381890225, necr_f1 : 0.8792236584883469, other_f1 : 0.4422889641629389, acc_micro : 0.8792236584883469
[01:36:45.470] train iteration 1221 : loss : 0.719924, loss_ce: 0.794893
[01:37:05.356] train iteration 1271 : loss : 0.723304, loss_ce: 0.821374
[01:37:25.504] train iteration 1321 : loss : 0.703225, loss_ce: 0.940943
[01:37:40.189] val epoch 10 : f1_micro : 0.697703113922706, f1_macro : 0.5266076286251729, tumor_f1 : 0.7563121169805527, stroma_f1 : 0.6627207601872774, infla_f1 : 0.4903848125384404, necr_f1 : 0.8790907997351426, other_f1 : 0.45430424114545953, acc_micro : 0.8790907997351426
[01:37:41.680] train iteration 1343 : loss : 0.771885, loss_ce: 1.008503
[01:38:01.505] train iteration 1393 : loss : 0.901017, loss_ce: 1.164477
[01:38:21.720] train iteration 1443 : loss : 0.776438, loss_ce: 0.998345
[01:38:36.494] val epoch 11 : f1_micro : 0.6705340112631137, f1_macro : 0.45124123188165516, tumor_f1 : 0.7284727417505704, stroma_f1 : 0.6639225263005266, infla_f1 : 0.2610447896071352, necr_f1 : 0.8682241118871249, other_f1 : 0.460090995963233, acc_micro : 0.8682241118871249
[01:38:37.951] train iteration 1465 : loss : 0.764993, loss_ce: 1.021875
[01:38:57.766] train iteration 1515 : loss : 0.733093, loss_ce: 0.939440
[01:39:17.961] train iteration 1565 : loss : 0.904623, loss_ce: 1.311230
[01:39:32.684] val epoch 12 : f1_micro : 0.6704596269589204, f1_macro : 0.4608411341905594, tumor_f1 : 0.7459032604327569, stroma_f1 : 0.624531862540887, infla_f1 : 0.3803106573625253, necr_f1 : 0.8681920377107767, other_f1 : 0.41918332638362277, acc_micro : 0.8681920377107767
[01:39:34.253] train iteration 1587 : loss : 0.661976, loss_ce: 0.824367
[01:39:53.998] train iteration 1637 : loss : 0.779375, loss_ce: 1.083997
[01:40:14.223] train iteration 1687 : loss : 0.781335, loss_ce: 1.034951
[01:40:28.858] val epoch 13 : f1_micro : 0.6930908801463934, f1_macro : 0.4866112017860779, tumor_f1 : 0.7754959624547225, stroma_f1 : 0.6388157504776385, infla_f1 : 0.5078456952021673, necr_f1 : 0.8772607033069317, other_f1 : 0.4169957873841318, acc_micro : 0.8772607033069317
[01:40:30.458] train iteration 1709 : loss : 0.708860, loss_ce: 0.966379
[01:40:50.264] train iteration 1759 : loss : 0.772083, loss_ce: 0.968008
[01:41:10.555] train iteration 1809 : loss : 0.896293, loss_ce: 1.274065
[01:41:25.378] val epoch 14 : f1_micro : 0.7134886853970014, f1_macro : 0.5197002257292087, tumor_f1 : 0.7726357854329623, stroma_f1 : 0.6728816228703811, infla_f1 : 0.49471832453631437, necr_f1 : 0.8854040182553805, other_f1 : 0.4261827524572324, acc_micro : 0.8854040182553805
[01:41:26.855] train iteration 1831 : loss : 0.727380, loss_ce: 0.963172
[01:41:46.673] train iteration 1881 : loss : 0.667186, loss_ce: 0.801155
[01:42:06.941] train iteration 1931 : loss : 0.675641, loss_ce: 0.824035
[01:42:21.716] val epoch 15 : f1_micro : 0.7155891416164545, f1_macro : 0.5288096545980527, tumor_f1 : 0.7748770713806152, stroma_f1 : 0.6733776837802277, infla_f1 : 0.526373263161916, necr_f1 : 0.8862500282434317, other_f1 : 0.4340033359968892, acc_micro : 0.8862500282434317
[01:42:23.158] train iteration 1953 : loss : 0.725200, loss_ce: 1.007970
[01:42:42.987] train iteration 2003 : loss : 0.704351, loss_ce: 0.892305
[01:43:03.294] train iteration 2053 : loss : 0.653375, loss_ce: 0.811586
[01:43:18.044] val epoch 16 : f1_micro : 0.6901388661219523, f1_macro : 0.5225713230096377, tumor_f1 : 0.7245164135327706, stroma_f1 : 0.6627973128969853, infla_f1 : 0.5401473089945145, necr_f1 : 0.8760874156768506, other_f1 : 0.46804176713339984, acc_micro : 0.8760874156768506
[01:43:19.546] train iteration 2075 : loss : 0.643065, loss_ce: 0.790273
[01:43:39.292] train iteration 2125 : loss : 0.790273, loss_ce: 1.126363
[01:43:59.577] train iteration 2175 : loss : 0.820423, loss_ce: 1.183436
[01:44:14.441] val epoch 17 : f1_micro : 0.70236242046723, f1_macro : 0.5296562445851473, tumor_f1 : 0.7679024178248185, stroma_f1 : 0.6435904640776033, infla_f1 : 0.5312582996602242, necr_f1 : 0.8809593572066381, other_f1 : 0.4236052473111508, acc_micro : 0.8809593572066381
[01:44:15.948] train iteration 2197 : loss : 0.773195, loss_ce: 0.921840
[01:44:35.746] train iteration 2247 : loss : 0.849425, loss_ce: 1.231954
[01:44:55.919] train iteration 2297 : loss : 0.558781, loss_ce: 0.841149
[01:45:10.593] val epoch 18 : f1_micro : 0.6752064262445157, f1_macro : 0.5088047270591443, tumor_f1 : 0.6731783994115316, stroma_f1 : 0.6563635583107288, infla_f1 : 0.5081099604184811, necr_f1 : 0.8700949503825262, other_f1 : 0.4645727257906961, acc_micro : 0.8700949503825262
[01:45:12.153] train iteration 2319 : loss : 0.635915, loss_ce: 0.804651
[01:45:31.960] train iteration 2369 : loss : 0.721640, loss_ce: 1.048634
[01:45:52.288] train iteration 2419 : loss : 0.739311, loss_ce: 1.050959
[01:46:07.142] val epoch 19 : f1_micro : 0.6997834558670337, f1_macro : 0.5026340776911149, tumor_f1 : 0.7677922180065742, stroma_f1 : 0.6426097569414057, infla_f1 : 0.5200217884893601, necr_f1 : 0.879934563086583, other_f1 : 0.419553296515145, acc_micro : 0.879934563086583
[01:46:08.685] train iteration 2441 : loss : 0.681240, loss_ce: 0.933856
[01:46:28.567] train iteration 2491 : loss : 0.828702, loss_ce: 1.200657
[01:46:48.716] train iteration 2541 : loss : 0.676137, loss_ce: 0.858363
[01:47:03.280] val epoch 20 : f1_micro : 0.6865439529602344, f1_macro : 0.49966558527487975, tumor_f1 : 0.745530231640889, stroma_f1 : 0.6388335468677374, infla_f1 : 0.5388053976572477, necr_f1 : 0.8746354648700128, other_f1 : 0.4223643635184719, acc_micro : 0.8746354648700128
[01:47:04.779] train iteration 2563 : loss : 0.815511, loss_ce: 1.231753
[01:47:24.694] train iteration 2613 : loss : 0.656394, loss_ce: 0.845244
[01:47:44.833] train iteration 2663 : loss : 0.776731, loss_ce: 0.937620
[01:47:59.756] val epoch 21 : f1_micro : 0.7076486463730152, f1_macro : 0.5102517157793045, tumor_f1 : 0.7762097716331482, stroma_f1 : 0.6654797721186276, infla_f1 : 0.4702652841806412, necr_f1 : 0.8830722478719858, other_f1 : 0.47355719608290553, acc_micro : 0.8830722478719858
[01:48:01.263] train iteration 2685 : loss : 0.594845, loss_ce: 0.940356
[01:48:21.131] train iteration 2735 : loss : 0.690136, loss_ce: 0.907538
[01:48:41.307] train iteration 2785 : loss : 0.619436, loss_ce: 0.731740
[01:48:55.978] val epoch 22 : f1_micro : 0.6999312260976205, f1_macro : 0.546744764997409, tumor_f1 : 0.7545918065768021, stroma_f1 : 0.6475014150715791, infla_f1 : 0.5362563449173019, necr_f1 : 0.8799890050521264, other_f1 : 0.4571904197621804, acc_micro : 0.8799890050521264
[01:48:57.499] train iteration 2807 : loss : 0.656500, loss_ce: 0.751211
[01:49:17.274] train iteration 2857 : loss : 0.673159, loss_ce: 0.954545
[01:49:37.542] train iteration 2907 : loss : 0.641243, loss_ce: 0.824480
[01:49:52.439] val epoch 23 : f1_micro : 0.6820197758766321, f1_macro : 0.5237001983019022, tumor_f1 : 0.6844664118610896, stroma_f1 : 0.6549195584196311, infla_f1 : 0.5316241085529327, necr_f1 : 0.8728273556782649, other_f1 : 0.46903068869589615, acc_micro : 0.8728273556782649
[01:49:53.894] train iteration 2929 : loss : 0.511548, loss_ce: 0.699575
[01:50:13.714] train iteration 2979 : loss : 0.721479, loss_ce: 0.962833
[01:50:33.854] train iteration 3029 : loss : 0.690514, loss_ce: 0.952397
[01:50:48.661] val epoch 24 : f1_micro : 0.7041919942085559, f1_macro : 0.4962221418435757, tumor_f1 : 0.7751801885091342, stroma_f1 : 0.656822396012453, infla_f1 : 0.4792720354520358, necr_f1 : 0.8816927831906539, other_f1 : 0.42430513332454634, acc_micro : 0.8816927831906539
[01:50:50.150] train iteration 3051 : loss : 0.705767, loss_ce: 0.862440
[01:51:09.896] train iteration 3101 : loss : 0.622997, loss_ce: 0.885810
[01:51:30.103] train iteration 3151 : loss : 0.537998, loss_ce: 0.699580
[01:51:45.113] val epoch 25 : f1_micro : 0.6980823221114966, f1_macro : 0.48545092000411105, tumor_f1 : 0.7792213570613128, stroma_f1 : 0.6360502773179457, infla_f1 : 0.46231955461777174, necr_f1 : 0.8792560490278097, other_f1 : 0.39148959445838744, acc_micro : 0.8792560490278097
[01:51:46.512] train iteration 3173 : loss : 0.639315, loss_ce: 0.872699
[01:52:06.353] train iteration 3223 : loss : 0.774494, loss_ce: 1.124138
[01:52:26.494] train iteration 3273 : loss : 0.640414, loss_ce: 0.797911
[01:52:41.201] val epoch 26 : f1_micro : 0.6856447767752868, f1_macro : 0.5159368853156383, tumor_f1 : 0.7240153757425455, stroma_f1 : 0.6525695788172575, infla_f1 : 0.45051983700921905, necr_f1 : 0.8742751433299139, other_f1 : 0.41409883220106936, acc_micro : 0.8742751433299139
[01:52:42.541] train iteration 3295 : loss : 0.396422, loss_ce: 0.576384
[01:53:02.347] train iteration 3345 : loss : 0.666634, loss_ce: 0.739446
[01:53:22.550] train iteration 3395 : loss : 0.674749, loss_ce: 0.797491
[01:53:37.153] val epoch 27 : f1_micro : 0.7077295161210574, f1_macro : 0.5293708334748561, tumor_f1 : 0.7706612474643267, stroma_f1 : 0.6574891736874213, infla_f1 : 0.549083446080868, necr_f1 : 0.8831053995169126, other_f1 : 0.42982853695642775, acc_micro : 0.8831053995169126
[01:53:38.671] train iteration 3417 : loss : 0.636936, loss_ce: 0.818008
[01:53:58.567] train iteration 3467 : loss : 0.656249, loss_ce: 0.742295
[01:54:18.715] train iteration 3517 : loss : 0.686983, loss_ce: 0.952660
[01:54:33.375] val epoch 28 : f1_micro : 0.6769279253024322, f1_macro : 0.4962180807040288, tumor_f1 : 0.6895976015008413, stroma_f1 : 0.6410296169611124, infla_f1 : 0.517195727962714, necr_f1 : 0.8707865545382867, other_f1 : 0.42452289815992117, acc_micro : 0.8707865545382867
[01:54:34.821] train iteration 3539 : loss : 0.612186, loss_ce: 0.911887
[01:54:54.696] train iteration 3589 : loss : 0.672580, loss_ce: 0.940471
[01:55:14.840] train iteration 3639 : loss : 0.553758, loss_ce: 0.725872
[01:55:29.647] val epoch 29 : f1_micro : 0.700794096176441, f1_macro : 0.5069621084974363, tumor_f1 : 0.7446330418953528, stroma_f1 : 0.6734766856982157, infla_f1 : 0.46154925141196984, necr_f1 : 0.880333987566141, other_f1 : 0.42648378177545965, acc_micro : 0.880333987566141
[01:55:31.070] train iteration 3661 : loss : 0.650209, loss_ce: 0.898318
[01:55:50.924] train iteration 3711 : loss : 0.628916, loss_ce: 0.904407
[01:56:11.103] train iteration 3761 : loss : 0.680908, loss_ce: 0.786884
[01:56:25.852] val epoch 30 : f1_micro : 0.7163754243117112, f1_macro : 0.5409844901699287, tumor_f1 : 0.7820256467048938, stroma_f1 : 0.6673045461066067, infla_f1 : 0.5552319741019835, necr_f1 : 0.8865649814789112, other_f1 : 0.39650923013687134, acc_micro : 0.8865649814789112
[01:56:27.357] train iteration 3783 : loss : 0.684742, loss_ce: 0.933437
[01:56:47.214] train iteration 3833 : loss : 0.772655, loss_ce: 1.030727
[01:57:07.306] train iteration 3883 : loss : 0.597789, loss_ce: 0.823209
[01:57:22.111] val epoch 31 : f1_micro : 0.6959273402507489, f1_macro : 0.5322488305660394, tumor_f1 : 0.7642238782002375, stroma_f1 : 0.6169283991822829, infla_f1 : 0.5305221264178936, necr_f1 : 0.8783858785262475, other_f1 : 0.41679447339489484, acc_micro : 0.8783858785262475
[01:57:23.603] train iteration 3905 : loss : 0.838882, loss_ce: 1.173707
[01:57:43.406] train iteration 3955 : loss : 0.783261, loss_ce: 1.046364
[01:58:03.606] train iteration 4005 : loss : 0.690771, loss_ce: 0.974285
[01:58:18.252] val epoch 32 : f1_micro : 0.6960177444494687, f1_macro : 0.4991397662804677, tumor_f1 : 0.7675396112295297, stroma_f1 : 0.6452847560151265, infla_f1 : 0.49324782536580014, necr_f1 : 0.8784241928504064, other_f1 : 0.41882729360189, acc_micro : 0.8784241928504064
[01:58:19.705] train iteration 4027 : loss : 0.651281, loss_ce: 0.889449
[01:58:39.526] train iteration 4077 : loss : 0.573671, loss_ce: 0.736169
[01:58:59.727] train iteration 4127 : loss : 0.714044, loss_ce: 1.013984
[01:59:14.643] val epoch 33 : f1_micro : 0.6984149641715564, f1_macro : 0.5319965344208938, tumor_f1 : 0.7478011903854517, stroma_f1 : 0.6514907301618502, infla_f1 : 0.5463079386032544, necr_f1 : 0.8793812187818381, other_f1 : 0.4387347939280936, acc_micro : 0.8793812187818381
[01:59:16.126] train iteration 4149 : loss : 0.490689, loss_ce: 0.588836
[01:59:35.968] train iteration 4199 : loss : 0.595181, loss_ce: 0.837426
[01:59:56.216] train iteration 4249 : loss : 0.615418, loss_ce: 0.803667
[02:00:10.689] val epoch 34 : f1_micro : 0.678716303064273, f1_macro : 0.5117154327722696, tumor_f1 : 0.7672240745562774, stroma_f1 : 0.5781641820302377, infla_f1 : 0.5547739049563041, necr_f1 : 0.8715042792833768, other_f1 : 0.40319508937402415, acc_micro : 0.8715042792833768
[02:00:12.065] train iteration 4271 : loss : 0.650998, loss_ce: 1.014835
[02:00:31.886] train iteration 4321 : loss : 0.748190, loss_ce: 1.013308
[02:00:52.147] train iteration 4371 : loss : 0.897206, loss_ce: 1.319340
[02:01:06.937] val epoch 35 : f1_micro : 0.7079040041336646, f1_macro : 0.5311835740621274, tumor_f1 : 0.7565196167964202, stroma_f1 : 0.6547130724558463, infla_f1 : 0.5707906753971026, necr_f1 : 0.8831794605805323, other_f1 : 0.43154079649740684, acc_micro : 0.8831794605805323
[02:01:08.428] train iteration 4393 : loss : 0.643163, loss_ce: 0.798310
[02:01:28.230] train iteration 4443 : loss : 0.676762, loss_ce: 0.897601
[02:01:48.488] train iteration 4493 : loss : 0.929442, loss_ce: 1.385767
[02:02:03.243] val epoch 36 : f1_micro : 0.6886981335970072, f1_macro : 0.48730620397971225, tumor_f1 : 0.7646358357026026, stroma_f1 : 0.6322309168485495, infla_f1 : 0.43377587399803674, necr_f1 : 0.8754972265316889, other_f1 : 0.4124097315630374, acc_micro : 0.8754972265316889
[02:02:04.708] train iteration 4515 : loss : 0.681290, loss_ce: 0.952731
[02:02:24.568] train iteration 4565 : loss : 0.608775, loss_ce: 0.887475
[02:02:44.835] train iteration 4615 : loss : 0.540345, loss_ce: 0.714500
[02:02:59.574] val epoch 37 : f1_micro : 0.6849527966517669, f1_macro : 0.552243651678929, tumor_f1 : 0.7330209097036948, stroma_f1 : 0.6448855097763814, infla_f1 : 0.5324024594603822, necr_f1 : 0.8739974727997413, other_f1 : 0.4327912193078261, acc_micro : 0.8739974727997413
[02:03:01.036] train iteration 4637 : loss : 0.864031, loss_ce: 1.165083
[02:03:20.914] train iteration 4687 : loss : 0.785049, loss_ce: 1.065214
[02:03:41.201] train iteration 4737 : loss : 0.645614, loss_ce: 0.885204
[02:03:55.981] val epoch 38 : f1_micro : 0.6840401521095862, f1_macro : 0.5503675828759487, tumor_f1 : 0.7517469147076974, stroma_f1 : 0.6169952990917059, infla_f1 : 0.4933702941589917, necr_f1 : 0.8736278873223525, other_f1 : 0.43068672344088554, acc_micro : 0.8736278873223525
[02:03:57.507] train iteration 4759 : loss : 0.875584, loss_ce: 1.279341
[02:04:17.250] train iteration 4809 : loss : 0.667364, loss_ce: 0.907695
[02:04:37.681] train iteration 4859 : loss : 0.508757, loss_ce: 0.736275
[02:04:52.190] val epoch 39 : f1_micro : 0.7173882573843002, f1_macro : 0.5336331633421091, tumor_f1 : 0.789536748941128, stroma_f1 : 0.6462779440290223, infla_f1 : 0.5329945437037028, necr_f1 : 0.8869701073719904, other_f1 : 0.434835644152302, acc_micro : 0.8869701073719904
[02:04:53.716] train iteration 4881 : loss : 0.605896, loss_ce: 0.875752
[02:05:13.669] train iteration 4931 : loss : 0.575998, loss_ce: 0.662241
[02:05:33.787] train iteration 4981 : loss : 0.885656, loss_ce: 1.261416
[02:05:48.561] val epoch 40 : f1_micro : 0.6912687959579321, f1_macro : 0.51134409984717, tumor_f1 : 0.7526226083819683, stroma_f1 : 0.6359149120174922, infla_f1 : 0.5523393303155899, necr_f1 : 0.8765261081548837, other_f1 : 0.4269359617923888, acc_micro : 0.8765261081548837
[02:05:49.994] train iteration 5003 : loss : 0.478166, loss_ce: 0.682515
[02:06:09.786] train iteration 5053 : loss : 0.689959, loss_ce: 0.868187
[02:06:29.932] train iteration 5103 : loss : 0.634719, loss_ce: 0.857139
[02:06:44.981] val epoch 41 : f1_micro : 0.7202239357508146, f1_macro : 0.5322522601256003, tumor_f1 : 0.7915929739291852, stroma_f1 : 0.6541735390245986, infla_f1 : 0.564282588660717, necr_f1 : 0.8881049247888418, other_f1 : 0.43111213331128684, acc_micro : 0.8881049247888418
[02:06:46.388] train iteration 5125 : loss : 0.554281, loss_ce: 0.554987
[02:07:06.165] train iteration 5175 : loss : 0.716367, loss_ce: 1.067451
[02:07:26.427] train iteration 5225 : loss : 0.823795, loss_ce: 1.228200
[02:07:41.268] val epoch 42 : f1_micro : 0.6803646385669708, f1_macro : 0.49991611448618084, tumor_f1 : 0.778710201382637, stroma_f1 : 0.5927743254086146, infla_f1 : 0.5577736307795231, necr_f1 : 0.8721718031626481, other_f1 : 0.3813903070180319, acc_micro : 0.8721718031626481
[02:07:42.777] train iteration 5247 : loss : 0.773911, loss_ce: 1.096656
[02:08:02.650] train iteration 5297 : loss : 0.547146, loss_ce: 0.745646
[02:08:22.907] train iteration 5347 : loss : 0.542636, loss_ce: 0.790333
[02:08:37.579] val epoch 43 : f1_micro : 0.7209779241910348, f1_macro : 0.5250572757079051, tumor_f1 : 0.7929512365506246, stroma_f1 : 0.661748926800031, infla_f1 : 0.5532535692820182, necr_f1 : 0.8884043257970077, other_f1 : 0.4384984931586167, acc_micro : 0.8884043257970077
[02:08:39.036] train iteration 5369 : loss : 0.782605, loss_ce: 1.022754
[02:08:58.796] train iteration 5419 : loss : 0.663684, loss_ce: 0.752902
[02:09:19.071] train iteration 5469 : loss : 0.452214, loss_ce: 0.685208
[02:09:34.012] val epoch 44 : f1_micro : 0.7312345986182873, f1_macro : 0.5710571958468511, tumor_f1 : 0.7961123024041836, stroma_f1 : 0.6846319855405734, infla_f1 : 0.5470607309387281, necr_f1 : 0.8925024133462173, other_f1 : 0.4139336668528043, acc_micro : 0.8925024133462173
[02:09:35.461] train iteration 5491 : loss : 0.924179, loss_ce: 1.448209
[02:09:55.230] train iteration 5541 : loss : 0.602952, loss_ce: 0.934890
[02:10:15.547] train iteration 5591 : loss : 0.610330, loss_ce: 0.800943
[02:10:30.268] val epoch 45 : f1_micro : 0.6796325387863013, f1_macro : 0.5015948254328507, tumor_f1 : 0.7217389895365789, stroma_f1 : 0.6425443592552955, infla_f1 : 0.5428660523432952, necr_f1 : 0.8718741352741535, other_f1 : 0.4319324456871702, acc_micro : 0.8718741352741535
[02:10:31.708] train iteration 5613 : loss : 0.638487, loss_ce: 0.819964
[02:10:51.475] train iteration 5663 : loss : 0.642560, loss_ce: 0.854424
[02:11:11.731] train iteration 5713 : loss : 0.681381, loss_ce: 0.832332
[02:11:26.635] val epoch 46 : f1_micro : 0.712729003566962, f1_macro : 0.5354525515666375, tumor_f1 : 0.7744659231259272, stroma_f1 : 0.6688647264471421, infla_f1 : 0.45874190144240856, necr_f1 : 0.8851057520279517, other_f1 : 0.43054529591105306, acc_micro : 0.8851057520279517
[02:11:28.109] train iteration 5735 : loss : 0.470015, loss_ce: 0.548355
[02:11:47.903] train iteration 5785 : loss : 0.475100, loss_ce: 0.588641
[02:12:08.143] train iteration 5835 : loss : 0.594713, loss_ce: 0.761454
[02:12:22.920] val epoch 47 : f1_micro : 0.7219801419056379, f1_macro : 0.5669083927686398, tumor_f1 : 0.7931934950443414, stroma_f1 : 0.6687366162928251, infla_f1 : 0.5328903224032658, necr_f1 : 0.8888099354047042, other_f1 : 0.4792881224017877, acc_micro : 0.8888099354047042
[02:12:24.420] train iteration 5857 : loss : 0.744821, loss_ce: 0.995776
[02:12:44.348] train iteration 5907 : loss : 0.443507, loss_ce: 0.554581
[02:13:04.531] train iteration 5957 : loss : 0.597006, loss_ce: 0.758264
[02:13:19.188] val epoch 48 : f1_micro : 0.7026751511372052, f1_macro : 0.5178000250687966, tumor_f1 : 0.7856677999863257, stroma_f1 : 0.6283135809577428, infla_f1 : 0.5399041741934175, necr_f1 : 0.8810921196754162, other_f1 : 0.4022489484363737, acc_micro : 0.8810921196754162
[02:13:20.681] train iteration 5979 : loss : 0.719963, loss_ce: 0.946005
[02:13:40.565] train iteration 6029 : loss : 0.708426, loss_ce: 0.966128
[02:14:00.705] train iteration 6079 : loss : 0.585876, loss_ce: 0.629653
[02:14:15.372] val epoch 49 : f1_micro : 0.7091553887495627, f1_macro : 0.5402720318390772, tumor_f1 : 0.775547458575322, stroma_f1 : 0.6445598741276906, infla_f1 : 0.5691518966968243, necr_f1 : 0.8836762377848992, other_f1 : 0.4341636338302543, acc_micro : 0.8836762377848992
[02:14:16.844] train iteration 6101 : loss : 0.598609, loss_ce: 0.770362
[02:14:36.707] train iteration 6151 : loss : 0.595238, loss_ce: 0.894004
[02:14:57.024] train iteration 6201 : loss : 0.480942, loss_ce: 0.666821
[02:15:11.564] val epoch 50 : f1_micro : 0.7177633253427652, f1_macro : 0.5440760535689501, tumor_f1 : 0.7898552371905401, stroma_f1 : 0.6569826749081795, infla_f1 : 0.5495005889007678, necr_f1 : 0.8871194261770982, other_f1 : 0.4324428532988979, acc_micro : 0.8871194261770982
[02:15:13.068] train iteration 6223 : loss : 0.302807, loss_ce: 0.449137
[02:15:33.075] train iteration 6273 : loss : 0.625270, loss_ce: 0.850142
[02:15:53.142] train iteration 6323 : loss : 0.518267, loss_ce: 0.556986
[02:16:07.824] val epoch 51 : f1_micro : 0.690089722092335, f1_macro : 0.5206148188847762, tumor_f1 : 0.7601566945131009, stroma_f1 : 0.6166160270535889, infla_f1 : 0.4905918435408519, necr_f1 : 0.8760522191341107, other_f1 : 0.383669179219466, acc_micro : 0.8760522191341107
[02:16:09.413] train iteration 6345 : loss : 0.776779, loss_ce: 1.052195
[02:16:29.271] train iteration 6395 : loss : 0.822499, loss_ce: 1.182605
[02:16:49.705] train iteration 6445 : loss : 0.573975, loss_ce: 0.733946
[02:17:04.423] val epoch 52 : f1_micro : 0.6955760591305219, f1_macro : 0.5199502282417737, tumor_f1 : 0.7372843144604793, stroma_f1 : 0.6367496699094772, infla_f1 : 0.5576414271042898, necr_f1 : 0.878247116620724, other_f1 : 0.42685002138694894, acc_micro : 0.878247116620724
[02:17:05.825] train iteration 6467 : loss : 0.532811, loss_ce: 0.641282
[02:17:25.767] train iteration 6517 : loss : 0.747883, loss_ce: 1.141095
[02:17:46.006] train iteration 6567 : loss : 0.574830, loss_ce: 0.793547
[02:18:00.649] val epoch 53 : f1_micro : 0.6694240753467267, f1_macro : 0.500243943471175, tumor_f1 : 0.6792726161388251, stroma_f1 : 0.6411966933653905, infla_f1 : 0.580265399462615, necr_f1 : 0.8677958662693317, other_f1 : 0.4333481340167614, acc_micro : 0.8677958662693317
[02:18:02.140] train iteration 6589 : loss : 0.708577, loss_ce: 0.898387
[02:18:22.115] train iteration 6639 : loss : 0.496449, loss_ce: 0.623809
[02:18:42.336] train iteration 6689 : loss : 0.534160, loss_ce: 0.702361
[02:18:57.092] val epoch 54 : f1_micro : 0.6836979979505906, f1_macro : 0.5053820211726886, tumor_f1 : 0.7950514509127691, stroma_f1 : 0.5785203364032966, infla_f1 : 0.5489747730585245, necr_f1 : 0.8734971789213327, other_f1 : 0.43552475852461964, acc_micro : 0.8734971789213327
[02:18:58.594] train iteration 6711 : loss : 0.829275, loss_ce: 1.097632
[02:19:18.513] train iteration 6761 : loss : 0.448627, loss_ce: 0.545397
[02:19:38.661] train iteration 6811 : loss : 0.636709, loss_ce: 0.915609
[02:19:53.643] val epoch 55 : f1_micro : 0.6869027282182987, f1_macro : 0.5145227903356919, tumor_f1 : 0.7683646862323468, stroma_f1 : 0.582732378720091, infla_f1 : 0.5179688070829098, necr_f1 : 0.8747764046375568, other_f1 : 0.3916150301363534, acc_micro : 0.8747764046375568
[02:19:55.177] train iteration 6833 : loss : 0.503145, loss_ce: 0.737872
[02:20:15.044] train iteration 6883 : loss : 0.530842, loss_ce: 0.768787
[02:20:35.194] train iteration 6933 : loss : 0.490346, loss_ce: 0.647136
[02:20:49.950] val epoch 56 : f1_micro : 0.6953513851532569, f1_macro : 0.5115870621341926, tumor_f1 : 0.7281829244815387, stroma_f1 : 0.6615631282329559, infla_f1 : 0.5071132251849542, necr_f1 : 0.8781592341569754, other_f1 : 0.43384798229313815, acc_micro : 0.8781592341569754
[02:20:51.377] train iteration 6955 : loss : 0.530887, loss_ce: 0.759660
[02:21:11.278] train iteration 7005 : loss : 0.601070, loss_ce: 0.758354
[02:21:31.416] train iteration 7055 : loss : 0.810477, loss_ce: 1.102460
[02:21:46.205] val epoch 57 : f1_micro : 0.7212401903592623, f1_macro : 0.5354700426642711, tumor_f1 : 0.7702410014776083, stroma_f1 : 0.6765595473922216, infla_f1 : 0.562562801516973, necr_f1 : 0.8885100323420304, other_f1 : 0.44132617719543094, acc_micro : 0.8885100323420304
[02:21:47.634] train iteration 7077 : loss : 0.592207, loss_ce: 0.816131
[02:22:07.522] train iteration 7127 : loss : 0.730949, loss_ce: 1.085198
[02:22:27.788] train iteration 7177 : loss : 0.649115, loss_ce: 0.896473
[02:22:42.531] val epoch 58 : f1_micro : 0.6826193034648895, f1_macro : 0.5200981652507415, tumor_f1 : 0.7630192729142996, stroma_f1 : 0.5746530564501882, infla_f1 : 0.5267823782677834, necr_f1 : 0.873067184136464, other_f1 : 0.39564834230651075, acc_micro : 0.873067184136464
[02:22:43.943] train iteration 7199 : loss : 0.567156, loss_ce: 0.815934
[02:23:03.860] train iteration 7249 : loss : 0.546013, loss_ce: 0.800106
[02:23:23.940] train iteration 7299 : loss : 0.762985, loss_ce: 1.056224
[02:23:38.856] val epoch 59 : f1_micro : 0.6928480015351222, f1_macro : 0.5212482993419354, tumor_f1 : 0.7753484891011164, stroma_f1 : 0.6236927377848098, infla_f1 : 0.5029649130570201, necr_f1 : 0.8771624060777518, other_f1 : 0.4192397732538386, acc_micro : 0.8771624060777518
[02:23:40.328] train iteration 7321 : loss : 0.589280, loss_ce: 0.949847
[02:24:00.107] train iteration 7371 : loss : 0.504274, loss_ce: 0.653539
[02:24:20.388] train iteration 7421 : loss : 0.620027, loss_ce: 0.822272
[02:24:35.372] val epoch 60 : f1_micro : 0.7143620069210346, f1_macro : 0.5373384883770576, tumor_f1 : 0.7923223720147059, stroma_f1 : 0.6372616654306722, infla_f1 : 0.5329870467718977, necr_f1 : 0.885760309604498, other_f1 : 0.4371061675528136, acc_micro : 0.885760309604498
[02:24:36.759] train iteration 7443 : loss : 0.635200, loss_ce: 0.825142
[02:24:56.506] train iteration 7493 : loss : 0.444211, loss_ce: 0.504442
[02:25:16.802] train iteration 7543 : loss : 0.731803, loss_ce: 1.016353
[02:25:31.796] val epoch 61 : f1_micro : 0.7082461840831317, f1_macro : 0.5226367030006188, tumor_f1 : 0.7934959656917132, stroma_f1 : 0.6384721035854175, infla_f1 : 0.5615912604217346, necr_f1 : 0.8833163793270404, other_f1 : 0.4057129802039036, acc_micro : 0.8833163793270404
[02:25:33.296] train iteration 7565 : loss : 0.511474, loss_ce: 0.582585
[02:25:53.037] train iteration 7615 : loss : 0.680850, loss_ce: 0.945759
[02:26:13.327] train iteration 7665 : loss : 0.568929, loss_ce: 0.697152
[02:26:28.158] val epoch 62 : f1_micro : 0.7098471155533423, f1_macro : 0.5318682188024888, tumor_f1 : 0.7893937046711261, stroma_f1 : 0.6291299949471767, infla_f1 : 0.5315991476751291, necr_f1 : 0.8839576519452609, other_f1 : 0.42918185733903486, acc_micro : 0.8839576519452609
[02:26:29.636] train iteration 7687 : loss : 0.722311, loss_ce: 0.909943
[02:26:49.415] train iteration 7737 : loss : 0.460452, loss_ce: 0.662370
[02:27:09.654] train iteration 7787 : loss : 0.716242, loss_ce: 1.080266
[02:27:24.612] val epoch 63 : f1_micro : 0.7025009852189285, f1_macro : 0.534584044263913, tumor_f1 : 0.745968775680432, stroma_f1 : 0.6685531792732385, infla_f1 : 0.5322248184910188, necr_f1 : 0.8810166074679449, other_f1 : 0.3951484845378078, acc_micro : 0.8810166074679449
[02:27:26.132] train iteration 7809 : loss : 0.617986, loss_ce: 0.760951
[02:27:45.897] train iteration 7859 : loss : 0.712952, loss_ce: 0.923866
[02:28:05.990] train iteration 7909 : loss : 0.515641, loss_ce: 0.709881
[02:28:20.818] val epoch 64 : f1_micro : 0.6760822098988754, f1_macro : 0.4994502296814552, tumor_f1 : 0.7513053692304171, stroma_f1 : 0.6208997208338517, infla_f1 : 0.4371571963509688, necr_f1 : 0.8704525759586921, other_f1 : 0.41448447212147027, acc_micro : 0.8704525759586921
[02:28:22.273] train iteration 7931 : loss : 0.681365, loss_ce: 0.909647
[02:28:42.200] train iteration 7981 : loss : 0.536018, loss_ce: 0.682124
[02:29:02.328] train iteration 8031 : loss : 0.593284, loss_ce: 0.733539
[02:29:17.165] val epoch 65 : f1_micro : 0.6995946650321667, f1_macro : 0.540829500899865, tumor_f1 : 0.7768734945700719, stroma_f1 : 0.5987096652388573, infla_f1 : 0.5739075856713148, necr_f1 : 0.8798513160302088, other_f1 : 0.4341136225355932, acc_micro : 0.8798513160302088
[02:29:18.573] train iteration 8053 : loss : 0.484750, loss_ce: 0.574441
[02:29:38.364] train iteration 8103 : loss : 0.720749, loss_ce: 0.960042
[02:29:58.628] train iteration 8153 : loss : 0.620453, loss_ce: 0.833857
[02:30:13.373] val epoch 66 : f1_micro : 0.7093225694619693, f1_macro : 0.5328552602575376, tumor_f1 : 0.7579496136078467, stroma_f1 : 0.6667309019428033, infla_f1 : 0.5528020010544703, necr_f1 : 0.8837445882650522, other_f1 : 0.4415208774869545, acc_micro : 0.8837445882650522
[02:30:14.834] train iteration 8175 : loss : 0.670413, loss_ce: 0.970408
[02:30:34.664] train iteration 8225 : loss : 0.476877, loss_ce: 0.591973
[02:30:54.990] train iteration 8275 : loss : 0.600361, loss_ce: 0.782009
[02:31:09.692] val epoch 67 : f1_micro : 0.7112919390201569, f1_macro : 0.5277007119013712, tumor_f1 : 0.769714606496004, stroma_f1 : 0.656561499604812, infla_f1 : 0.5422255720656651, necr_f1 : 0.8845330866483542, other_f1 : 0.40180966014836134, acc_micro : 0.8845330866483542
[02:31:11.256] train iteration 8297 : loss : 0.503160, loss_ce: 0.680397
[02:31:31.094] train iteration 8347 : loss : 0.549914, loss_ce: 0.736991
[02:31:51.243] train iteration 8397 : loss : 0.582425, loss_ce: 0.813674
[02:32:05.998] val epoch 68 : f1_micro : 0.7195760963054804, f1_macro : 0.5380057125137403, tumor_f1 : 0.7839458309687101, stroma_f1 : 0.6691123146492128, infla_f1 : 0.48025699934134114, necr_f1 : 0.887841270520137, other_f1 : 0.4406805217373543, acc_micro : 0.887841270520137
[02:32:07.510] train iteration 8419 : loss : 0.660660, loss_ce: 0.957875
[02:32:27.294] train iteration 8469 : loss : 0.694628, loss_ce: 0.908464
[02:32:47.514] train iteration 8519 : loss : 0.738381, loss_ce: 0.921371
[02:33:02.188] val epoch 69 : f1_micro : 0.709522124666434, f1_macro : 0.5702281055542139, tumor_f1 : 0.7913882583379745, stroma_f1 : 0.6238784271364028, infla_f1 : 0.5500780929891894, necr_f1 : 0.8838220032361838, other_f1 : 0.4728498993298182, acc_micro : 0.8838220032361838
[02:33:03.661] train iteration 8541 : loss : 0.454784, loss_ce: 0.559413
[02:33:23.408] train iteration 8591 : loss : 0.534788, loss_ce: 0.706895
[02:33:43.686] train iteration 8641 : loss : 0.852135, loss_ce: 1.189623
[02:33:58.315] val epoch 70 : f1_micro : 0.7267973228142812, f1_macro : 0.5475036989037807, tumor_f1 : 0.7959021834226755, stroma_f1 : 0.6707838355348661, infla_f1 : 0.5392396172078756, necr_f1 : 0.8907331847227536, other_f1 : 0.44982560734766036, acc_micro : 0.8907331847227536
[02:33:59.840] train iteration 8663 : loss : 0.789738, loss_ce: 1.130842
[02:34:19.690] train iteration 8713 : loss : 0.583021, loss_ce: 0.696983
[02:34:39.918] train iteration 8763 : loss : 0.734840, loss_ce: 1.000604
[02:34:54.670] val epoch 71 : f1_micro : 0.6956247973900574, f1_macro : 0.5267725735902786, tumor_f1 : 0.7386333231742566, stroma_f1 : 0.6510037682377375, infla_f1 : 0.5671058434706467, necr_f1 : 0.8782676985630622, other_f1 : 0.4396940109772214, acc_micro : 0.8782676985630622
[02:34:56.192] train iteration 8785 : loss : 0.706738, loss_ce: 0.915210
[02:35:15.991] train iteration 8835 : loss : 0.671574, loss_ce: 0.938183
[02:35:36.159] train iteration 8885 : loss : 0.679972, loss_ce: 1.048500
[02:35:50.834] val epoch 72 : f1_micro : 0.6955872785586578, f1_macro : 0.541322672023223, tumor_f1 : 0.7777197567316202, stroma_f1 : 0.6404496230758153, infla_f1 : 0.5282690565173442, necr_f1 : 0.8782540261745453, other_f1 : 0.41350528506490475, acc_micro : 0.8782540261745453
[02:35:52.316] train iteration 8907 : loss : 0.576346, loss_ce: 0.727556
[02:36:12.222] train iteration 8957 : loss : 0.522282, loss_ce: 0.760725
[02:36:32.269] train iteration 9007 : loss : 0.650174, loss_ce: 0.891958
[02:36:46.989] val epoch 73 : f1_micro : 0.7046944132217994, f1_macro : 0.5457895329365363, tumor_f1 : 0.7951959532040817, stroma_f1 : 0.6120193434449342, infla_f1 : 0.5521484618433393, necr_f1 : 0.8818976328923152, other_f1 : 0.4360178465610191, acc_micro : 0.8818976328923152
[02:36:48.420] train iteration 9029 : loss : 0.693551, loss_ce: 0.999620
[02:37:08.253] train iteration 9079 : loss : 0.429867, loss_ce: 0.584653
[02:37:28.393] train iteration 9129 : loss : 0.591167, loss_ce: 0.841017
[02:37:43.228] val epoch 74 : f1_micro : 0.6855611422887216, f1_macro : 0.5284145537477273, tumor_f1 : 0.7753698287101892, stroma_f1 : 0.574845322730163, infla_f1 : 0.5537038140285474, necr_f1 : 0.874243112710806, other_f1 : 0.3888463228000686, acc_micro : 0.874243112710806
[02:37:44.675] train iteration 9151 : loss : 0.641810, loss_ce: 0.914402
[02:38:04.454] train iteration 9201 : loss : 0.535625, loss_ce: 0.757674
[02:38:24.674] train iteration 9251 : loss : 0.744371, loss_ce: 1.086857
[02:38:39.354] val epoch 75 : f1_micro : 0.7065751747443125, f1_macro : 0.5398862298864585, tumor_f1 : 0.7962528742276705, stroma_f1 : 0.6211918936325953, infla_f1 : 0.5309981987453424, necr_f1 : 0.8826473034345187, other_f1 : 0.46399705632939003, acc_micro : 0.8826473034345187
[02:38:40.838] train iteration 9273 : loss : 0.602243, loss_ce: 0.734060
[02:39:00.701] train iteration 9323 : loss : 0.480704, loss_ce: 0.656830
[02:39:20.830] train iteration 9373 : loss : 0.797782, loss_ce: 1.083453
[02:39:35.850] val epoch 76 : f1_micro : 0.6967265995649191, f1_macro : 0.5243292554066732, tumor_f1 : 0.76658962896237, stroma_f1 : 0.6390271056443453, infla_f1 : 0.5095349286253062, necr_f1 : 0.8787067876412318, other_f1 : 0.4402123692517097, acc_micro : 0.8787067876412318
[02:39:37.262] train iteration 9395 : loss : 0.512454, loss_ce: 0.701357
[02:39:57.008] train iteration 9445 : loss : 0.744144, loss_ce: 1.036480
[02:40:17.132] train iteration 9495 : loss : 0.567971, loss_ce: 0.663277
[02:40:31.826] val epoch 77 : f1_micro : 0.7265277161048009, f1_macro : 0.5801178308633658, tumor_f1 : 0.7960538325401453, stroma_f1 : 0.6678420798136637, infla_f1 : 0.5569059172501931, necr_f1 : 0.890621698819674, other_f1 : 0.4691656375876986, acc_micro : 0.890621698819674
[02:40:33.410] train iteration 9517 : loss : 0.703479, loss_ce: 0.958213
[02:40:53.195] train iteration 9567 : loss : 0.485359, loss_ce: 0.514764
[02:41:13.516] train iteration 9617 : loss : 0.520215, loss_ce: 0.577074
[02:41:28.605] val epoch 78 : f1_micro : 0.7196000115229533, f1_macro : 0.5411376706682719, tumor_f1 : 0.809399086695451, stroma_f1 : 0.6411589103249403, infla_f1 : 0.5661225244402885, necr_f1 : 0.8878576274101551, other_f1 : 0.43361475460159665, acc_micro : 0.8878576274101551
[02:41:30.061] train iteration 9639 : loss : 0.483261, loss_ce: 0.669370
[02:41:49.812] train iteration 9689 : loss : 0.597643, loss_ce: 0.626439
[02:42:10.163] train iteration 9739 : loss : 0.644093, loss_ce: 0.749397
[02:42:25.088] val epoch 79 : f1_micro : 0.6917176957313831, f1_macro : 0.5283409786912111, tumor_f1 : 0.7911213361299955, stroma_f1 : 0.5916979473370773, infla_f1 : 0.5503073051804677, necr_f1 : 0.8767044383745927, other_f1 : 0.39445181890802744, acc_micro : 0.8767044383745927
[02:42:26.572] train iteration 9761 : loss : 0.747652, loss_ce: 1.074586
[02:42:46.464] train iteration 9811 : loss : 0.514431, loss_ce: 0.664780
[02:43:06.534] train iteration 9861 : loss : 0.454477, loss_ce: 0.531006
[02:43:21.149] val epoch 80 : f1_micro : 0.7041348551328366, f1_macro : 0.5539450161159039, tumor_f1 : 0.7812041468345202, stroma_f1 : 0.6254176612083728, infla_f1 : 0.5635763011299647, necr_f1 : 0.8816724694692172, other_f1 : 0.4425313498090523, acc_micro : 0.8816724694692172
[02:43:22.558] train iteration 9883 : loss : 0.359259, loss_ce: 0.518611
[02:43:42.423] train iteration 9933 : loss : 0.527517, loss_ce: 0.807524
[02:44:02.752] train iteration 9983 : loss : 0.598777, loss_ce: 0.743040
[02:44:17.675] val epoch 81 : f1_micro : 0.7108054814430383, f1_macro : 0.5508114500687673, tumor_f1 : 0.8064725181231132, stroma_f1 : 0.6030125216795847, infla_f1 : 0.5642208856745408, necr_f1 : 0.8843410977950463, other_f1 : 0.47312286240944207, acc_micro : 0.8843410977950463
[02:44:19.148] train iteration 10005 : loss : 0.559112, loss_ce: 0.619954
[02:44:38.892] train iteration 10055 : loss : 0.678391, loss_ce: 0.838377
[02:44:59.172] train iteration 10105 : loss : 0.664313, loss_ce: 1.001703
[02:45:14.025] val epoch 82 : f1_micro : 0.7221093888466175, f1_macro : 0.5498677022182025, tumor_f1 : 0.7992126689507411, stroma_f1 : 0.6797472754350076, infla_f1 : 0.5476741068638288, necr_f1 : 0.8888609546881455, other_f1 : 0.4337529047446039, acc_micro : 0.8888609546881455
[02:45:15.548] train iteration 10127 : loss : 0.626483, loss_ce: 0.787198
[02:45:35.290] train iteration 10177 : loss : 0.464698, loss_ce: 0.531976
[02:45:55.505] train iteration 10227 : loss : 0.746727, loss_ce: 1.083112
[02:46:10.339] val epoch 83 : f1_micro : 0.7105525915439312, f1_macro : 0.5355829699681356, tumor_f1 : 0.8007655235437247, stroma_f1 : 0.6400800817287885, infla_f1 : 0.5219359158251721, necr_f1 : 0.8842388712442838, other_f1 : 0.4343842390511642, acc_micro : 0.8842388712442838
[02:46:11.833] train iteration 10249 : loss : 0.492810, loss_ce: 0.604685
[02:46:31.749] train iteration 10299 : loss : 0.510979, loss_ce: 0.562870
[02:46:51.928] train iteration 10349 : loss : 0.405290, loss_ce: 0.494665
[02:47:06.784] val epoch 84 : f1_micro : 0.7207977645672284, f1_macro : 0.5484160895530994, tumor_f1 : 0.7834759308741643, stroma_f1 : 0.6912363160115021, infla_f1 : 0.5058228475256608, necr_f1 : 0.888330108844317, other_f1 : 0.4393909469855806, acc_micro : 0.888330108844317
[02:47:08.216] train iteration 10371 : loss : 0.564070, loss_ce: 0.748073
[02:47:27.959] train iteration 10421 : loss : 0.554455, loss_ce: 0.718110
[02:47:48.115] train iteration 10471 : loss : 0.705462, loss_ce: 0.961752
[02:48:02.802] val epoch 85 : f1_micro : 0.7244270890951157, f1_macro : 0.566968159033702, tumor_f1 : 0.7948968616815714, stroma_f1 : 0.6700850604818418, infla_f1 : 0.5567566520140435, necr_f1 : 0.8897867844654963, other_f1 : 0.4044020124979747, acc_micro : 0.8897867844654963
[02:48:04.298] train iteration 10493 : loss : 0.508499, loss_ce: 0.734553
[02:48:24.144] train iteration 10543 : loss : 0.577162, loss_ce: 0.776867
[02:48:44.462] train iteration 10593 : loss : 0.496388, loss_ce: 0.755790
[02:48:59.057] val epoch 86 : f1_micro : 0.7032216724294883, f1_macro : 0.5399078615009785, tumor_f1 : 0.7967179325910715, stroma_f1 : 0.6143288406041952, infla_f1 : 0.5571114393667533, necr_f1 : 0.8813044703923739, other_f1 : 0.44893067002368087, acc_micro : 0.8813044703923739
[02:49:00.580] train iteration 10615 : loss : 0.510517, loss_ce: 0.613612
[02:49:20.367] train iteration 10665 : loss : 0.603633, loss_ce: 0.762840
[02:49:40.578] train iteration 10715 : loss : 0.447550, loss_ce: 0.623322
[02:49:55.401] val epoch 87 : f1_micro : 0.695846387400077, f1_macro : 0.5390901021086253, tumor_f1 : 0.8032534512189718, stroma_f1 : 0.5859437642189173, infla_f1 : 0.5712806093148314, necr_f1 : 0.8783537585001725, other_f1 : 0.43854839520869204, acc_micro : 0.8783537585001725
[02:49:56.802] train iteration 10737 : loss : 0.605392, loss_ce: 0.846583
[02:50:16.652] train iteration 10787 : loss : 0.624119, loss_ce: 0.794858
[02:50:36.721] train iteration 10837 : loss : 0.473405, loss_ce: 0.733227
[02:50:51.399] val epoch 88 : f1_micro : 0.7155241610912176, f1_macro : 0.5311658875300334, tumor_f1 : 0.803514960866708, stroma_f1 : 0.6524645651762302, infla_f1 : 0.5249285210067263, necr_f1 : 0.8862237792748672, other_f1 : 0.43398850310880405, acc_micro : 0.8862237792748672
[02:50:52.888] train iteration 10859 : loss : 0.525711, loss_ce: 0.622231
[02:51:12.802] train iteration 10909 : loss : 0.508334, loss_ce: 0.597528
[02:51:32.973] train iteration 10959 : loss : 0.608371, loss_ce: 0.891746
[02:51:47.635] val epoch 89 : f1_micro : 0.7269806609703944, f1_macro : 0.5667009789210099, tumor_f1 : 0.7911782528345401, stroma_f1 : 0.6843929136028657, infla_f1 : 0.5084519157759272, necr_f1 : 0.8908021610516769, other_f1 : 0.4406042139117534, acc_micro : 0.8908021610516769
[02:51:49.083] train iteration 10981 : loss : 0.697519, loss_ce: 0.833114
[02:52:08.839] train iteration 11031 : loss : 0.814853, loss_ce: 1.114395
[02:52:28.953] train iteration 11081 : loss : 0.568163, loss_ce: 0.852616
[02:52:43.730] val epoch 90 : f1_micro : 0.7302041879067054, f1_macro : 0.562225497685946, tumor_f1 : 0.8002177018385667, stroma_f1 : 0.6783886460157541, infla_f1 : 0.6171599155059084, necr_f1 : 0.8920949193147513, other_f1 : 0.4376223667909821, acc_micro : 0.8920949193147513
[02:52:45.211] train iteration 11103 : loss : 0.733637, loss_ce: 1.120870
[02:53:04.999] train iteration 11153 : loss : 0.347820, loss_ce: 0.431030
[02:53:25.297] train iteration 11203 : loss : 0.551010, loss_ce: 0.927357
[02:53:40.097] val epoch 91 : f1_micro : 0.7221150100231171, f1_macro : 0.5374739513947413, tumor_f1 : 0.796202308856524, stroma_f1 : 0.6591920216496174, infla_f1 : 0.5699736733849232, necr_f1 : 0.8888590840192941, other_f1 : 0.4385423721888891, acc_micro : 0.8888590840192941
[02:53:41.601] train iteration 11225 : loss : 0.480969, loss_ce: 0.695587
[02:54:01.344] train iteration 11275 : loss : 0.660709, loss_ce: 0.906835
[02:54:21.577] train iteration 11325 : loss : 0.598228, loss_ce: 0.781249
[02:54:36.597] val epoch 92 : f1_micro : 0.722392350435257, f1_macro : 0.5486017792270734, tumor_f1 : 0.7876006639920748, stroma_f1 : 0.673609719826625, infla_f1 : 0.6008641867396923, necr_f1 : 0.8889747376625354, other_f1 : 0.4392119676967223, acc_micro : 0.8889747376625354
[02:54:37.985] train iteration 11347 : loss : 0.590350, loss_ce: 0.711551
[02:54:57.782] train iteration 11397 : loss : 0.553228, loss_ce: 0.747521
[02:55:17.979] train iteration 11447 : loss : 0.617259, loss_ce: 0.760439
[02:55:32.626] val epoch 93 : f1_micro : 0.7272932838935119, f1_macro : 0.559212907575644, tumor_f1 : 0.803286693417109, stroma_f1 : 0.6801452418932548, infla_f1 : 0.5460636295387163, necr_f1 : 0.8909315214707301, other_f1 : 0.43048524610751954, acc_micro : 0.8909315214707301
[02:55:34.077] train iteration 11469 : loss : 0.540272, loss_ce: 0.725964
[02:55:53.975] train iteration 11519 : loss : 0.401072, loss_ce: 0.632805
[02:56:14.196] train iteration 11569 : loss : 0.694986, loss_ce: 0.956199
[02:56:28.936] val epoch 94 : f1_micro : 0.7333296033052298, f1_macro : 0.5698661448863837, tumor_f1 : 0.8082696016018207, stroma_f1 : 0.6748348531814722, infla_f1 : 0.5984711320354388, necr_f1 : 0.893341580262551, other_f1 : 0.437700730349976, acc_micro : 0.893341580262551
[02:56:30.367] train iteration 11591 : loss : 0.516155, loss_ce: 0.642755
[02:56:50.251] train iteration 11641 : loss : 0.582591, loss_ce: 0.732510
[02:57:10.392] train iteration 11691 : loss : 0.582333, loss_ce: 0.800240
[02:57:25.216] val epoch 95 : f1_micro : 0.7086815558947049, f1_macro : 0.5265111659581845, tumor_f1 : 0.7959585992189554, stroma_f1 : 0.636847759095522, infla_f1 : 0.5685988278038656, necr_f1 : 0.8834896958791293, other_f1 : 0.4382542015698094, acc_micro : 0.8834896958791293
[02:57:26.699] train iteration 11713 : loss : 0.579150, loss_ce: 0.754566
[02:57:46.601] train iteration 11763 : loss : 0.415092, loss_ce: 0.529817
[02:58:06.683] train iteration 11813 : loss : 0.696954, loss_ce: 1.032043
[02:58:21.251] val epoch 96 : f1_micro : 0.7272380200716165, f1_macro : 0.55858580997357, tumor_f1 : 0.8075172018546325, stroma_f1 : 0.6567720128939702, infla_f1 : 0.5943799786126385, necr_f1 : 0.8909077667273008, other_f1 : 0.43552771006495905, acc_micro : 0.8909077667273008
[02:58:22.824] train iteration 11835 : loss : 0.533290, loss_ce: 0.702914
[02:58:42.783] train iteration 11885 : loss : 0.522167, loss_ce: 0.678673
[02:59:02.947] train iteration 11935 : loss : 0.523453, loss_ce: 0.637347
[02:59:17.707] val epoch 97 : f1_micro : 0.7232732004844226, f1_macro : 0.5523542885023814, tumor_f1 : 0.8023958103014872, stroma_f1 : 0.6571762836896456, infla_f1 : 0.5566012618633417, necr_f1 : 0.8893247132117932, other_f1 : 0.39889711349342877, acc_micro : 0.8893247132117932
[02:59:19.216] train iteration 11957 : loss : 0.534397, loss_ce: 0.727484
[02:59:39.057] train iteration 12007 : loss : 0.434395, loss_ce: 0.375971
[02:59:59.221] train iteration 12057 : loss : 0.390624, loss_ce: 0.469867
[03:00:14.037] val epoch 98 : f1_micro : 0.7337686408024567, f1_macro : 0.5614382475614548, tumor_f1 : 0.8047616481781006, stroma_f1 : 0.6818183557345316, infla_f1 : 0.5775427325413778, necr_f1 : 0.8935216734042535, other_f1 : 0.4444855136366991, acc_micro : 0.8935216734042535
[03:00:15.428] train iteration 12079 : loss : 0.422720, loss_ce: 0.597105
[03:00:35.264] train iteration 12129 : loss : 0.397780, loss_ce: 0.504435
[03:00:55.442] train iteration 12179 : loss : 0.533489, loss_ce: 0.665924
[03:01:10.381] val epoch 99 : f1_micro : 0.71847070982823, f1_macro : 0.553644346503111, tumor_f1 : 0.8056041116897876, stroma_f1 : 0.6448291310897241, infla_f1 : 0.6366426343044552, necr_f1 : 0.8874040612807641, other_f1 : 0.4165007444456793, acc_micro : 0.8874040612807641
[03:01:11.248] save model to ./logs/frac_0.5/fold_1/epoch_99.pth
[03:01:12.739] train iteration 12201 : loss : 0.666338, loss_ce: 0.951239
[03:01:32.452] train iteration 12251 : loss : 0.347325, loss_ce: 0.364012
[03:01:52.708] train iteration 12301 : loss : 0.610051, loss_ce: 0.846851
[03:02:07.554] val epoch 100 : f1_micro : 0.709765090392186, f1_macro : 0.5646391740212073, tumor_f1 : 0.7728762431786611, stroma_f1 : 0.6575663169989219, infla_f1 : 0.535930174187972, necr_f1 : 0.8839181226033431, other_f1 : 0.4409093768335879, acc_micro : 0.8839181226033431
[03:02:09.123] train iteration 12323 : loss : 0.546951, loss_ce: 0.724971
[03:02:28.930] train iteration 12373 : loss : 0.515411, loss_ce: 0.577283
[03:02:49.116] train iteration 12423 : loss : 0.577521, loss_ce: 0.817196
[03:03:04.043] val epoch 101 : f1_micro : 0.7150307973990073, f1_macro : 0.55763801244589, tumor_f1 : 0.8006636087711041, stroma_f1 : 0.6448349924041674, infla_f1 : 0.5555658575433952, necr_f1 : 0.8860286680551676, other_f1 : 0.452542362233194, acc_micro : 0.8860286680551676
[03:03:05.559] train iteration 12445 : loss : 0.682706, loss_ce: 0.837513
[03:03:25.359] train iteration 12495 : loss : 0.526364, loss_ce: 0.741843
[03:03:45.473] train iteration 12545 : loss : 0.526997, loss_ce: 0.733338
[03:04:00.440] val epoch 102 : f1_micro : 0.7249306245492055, f1_macro : 0.5538787154050974, tumor_f1 : 0.8059021142812876, stroma_f1 : 0.6715540633751795, infla_f1 : 0.56455822281826, necr_f1 : 0.8899875283241272, other_f1 : 0.4297470049932599, acc_micro : 0.8899875283241272
[03:04:01.889] train iteration 12567 : loss : 0.532902, loss_ce: 0.710783
[03:04:21.721] train iteration 12617 : loss : 0.345762, loss_ce: 0.575926
[03:04:42.033] train iteration 12667 : loss : 0.638675, loss_ce: 0.898079
[03:04:56.523] val epoch 103 : f1_micro : 0.7200661932046597, f1_macro : 0.5741560974946389, tumor_f1 : 0.7942564693781046, stroma_f1 : 0.6729712658203565, infla_f1 : 0.5800299388714708, necr_f1 : 0.8880415283716642, other_f1 : 0.4526526658759954, acc_micro : 0.8880415283716642
[03:04:58.028] train iteration 12689 : loss : 0.566432, loss_ce: 0.751819
[03:05:17.805] train iteration 12739 : loss : 0.520888, loss_ce: 0.667565
[03:05:37.986] train iteration 12789 : loss : 0.509210, loss_ce: 0.785854
[03:05:52.641] val epoch 104 : f1_micro : 0.7018622435056247, f1_macro : 0.5417325886396261, tumor_f1 : 0.7760790838645055, stroma_f1 : 0.6208533051495368, infla_f1 : 0.5318390216203764, necr_f1 : 0.8807574969071609, other_f1 : 0.432104352557172, acc_micro : 0.8807574969071609
[03:05:54.058] train iteration 12811 : loss : 0.439646, loss_ce: 0.592437
[03:06:13.906] train iteration 12861 : loss : 0.535097, loss_ce: 0.787773
[03:06:34.121] train iteration 12911 : loss : 0.396919, loss_ce: 0.527380
[03:06:48.789] val epoch 105 : f1_micro : 0.7150744474851168, f1_macro : 0.5671511945816187, tumor_f1 : 0.8093698208148663, stroma_f1 : 0.6379641821751227, infla_f1 : 0.5941130391393716, necr_f1 : 0.8860468337169061, other_f1 : 0.46415145913264355, acc_micro : 0.8860468337169061
[03:06:50.291] train iteration 12933 : loss : 0.450485, loss_ce: 0.632263
[03:07:10.157] train iteration 12983 : loss : 0.466981, loss_ce: 0.632782
[03:07:30.329] train iteration 13033 : loss : 0.518427, loss_ce: 0.597750
[03:07:45.274] val epoch 106 : f1_micro : 0.7342578321695328, f1_macro : 0.5712580130650446, tumor_f1 : 0.8126076253560873, stroma_f1 : 0.6907809972763062, infla_f1 : 0.5754468710376666, necr_f1 : 0.8937162917393905, other_f1 : 0.47511802047777635, acc_micro : 0.8937162917393905
[03:07:46.694] train iteration 13055 : loss : 0.467729, loss_ce: 0.536521
[03:08:06.518] train iteration 13105 : loss : 0.477774, loss_ce: 0.569578
[03:08:26.744] train iteration 13155 : loss : 0.570115, loss_ce: 0.686527
[03:08:41.362] val epoch 107 : f1_micro : 0.7281914009497716, f1_macro : 0.5630586961141, tumor_f1 : 0.8050565169407771, stroma_f1 : 0.6802902703101819, infla_f1 : 0.5802609429049951, necr_f1 : 0.8912909856209388, other_f1 : 0.4437300232933082, acc_micro : 0.8912909856209388
[03:08:42.823] train iteration 13177 : loss : 0.666189, loss_ce: 0.886768
[03:09:02.668] train iteration 13227 : loss : 0.602497, loss_ce: 0.874110
[03:09:22.904] train iteration 13277 : loss : 0.419934, loss_ce: 0.563130
[03:09:37.672] val epoch 108 : f1_micro : 0.7251827625127939, f1_macro : 0.5556503193309674, tumor_f1 : 0.8021532274209536, stroma_f1 : 0.6584663379650849, infla_f1 : 0.5659140193691621, necr_f1 : 0.8900861717187442, other_f1 : 0.42997197423560113, acc_micro : 0.8900861717187442
[03:09:39.203] train iteration 13299 : loss : 0.494935, loss_ce: 0.734335
[03:09:59.055] train iteration 13349 : loss : 0.666558, loss_ce: 0.914185
[03:10:19.300] train iteration 13399 : loss : 0.596981, loss_ce: 0.841064
[03:10:34.083] val epoch 109 : f1_micro : 0.7304980353667185, f1_macro : 0.5620086032610673, tumor_f1 : 0.8058957537779441, stroma_f1 : 0.671445220708847, infla_f1 : 0.5822009478624051, necr_f1 : 0.8922107563568995, other_f1 : 0.40904278540536043, acc_micro : 0.8922107563568995
[03:10:35.620] train iteration 13421 : loss : 0.342094, loss_ce: 0.424447
[03:10:55.403] train iteration 13471 : loss : 0.430120, loss_ce: 0.611024
[03:11:15.753] train iteration 13521 : loss : 0.514657, loss_ce: 0.669238
[03:11:30.496] val epoch 110 : f1_micro : 0.7319280413480905, f1_macro : 0.5817556174901816, tumor_f1 : 0.7982805646382846, stroma_f1 : 0.6819618189564118, infla_f1 : 0.5704483149143366, necr_f1 : 0.8927828875871805, other_f1 : 0.4997624737085201, acc_micro : 0.8927828875871805
[03:11:32.012] train iteration 13543 : loss : 0.564440, loss_ce: 0.793766
[03:11:51.800] train iteration 13593 : loss : 0.458377, loss_ce: 0.626314
[03:12:11.948] train iteration 13643 : loss : 0.497665, loss_ce: 0.727627
[03:12:26.716] val epoch 111 : f1_micro : 0.7127761370860614, f1_macro : 0.5726879090070724, tumor_f1 : 0.7943358306701367, stroma_f1 : 0.6207214101002767, infla_f1 : 0.5884466366125987, necr_f1 : 0.8851253734185145, other_f1 : 0.43742098082573366, acc_micro : 0.8851253734185145
[03:12:28.186] train iteration 13665 : loss : 0.622112, loss_ce: 0.780548
[03:12:48.015] train iteration 13715 : loss : 0.537626, loss_ce: 0.630219
[03:13:08.271] train iteration 13765 : loss : 0.445677, loss_ce: 0.513780
[03:13:23.202] val epoch 112 : f1_micro : 0.7275301882853875, f1_macro : 0.5693419208893409, tumor_f1 : 0.8096015659662393, stroma_f1 : 0.6668849696333592, infla_f1 : 0.6019071602764038, necr_f1 : 0.8910283927734082, other_f1 : 0.44246651235824597, acc_micro : 0.8910283927734082
[03:13:24.648] train iteration 13787 : loss : 0.582924, loss_ce: 0.838338
[03:13:44.440] train iteration 13837 : loss : 0.407610, loss_ce: 0.598347
[03:14:04.738] train iteration 13887 : loss : 0.375649, loss_ce: 0.548803
[03:14:19.483] val epoch 113 : f1_micro : 0.7347000596614984, f1_macro : 0.5706516985709851, tumor_f1 : 0.8030478266569284, stroma_f1 : 0.6888678532380325, infla_f1 : 0.55699778176271, necr_f1 : 0.8938926916856033, other_f1 : 0.44376229485407326, acc_micro : 0.8938926916856033
[03:14:20.987] train iteration 13909 : loss : 0.724656, loss_ce: 1.008182
[03:14:40.805] train iteration 13959 : loss : 0.484983, loss_ce: 0.589813
[03:15:00.940] train iteration 14009 : loss : 0.398606, loss_ce: 0.609604
[03:15:15.668] val epoch 114 : f1_micro : 0.7240643054246902, f1_macro : 0.56777412043168, tumor_f1 : 0.7996147848092593, stroma_f1 : 0.6489018058547606, infla_f1 : 0.5999586420635191, necr_f1 : 0.8896402418613434, other_f1 : 0.4066903915462227, acc_micro : 0.8896402418613434
[03:15:17.094] train iteration 14031 : loss : 0.585778, loss_ce: 0.777056
[03:15:36.892] train iteration 14081 : loss : 0.448841, loss_ce: 0.452434
[03:15:57.161] train iteration 14131 : loss : 0.458308, loss_ce: 0.700440
[03:16:11.879] val epoch 115 : f1_micro : 0.7240186310731448, f1_macro : 0.5509101009139648, tumor_f1 : 0.7944383231493143, stroma_f1 : 0.6588065950916364, infla_f1 : 0.559374374552415, necr_f1 : 0.8896186581024756, other_f1 : 0.4279805944310143, acc_micro : 0.8896186581024756
[03:16:13.357] train iteration 14153 : loss : 0.397879, loss_ce: 0.516730
[03:16:33.200] train iteration 14203 : loss : 0.558638, loss_ce: 0.875547
[03:16:53.448] train iteration 14253 : loss : 0.461515, loss_ce: 0.562141
[03:17:08.268] val epoch 116 : f1_micro : 0.7035744958198987, f1_macro : 0.5405446611917936, tumor_f1 : 0.7753032537607046, stroma_f1 : 0.644536785208262, infla_f1 : 0.5687900765870626, necr_f1 : 0.8814486173483042, other_f1 : 0.42467584787384394, acc_micro : 0.8814486173483042
[03:17:09.704] train iteration 14275 : loss : 0.518983, loss_ce: 0.636144
[03:17:29.565] train iteration 14325 : loss : 0.718713, loss_ce: 1.050647
[03:17:49.773] train iteration 14375 : loss : 0.539081, loss_ce: 0.701492
[03:18:04.558] val epoch 117 : f1_micro : 0.7252015253672233, f1_macro : 0.5798157556698873, tumor_f1 : 0.8019181409707437, stroma_f1 : 0.6557682168025237, infla_f1 : 0.5760420274276, necr_f1 : 0.8900936566866361, other_f1 : 0.44293515835978237, acc_micro : 0.8900936566866361
[03:18:06.007] train iteration 14397 : loss : 0.488928, loss_ce: 0.660822
[03:18:25.918] train iteration 14447 : loss : 0.622198, loss_ce: 0.880107
[03:18:46.008] train iteration 14497 : loss : 0.328837, loss_ce: 0.453774
[03:19:00.968] val epoch 118 : f1_micro : 0.7175170744840915, f1_macro : 0.5486611001766645, tumor_f1 : 0.791716781946329, stroma_f1 : 0.6612659222804583, infla_f1 : 0.5666352453140112, necr_f1 : 0.8870202761430007, other_f1 : 0.4174183327615118, acc_micro : 0.8870202761430007
[03:19:02.438] train iteration 14519 : loss : 0.464618, loss_ce: 0.669049
[03:19:22.351] train iteration 14569 : loss : 0.463552, loss_ce: 0.686252
[03:19:42.529] train iteration 14619 : loss : 0.426765, loss_ce: 0.486013
[03:19:57.305] val epoch 119 : f1_micro : 0.7334551295408835, f1_macro : 0.5742632718040392, tumor_f1 : 0.8122233014840347, stroma_f1 : 0.6609253035141871, infla_f1 : 0.576730018051771, necr_f1 : 0.8933952611226302, other_f1 : 0.43676154376365817, acc_micro : 0.8933952611226302
[03:19:58.779] train iteration 14641 : loss : 0.478302, loss_ce: 0.578499
[03:20:18.571] train iteration 14691 : loss : 0.394611, loss_ce: 0.577583
[03:20:38.823] train iteration 14741 : loss : 0.410275, loss_ce: 0.519464
[03:20:53.260] val epoch 120 : f1_micro : 0.7141571044921875, f1_macro : 0.5377017706632614, tumor_f1 : 0.7960384465180911, stroma_f1 : 0.6364295585797384, infla_f1 : 0.5654655571740407, necr_f1 : 0.8856770785955282, other_f1 : 0.43444538478238076, acc_micro : 0.8856770785955282
[03:20:54.749] train iteration 14763 : loss : 0.527983, loss_ce: 0.761676
[03:21:14.671] train iteration 14813 : loss : 0.326817, loss_ce: 0.392754
[03:21:34.779] train iteration 14863 : loss : 0.609459, loss_ce: 0.747906
[03:21:49.461] val epoch 121 : f1_micro : 0.720492728627645, f1_macro : 0.5724582236546737, tumor_f1 : 0.800303808771647, stroma_f1 : 0.656090198801114, infla_f1 : 0.6101048970348739, necr_f1 : 0.8882107024009411, other_f1 : 0.4434821982375489, acc_micro : 0.8882107024009411
[03:21:50.995] train iteration 14885 : loss : 0.420136, loss_ce: 0.608887
[03:22:10.868] train iteration 14935 : loss : 0.546768, loss_ce: 0.701726
[03:22:31.059] train iteration 14985 : loss : 0.551850, loss_ce: 0.721112
[03:22:45.669] val epoch 122 : f1_micro : 0.7039114569242184, f1_macro : 0.5454756823869852, tumor_f1 : 0.7558387758640143, stroma_f1 : 0.6570667664592083, infla_f1 : 0.5744736862342017, necr_f1 : 0.8815792363423568, other_f1 : 0.4058983132384198, acc_micro : 0.8815792363423568
[03:22:47.182] train iteration 15007 : loss : 0.450842, loss_ce: 0.549381
[03:23:07.006] train iteration 15057 : loss : 0.588395, loss_ce: 0.805577
[03:23:27.300] train iteration 15107 : loss : 0.646242, loss_ce: 0.859032
[03:23:42.068] val epoch 123 : f1_micro : 0.7272260062969648, f1_macro : 0.577002621614016, tumor_f1 : 0.801035654086333, stroma_f1 : 0.6794269107855283, infla_f1 : 0.5882173060224607, necr_f1 : 0.8909020607288067, other_f1 : 0.4419665229551566, acc_micro : 0.8909020607288067
[03:23:43.567] train iteration 15129 : loss : 0.735326, loss_ce: 0.807724
[03:24:03.427] train iteration 15179 : loss : 0.349596, loss_ce: 0.481087
[03:24:23.536] train iteration 15229 : loss : 0.351767, loss_ce: 0.539552
[03:24:38.159] val epoch 124 : f1_micro : 0.7281571993461022, f1_macro : 0.5840493601102096, tumor_f1 : 0.8062097063431373, stroma_f1 : 0.6696031276996319, infla_f1 : 0.5862564456004363, necr_f1 : 0.8912749680188986, other_f1 : 0.4332727672926222, acc_micro : 0.8912749680188986
[03:24:39.628] train iteration 15251 : loss : 0.704956, loss_ce: 1.039039
[03:24:59.591] train iteration 15301 : loss : 0.823982, loss_ce: 1.052391
[03:25:19.808] train iteration 15351 : loss : 0.588188, loss_ce: 0.800167
[03:25:34.747] val epoch 125 : f1_micro : 0.7232494067687255, f1_macro : 0.5999577446625783, tumor_f1 : 0.7996519116254953, stroma_f1 : 0.6496688328110255, infla_f1 : 0.6391738893894049, necr_f1 : 0.8893110087284675, other_f1 : 0.4629799265620442, acc_micro : 0.8893110087284675
[03:25:36.220] train iteration 15373 : loss : 0.266317, loss_ce: 0.383041
[03:25:56.096] train iteration 15423 : loss : 0.545964, loss_ce: 0.733898
[03:26:16.199] train iteration 15473 : loss : 0.484053, loss_ce: 0.665434
[03:26:31.119] val epoch 126 : f1_micro : 0.7283354905935434, f1_macro : 0.5802385394389813, tumor_f1 : 0.8104420464772445, stroma_f1 : 0.651442421027101, infla_f1 : 0.6034935552340287, necr_f1 : 0.8913487975413983, other_f1 : 0.4522951952172801, acc_micro : 0.8913487975413983
[03:26:32.629] train iteration 15495 : loss : 0.462113, loss_ce: 0.601172
[03:26:52.432] train iteration 15545 : loss : 0.543672, loss_ce: 0.661064
[03:27:12.715] train iteration 15595 : loss : 0.575646, loss_ce: 0.685288
[03:27:27.449] val epoch 127 : f1_micro : 0.7340234884848962, f1_macro : 0.6132732927799225, tumor_f1 : 0.8057381189786471, stroma_f1 : 0.675614402271234, infla_f1 : 0.6395410018471571, necr_f1 : 0.8936217289704543, other_f1 : 0.4478423689456227, acc_micro : 0.8936217289704543
[03:27:28.953] train iteration 15617 : loss : 0.423802, loss_ce: 0.621107
[03:27:48.791] train iteration 15667 : loss : 0.439504, loss_ce: 0.576264
[03:28:09.111] train iteration 15717 : loss : 0.488739, loss_ce: 0.631120
[03:28:23.659] val epoch 128 : f1_micro : 0.732541825908881, f1_macro : 0.5698752128160917, tumor_f1 : 0.8120866922231821, stroma_f1 : 0.6620762010033314, infla_f1 : 0.6301114186644554, necr_f1 : 0.8930320029075329, other_f1 : 0.4141456425154152, acc_micro : 0.8930320029075329
[03:28:25.138] train iteration 15739 : loss : 0.603000, loss_ce: 0.905475
[03:28:44.929] train iteration 15789 : loss : 0.414462, loss_ce: 0.629193
[03:29:05.159] train iteration 15839 : loss : 0.673685, loss_ce: 1.024053
[03:29:19.837] val epoch 129 : f1_micro : 0.7036549712602909, f1_macro : 0.5285497370820779, tumor_f1 : 0.7933247204010303, stroma_f1 : 0.6183886946393893, infla_f1 : 0.5988425989277087, necr_f1 : 0.8814807259119474, other_f1 : 0.40411386106615493, acc_micro : 0.8814807259119474
[03:29:21.239] train iteration 15861 : loss : 0.767239, loss_ce: 1.124918
[03:29:41.064] train iteration 15911 : loss : 0.550456, loss_ce: 0.730791
[03:30:01.318] train iteration 15961 : loss : 0.478868, loss_ce: 0.628599
[03:30:15.934] val epoch 130 : f1_micro : 0.7195410017783825, f1_macro : 0.5713010499110589, tumor_f1 : 0.8071589538684258, stroma_f1 : 0.6567871020390437, infla_f1 : 0.6201122500575506, necr_f1 : 0.8878350991469163, other_f1 : 0.4132746525126724, acc_micro : 0.8878350991469163
[03:30:17.404] train iteration 15983 : loss : 0.602219, loss_ce: 0.776272
[03:30:37.178] train iteration 16033 : loss : 0.357077, loss_ce: 0.495285
[03:30:57.390] train iteration 16083 : loss : 0.517516, loss_ce: 0.631870
[03:31:12.215] val epoch 131 : f1_micro : 0.7248272872888125, f1_macro : 0.5678091020538256, tumor_f1 : 0.7930809328189263, stroma_f1 : 0.6674213501123282, infla_f1 : 0.5605020941450045, necr_f1 : 0.8899455276819376, other_f1 : 0.4401079242010243, acc_micro : 0.8899455276819376
[03:31:13.684] train iteration 16105 : loss : 0.484945, loss_ce: 0.518130
[03:31:33.492] train iteration 16155 : loss : 0.367265, loss_ce: 0.533954
[03:31:53.704] train iteration 16205 : loss : 0.357010, loss_ce: 0.528291
[03:32:08.386] val epoch 132 : f1_micro : 0.7037587119982793, f1_macro : 0.5516220632080848, tumor_f1 : 0.783490579861861, stroma_f1 : 0.6369336167207131, infla_f1 : 0.5568222483584228, necr_f1 : 0.8815224720881536, other_f1 : 0.4344704234883046, acc_micro : 0.8815224720881536
[03:32:09.870] train iteration 16227 : loss : 0.541931, loss_ce: 0.712586
[03:32:29.587] train iteration 16277 : loss : 0.600646, loss_ce: 0.755350
[03:32:49.844] train iteration 16327 : loss : 0.465923, loss_ce: 0.596800
[03:33:04.445] val epoch 133 : f1_micro : 0.7228562098283035, f1_macro : 0.5656789882251849, tumor_f1 : 0.8018136001550235, stroma_f1 : 0.650512342269604, infla_f1 : 0.5608086126784866, necr_f1 : 0.8891579967278701, other_f1 : 0.4515278854344685, acc_micro : 0.8891579967278701
[03:33:05.868] train iteration 16349 : loss : 0.422707, loss_ce: 0.471140
[03:33:25.837] train iteration 16399 : loss : 0.623587, loss_ce: 0.982045
[03:33:46.033] train iteration 16449 : loss : 0.584681, loss_ce: 0.780912
[03:34:01.036] val epoch 134 : f1_micro : 0.730198391355001, f1_macro : 0.5827430521066372, tumor_f1 : 0.80797046652207, stroma_f1 : 0.67190859409479, infla_f1 : 0.584558251958627, necr_f1 : 0.8920916273043706, other_f1 : 0.5211933435258778, acc_micro : 0.8920916273043706
[03:34:02.531] train iteration 16471 : loss : 0.463963, loss_ce: 0.624947
[03:34:22.300] train iteration 16521 : loss : 0.628930, loss_ce: 0.972268
[03:34:42.508] train iteration 16571 : loss : 0.390109, loss_ce: 0.468036
[03:34:57.047] val epoch 135 : f1_micro : 0.7161248097052941, f1_macro : 0.5757499864468207, tumor_f1 : 0.7954040800149624, stroma_f1 : 0.6402146285041593, infla_f1 : 0.5655295540793583, necr_f1 : 0.8864644605379838, other_f1 : 0.44830243094027256, acc_micro : 0.8864644605379838
[03:34:58.522] train iteration 16593 : loss : 0.564333, loss_ce: 0.781921
[03:35:18.372] train iteration 16643 : loss : 0.344309, loss_ce: 0.440993
[03:35:38.574] train iteration 16693 : loss : 0.396300, loss_ce: 0.504419
[03:35:53.281] val epoch 136 : f1_micro : 0.7221511247066351, f1_macro : 0.5719910137928449, tumor_f1 : 0.8058561682701111, stroma_f1 : 0.6486041809503849, infla_f1 : 0.5746075631334231, necr_f1 : 0.8888770364798032, other_f1 : 0.45952198709486625, acc_micro : 0.8888770364798032
[03:35:54.750] train iteration 16715 : loss : 0.616525, loss_ce: 0.778223
[03:36:14.650] train iteration 16765 : loss : 0.429330, loss_ce: 0.556304
[03:36:34.928] train iteration 16815 : loss : 0.473445, loss_ce: 0.773455
[03:36:49.426] val epoch 137 : f1_micro : 0.7297718307146659, f1_macro : 0.5888848969569573, tumor_f1 : 0.8058737974900466, stroma_f1 : 0.6620455802633212, infla_f1 : 0.6053225953991597, necr_f1 : 0.8919221414969518, other_f1 : 0.47596001488720785, acc_micro : 0.8919221414969518
[03:36:50.844] train iteration 16837 : loss : 0.643026, loss_ce: 0.916910
[03:37:10.723] train iteration 16887 : loss : 0.313348, loss_ce: 0.406054
[03:37:30.923] train iteration 16937 : loss : 0.419088, loss_ce: 0.680930
[03:37:45.842] val epoch 138 : f1_micro : 0.7324113765588174, f1_macro : 0.5995123650018985, tumor_f1 : 0.8111514575206317, stroma_f1 : 0.6615854639273423, infla_f1 : 0.6136456283095938, necr_f1 : 0.8929773912980006, other_f1 : 0.47493089701255, acc_micro : 0.8929773912980006
[03:37:47.257] train iteration 16959 : loss : 0.518327, loss_ce: 0.716974
[03:38:07.027] train iteration 17009 : loss : 0.300254, loss_ce: 0.428724
[03:38:27.321] train iteration 17059 : loss : 0.492657, loss_ce: 0.517972
[03:38:41.879] val epoch 139 : f1_micro : 0.7310545318401777, f1_macro : 0.5800598286665403, tumor_f1 : 0.807491442331901, stroma_f1 : 0.6738509994286758, infla_f1 : 0.6032728719023558, necr_f1 : 0.8924340009689331, other_f1 : 0.49243695970373946, acc_micro : 0.8924340009689331
[03:38:43.305] train iteration 17081 : loss : 0.488957, loss_ce: 0.663098
[03:39:03.214] train iteration 17131 : loss : 0.680685, loss_ce: 0.881523
[03:39:23.293] train iteration 17181 : loss : 0.512458, loss_ce: 0.620677
[03:39:38.308] val epoch 140 : f1_micro : 0.7317346357382261, f1_macro : 0.5749963097847425, tumor_f1 : 0.8065379078571613, stroma_f1 : 0.6664172193178763, infla_f1 : 0.5601290521713403, necr_f1 : 0.8927067036812122, other_f1 : 0.4501305826393386, acc_micro : 0.8927067036812122
[03:39:39.844] train iteration 17203 : loss : 0.529016, loss_ce: 0.689371
[03:39:59.618] train iteration 17253 : loss : 0.473588, loss_ce: 0.596551
[03:40:19.844] train iteration 17303 : loss : 0.390029, loss_ce: 0.556657
[03:40:34.664] val epoch 141 : f1_micro : 0.7270822238463622, f1_macro : 0.5681293847469183, tumor_f1 : 0.808005534685575, stroma_f1 : 0.6589141664310143, infla_f1 : 0.5811608789058832, necr_f1 : 0.8908466398715973, other_f1 : 0.42006881131853263, acc_micro : 0.8908466398715973
[03:40:36.089] train iteration 17325 : loss : 0.427003, loss_ce: 0.524679
[03:40:55.942] train iteration 17375 : loss : 0.591947, loss_ce: 0.898293
[03:41:16.101] train iteration 17425 : loss : 0.368812, loss_ce: 0.541936
[03:41:30.923] val epoch 142 : f1_micro : 0.7339762460726958, f1_macro : 0.5734296842263296, tumor_f1 : 0.8077405324349036, stroma_f1 : 0.6720794072517982, infla_f1 : 0.5967001754503983, necr_f1 : 0.8936037604625409, other_f1 : 0.45341665372073364, acc_micro : 0.8936037604625409
[03:41:32.439] train iteration 17447 : loss : 0.476564, loss_ce: 0.631739
[03:41:52.307] train iteration 17497 : loss : 0.366406, loss_ce: 0.542745
[03:42:12.594] train iteration 17547 : loss : 0.454397, loss_ce: 0.643326
[03:42:27.319] val epoch 143 : f1_micro : 0.7314872225889792, f1_macro : 0.5651366366789892, tumor_f1 : 0.8054383144928858, stroma_f1 : 0.6678675550680894, infla_f1 : 0.5632577687501907, necr_f1 : 0.8926070882723882, other_f1 : 0.44212584804448013, acc_micro : 0.8926070882723882
[03:42:28.757] train iteration 17569 : loss : 0.274810, loss_ce: 0.413663
[03:42:48.544] train iteration 17619 : loss : 0.479369, loss_ce: 0.604707
[03:43:08.800] train iteration 17669 : loss : 0.409706, loss_ce: 0.616300
[03:43:23.420] val epoch 144 : f1_micro : 0.7311115906788752, f1_macro : 0.5550489924274958, tumor_f1 : 0.8065792241921792, stroma_f1 : 0.6749354509206918, infla_f1 : 0.5679780584043608, necr_f1 : 0.8924588331809411, other_f1 : 0.45470606692833826, acc_micro : 0.8924588331809411
[03:43:24.869] train iteration 17691 : loss : 0.643409, loss_ce: 0.887037
[03:43:44.725] train iteration 17741 : loss : 0.503263, loss_ce: 0.647619
[03:44:04.918] train iteration 17791 : loss : 0.473330, loss_ce: 0.591777
[03:44:19.710] val epoch 145 : f1_micro : 0.731552956195978, f1_macro : 0.5760179597597855, tumor_f1 : 0.807518720626831, stroma_f1 : 0.6691984637425497, infla_f1 : 0.5940116513520479, necr_f1 : 0.8926347906772907, other_f1 : 0.4544190971870333, acc_micro : 0.8926347906772907
[03:44:21.175] train iteration 17813 : loss : 0.432561, loss_ce: 0.476991
[03:44:40.958] train iteration 17863 : loss : 0.422896, loss_ce: 0.500100
[03:45:01.173] train iteration 17913 : loss : 0.362526, loss_ce: 0.483889
[03:45:15.836] val epoch 146 : f1_micro : 0.7312930283638147, f1_macro : 0.5739395526739267, tumor_f1 : 0.8071938134156741, stroma_f1 : 0.6695072272649178, infla_f1 : 0.5812335749013493, necr_f1 : 0.8925299804944259, other_f1 : 0.4434585848178428, acc_micro : 0.8925299804944259
[03:45:17.358] train iteration 17935 : loss : 0.422058, loss_ce: 0.537847
[03:45:37.234] train iteration 17985 : loss : 0.587662, loss_ce: 0.790786
[03:45:57.446] train iteration 18035 : loss : 0.430318, loss_ce: 0.626021
[03:46:12.291] val epoch 147 : f1_micro : 0.7293347819493368, f1_macro : 0.5716578811407089, tumor_f1 : 0.8071408054003348, stroma_f1 : 0.6644239654907813, infla_f1 : 0.5588929509887328, necr_f1 : 0.8917480363295629, other_f1 : 0.4514388901074059, acc_micro : 0.8917480363295629
[03:46:13.729] train iteration 18057 : loss : 0.544262, loss_ce: 0.841649
[03:46:33.499] train iteration 18107 : loss : 0.451299, loss_ce: 0.530054
[03:46:53.691] train iteration 18157 : loss : 0.390812, loss_ce: 0.555906
[03:47:08.698] val epoch 148 : f1_micro : 0.729956193612172, f1_macro : 0.5725965436834556, tumor_f1 : 0.809568770802938, stroma_f1 : 0.6653531182270783, infla_f1 : 0.5591685966803477, necr_f1 : 0.8919960397940415, other_f1 : 0.4502664937082535, acc_micro : 0.8919960397940415
[03:47:10.266] train iteration 18179 : loss : 0.418395, loss_ce: 0.689675
[03:47:30.049] train iteration 18229 : loss : 0.386552, loss_ce: 0.529257
[03:47:50.209] train iteration 18279 : loss : 0.481572, loss_ce: 0.589579
[03:48:05.190] val epoch 149 : f1_micro : 0.7307997621022738, f1_macro : 0.5729640395595477, tumor_f1 : 0.8097669791716796, stroma_f1 : 0.6671935646579816, infla_f1 : 0.5562813058495522, necr_f1 : 0.892333468565574, other_f1 : 0.4524077013126001, acc_micro : 0.892333468565574
[03:48:06.009] save model to ./logs/frac_0.5/fold_1/epoch_149.pth
[03:48:06.834] save model to ./logs/frac_0.5/fold_1/epoch_149.pth

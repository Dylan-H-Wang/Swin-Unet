[08:35:18.577] Namespace(root_path='../data/bcss/L0_1024_s512', dataset='bcss', list_dir='./lists/lists_Synapse', num_classes=6, output_dir='./logs/frac_0.5/fold_4', max_iterations=30000, max_epochs=150, batch_size=24, n_gpu=1, deterministic=0, base_lr=0.05, img_size=224, seed=1234, cfg='configs/swin_tiny_patch4_window7_224_lite.yaml', opts=None, zip=False, cache_mode='part', resume=None, accumulation_steps=None, use_checkpoint=False, amp_opt_level='O1', tag=None, eval=False, throughput=False, frac=0.5, fold=4)
[08:35:18.601] Reading 9897 files in ../data/bcss/L0_1024_s512/data.csv...
[08:35:18.613] Using fold 4 and keep 6692 train files only...
[08:35:18.614] Removing images with threshold of 0.1...
[08:35:18.615] Create train set with 6004 files...
[08:35:18.615] Use 0.5 percent of data to train: 3002!
[08:35:18.619] Reading 804 files in ../data/bcss/L0_1024_s512/val_data.csv...
[08:35:18.622] Using fold 4 and keep 101 val files only...
[08:35:18.622] Removing images with threshold of 0.1...
[08:35:18.622] Create val set with 80 files...
[08:35:19.497] 126 iterations per epoch. 18900 max iterations 
[08:35:22.227] train iteration 1 : loss : 1.286553, loss_ce: 1.923632
[08:35:41.879] train iteration 51 : loss : 0.836713, loss_ce: 0.951251
[08:36:01.803] train iteration 101 : loss : 0.862427, loss_ce: 1.144776
[08:36:13.860] val epoch 0 : f1_micro : 0.47058212757110596, f1_macro : 0.33432588619845255, tumor_f1 : 0.6041727236339024, stroma_f1 : 0.18725738341787032, infla_f1 : 0.0772920586168766, necr_f1 : 0.7882378697395325, other_f1 : 0.3735431283712387, acc_micro : 0.7882378697395325
[08:36:15.339] train iteration 127 : loss : 0.817791, loss_ce: 1.236062
[08:36:35.284] train iteration 177 : loss : 0.928271, loss_ce: 1.264013
[08:36:55.717] train iteration 227 : loss : 0.830328, loss_ce: 1.130483
[08:37:07.207] val epoch 1 : f1_micro : 0.5810786443097251, f1_macro : 0.4334897186074938, tumor_f1 : 0.6576229376452309, stroma_f1 : 0.5227113014885357, infla_f1 : 0.02960253001323768, necr_f1 : 0.8324377621923175, other_f1 : 0.5289404307092939, acc_micro : 0.8324377621923175
[08:37:08.687] train iteration 253 : loss : 0.841994, loss_ce: 1.098192
[08:37:28.768] train iteration 303 : loss : 0.720804, loss_ce: 0.949572
[08:37:49.019] train iteration 353 : loss : 0.592639, loss_ce: 0.863502
[08:38:00.537] val epoch 2 : f1_micro : 0.5490283497742244, f1_macro : 0.47453547162669046, tumor_f1 : 0.584392134632383, stroma_f1 : 0.5696383501802172, infla_f1 : 0.14422060336385453, necr_f1 : 0.8196620089667184, other_f1 : 0.5029976793697902, acc_micro : 0.8196620089667184
[08:38:02.034] train iteration 379 : loss : 0.794249, loss_ce: 0.999218
[08:38:22.065] train iteration 429 : loss : 0.571368, loss_ce: 0.721308
[08:38:42.289] train iteration 479 : loss : 0.820851, loss_ce: 1.056753
[08:38:53.769] val epoch 3 : f1_micro : 0.5738666313035148, f1_macro : 0.4869887743677412, tumor_f1 : 0.6399116941860744, stroma_f1 : 0.5521434226206371, infla_f1 : 0.057888775531734736, necr_f1 : 0.8296166402953011, other_f1 : 0.4707143136433193, acc_micro : 0.8296166402953011
[08:38:55.343] train iteration 505 : loss : 0.799916, loss_ce: 0.945671
[08:39:15.274] train iteration 555 : loss : 0.738420, loss_ce: 0.886359
[08:39:35.608] train iteration 605 : loss : 0.934876, loss_ce: 1.393052
[08:39:47.031] val epoch 4 : f1_micro : 0.541029270206179, f1_macro : 0.39048602325575693, tumor_f1 : 0.640984560762133, stroma_f1 : 0.4599567875266075, infla_f1 : 0.07020782040698188, necr_f1 : 0.816504716873169, other_f1 : 0.49556672998837065, acc_micro : 0.816504716873169
[08:39:48.529] train iteration 631 : loss : 0.840097, loss_ce: 1.188029
[08:40:08.611] train iteration 681 : loss : 0.924232, loss_ce: 1.329050
[08:40:28.782] train iteration 731 : loss : 0.747510, loss_ce: 0.986528
[08:40:40.279] val epoch 5 : f1_micro : 0.5615942691053663, f1_macro : 0.4649010854107993, tumor_f1 : 0.657584765127727, stroma_f1 : 0.5206956065126828, infla_f1 : 0.11575116004262652, necr_f1 : 0.8247736011232648, other_f1 : 0.4590453122343336, acc_micro : 0.8247736011232648
[08:40:41.807] train iteration 757 : loss : 0.799131, loss_ce: 1.107658
[08:41:01.757] train iteration 807 : loss : 0.794334, loss_ce: 1.032171
[08:41:21.865] train iteration 857 : loss : 0.702950, loss_ce: 0.954363
[08:41:33.220] val epoch 6 : f1_micro : 0.5854090111596244, f1_macro : 0.4637064550604139, tumor_f1 : 0.6691006251743862, stroma_f1 : 0.5381317149315562, infla_f1 : 0.06583038664289884, necr_f1 : 0.8342414924076625, other_f1 : 0.47404091698782785, acc_micro : 0.8342414924076625
[08:41:34.804] train iteration 883 : loss : 0.746271, loss_ce: 0.927021
[08:41:54.873] train iteration 933 : loss : 0.870103, loss_ce: 1.274561
[08:42:15.021] train iteration 983 : loss : 0.702127, loss_ce: 0.961621
[08:42:26.415] val epoch 7 : f1_micro : 0.5684489054339272, f1_macro : 0.4149326426642282, tumor_f1 : 0.6511770955153874, stroma_f1 : 0.5220110033239637, infla_f1 : 0.2181696551186698, necr_f1 : 0.8274352295058114, other_f1 : 0.49742995841162546, acc_micro : 0.8274352295058114
[08:42:27.866] train iteration 1009 : loss : 0.875402, loss_ce: 1.091691
[08:42:47.708] train iteration 1059 : loss : 0.640467, loss_ce: 0.751095
[08:43:07.972] train iteration 1109 : loss : 0.674082, loss_ce: 0.858191
[08:43:19.338] val epoch 8 : f1_micro : 0.569954012121473, f1_macro : 0.3678706969533648, tumor_f1 : 0.6591630578041077, stroma_f1 : 0.4915489400071757, infla_f1 : 0.012871787484203066, necr_f1 : 0.8280657955578395, other_f1 : 0.5177007785865239, acc_micro : 0.8280657955578395
[08:43:20.720] train iteration 1135 : loss : 0.867686, loss_ce: 1.151901
[08:43:40.758] train iteration 1185 : loss : 0.665766, loss_ce: 0.858993
[08:44:00.961] train iteration 1235 : loss : 0.716327, loss_ce: 1.061927
[08:44:12.303] val epoch 9 : f1_micro : 0.598460465669632, f1_macro : 0.5043570867606572, tumor_f1 : 0.684359107698713, stroma_f1 : 0.5286683695656913, infla_f1 : 0.22511469466345652, necr_f1 : 0.839422345161438, other_f1 : 0.5110016310188387, acc_micro : 0.839422345161438
[08:44:13.818] train iteration 1261 : loss : 0.839302, loss_ce: 1.198427
[08:44:33.702] train iteration 1311 : loss : 0.600214, loss_ce: 0.854532
[08:44:53.871] train iteration 1361 : loss : 0.721007, loss_ce: 1.022157
[08:45:05.167] val epoch 10 : f1_micro : 0.591695385319846, f1_macro : 0.4643931474004473, tumor_f1 : 0.6701845143522535, stroma_f1 : 0.5356870155249324, infla_f1 : 0.03927478869445622, necr_f1 : 0.8367003883634295, other_f1 : 0.50491350037711, acc_micro : 0.8367003883634295
[08:45:06.644] train iteration 1387 : loss : 0.697102, loss_ce: 0.911376
[08:45:26.635] train iteration 1437 : loss : 0.701604, loss_ce: 0.902725
[08:45:46.859] train iteration 1487 : loss : 0.678929, loss_ce: 0.900682
[08:45:58.237] val epoch 11 : f1_micro : 0.5965030150754111, f1_macro : 0.47372594475746155, tumor_f1 : 0.6828574453081403, stroma_f1 : 0.5294266098311969, infla_f1 : 0.2003120950290135, necr_f1 : 0.8386633055550712, other_f1 : 0.5268305433647973, acc_micro : 0.8386633055550712
[08:45:59.751] train iteration 1513 : loss : 0.466726, loss_ce: 0.613410
[08:46:19.662] train iteration 1563 : loss : 0.664599, loss_ce: 0.833035
[08:46:39.761] train iteration 1613 : loss : 0.565943, loss_ce: 0.745185
[08:46:51.145] val epoch 12 : f1_micro : 0.6057871792997632, f1_macro : 0.4636299226965223, tumor_f1 : 0.6811478393418449, stroma_f1 : 0.552570892231805, infla_f1 : 0.28777713435036795, necr_f1 : 0.8423589723450797, other_f1 : 0.5109394192695618, acc_micro : 0.8423589723450797
[08:46:52.571] train iteration 1639 : loss : 0.571877, loss_ce: 0.723920
[08:47:12.593] train iteration 1689 : loss : 0.578845, loss_ce: 0.787870
[08:47:32.776] train iteration 1739 : loss : 0.560093, loss_ce: 0.693602
[08:47:44.066] val epoch 13 : f1_micro : 0.594210011618478, f1_macro : 0.5009079958711352, tumor_f1 : 0.6742034980228969, stroma_f1 : 0.5419899129441806, infla_f1 : 0.18246810936502048, necr_f1 : 0.8376858149256025, other_f1 : 0.5344498817409787, acc_micro : 0.8376858149256025
[08:47:45.535] train iteration 1765 : loss : 0.901530, loss_ce: 1.248851
[08:48:05.441] train iteration 1815 : loss : 0.747707, loss_ce: 1.079676
[08:48:25.594] train iteration 1865 : loss : 0.581198, loss_ce: 0.733622
[08:48:36.966] val epoch 14 : f1_micro : 0.6065221428871155, f1_macro : 0.44758992535727365, tumor_f1 : 0.6626983497823987, stroma_f1 : 0.5520055421761104, infla_f1 : 0.1867304274014064, necr_f1 : 0.8426297051565987, other_f1 : 0.5353256676878247, acc_micro : 0.8426297051565987
[08:48:38.438] train iteration 1891 : loss : 0.807648, loss_ce: 0.958674
[08:48:58.365] train iteration 1941 : loss : 0.602124, loss_ce: 0.756910
[08:49:18.461] train iteration 1991 : loss : 0.732477, loss_ce: 1.003138
[08:49:29.932] val epoch 15 : f1_micro : 0.6280021922928947, f1_macro : 0.47356769868305754, tumor_f1 : 0.7037207441670554, stroma_f1 : 0.5582366308995655, infla_f1 : 0.2838649409157889, necr_f1 : 0.8512316346168518, other_f1 : 0.521845851625715, acc_micro : 0.8512316346168518
[08:49:31.488] train iteration 2017 : loss : 0.704888, loss_ce: 0.954199
[08:49:51.425] train iteration 2067 : loss : 0.621341, loss_ce: 0.884155
[08:50:11.539] train iteration 2117 : loss : 0.722570, loss_ce: 1.011369
[08:50:23.081] val epoch 16 : f1_micro : 0.6167312179292951, f1_macro : 0.4719270425183432, tumor_f1 : 0.7055080618177142, stroma_f1 : 0.5288825184106827, infla_f1 : 0.30583747369902475, necr_f1 : 0.8467150330543518, other_f1 : 0.5180720814636776, acc_micro : 0.8467150330543518
[08:50:24.527] train iteration 2143 : loss : 0.650280, loss_ce: 0.769005
[08:50:44.479] train iteration 2193 : loss : 0.749851, loss_ce: 0.973815
[08:51:04.707] train iteration 2243 : loss : 0.696681, loss_ce: 0.934536
[08:51:16.100] val epoch 17 : f1_micro : 0.6031976767948696, f1_macro : 0.5326054905142102, tumor_f1 : 0.685140596968787, stroma_f1 : 0.5352617161614555, infla_f1 : 0.3617530405255301, necr_f1 : 0.8412869572639465, other_f1 : 0.5094434448650905, acc_micro : 0.8412869572639465
[08:51:17.572] train iteration 2269 : loss : 0.638345, loss_ce: 1.015873
[08:51:37.472] train iteration 2319 : loss : 0.505282, loss_ce: 0.611969
[08:51:57.597] train iteration 2369 : loss : 0.759292, loss_ce: 1.060333
[08:52:09.125] val epoch 18 : f1_micro : 0.6044831957135882, f1_macro : 0.5009349158832005, tumor_f1 : 0.6875302578721728, stroma_f1 : 0.5181116083902972, infla_f1 : 0.33938212054116385, necr_f1 : 0.841799625328609, other_f1 : 0.5310792305639812, acc_micro : 0.841799625328609
[08:52:10.563] train iteration 2395 : loss : 0.719860, loss_ce: 1.009441
[08:52:30.395] train iteration 2445 : loss : 0.642114, loss_ce: 0.741039
[08:52:50.647] train iteration 2495 : loss : 0.631422, loss_ce: 0.987868
[08:53:01.969] val epoch 19 : f1_micro : 0.6198939042431968, f1_macro : 0.5286657937935421, tumor_f1 : 0.6898779102734157, stroma_f1 : 0.575298901115145, infla_f1 : 0.13446956979376928, necr_f1 : 0.847973244530814, other_f1 : 0.5293968154915741, acc_micro : 0.847973244530814
[08:53:03.459] train iteration 2521 : loss : 0.710555, loss_ce: 0.993034
[08:53:23.375] train iteration 2571 : loss : 0.526414, loss_ce: 0.706182
[08:53:43.522] train iteration 2621 : loss : 0.826043, loss_ce: 1.166071
[08:53:54.998] val epoch 20 : f1_micro : 0.6046437748840877, f1_macro : 0.4629513110433306, tumor_f1 : 0.6906838502202716, stroma_f1 : 0.5318629635231835, infla_f1 : 0.2631386652647052, necr_f1 : 0.8418621165411813, other_f1 : 0.5378141530922481, acc_micro : 0.8418621165411813
[08:53:56.514] train iteration 2647 : loss : 0.733874, loss_ce: 0.916659
[08:54:16.328] train iteration 2697 : loss : 0.693346, loss_ce: 0.893935
[08:54:36.540] train iteration 2747 : loss : 0.333533, loss_ce: 0.433956
[08:54:47.900] val epoch 21 : f1_micro : 0.6337157828467233, f1_macro : 0.444351715700967, tumor_f1 : 0.7032023796013424, stroma_f1 : 0.5768194432769503, infla_f1 : 0.2850594861166818, necr_f1 : 0.8535287465367999, other_f1 : 0.5138201032366071, acc_micro : 0.8535287465367999
[08:54:49.336] train iteration 2773 : loss : 0.518875, loss_ce: 0.604394
[08:55:09.414] train iteration 2823 : loss : 0.531078, loss_ce: 0.668560
[08:55:29.494] train iteration 2873 : loss : 0.605886, loss_ce: 0.724757
[08:55:40.910] val epoch 22 : f1_micro : 0.6152957848140171, f1_macro : 0.4268064498901367, tumor_f1 : 0.7073873153754643, stroma_f1 : 0.48835042651210514, infla_f1 : 0.41442299102033886, necr_f1 : 0.8461429902485439, other_f1 : 0.5190224732671466, acc_micro : 0.8461429902485439
[08:55:42.377] train iteration 2899 : loss : 0.650174, loss_ce: 0.862739
[08:56:02.321] train iteration 2949 : loss : 0.502206, loss_ce: 0.728245
[08:56:22.447] train iteration 2999 : loss : 0.707122, loss_ce: 1.050212
[08:56:33.800] val epoch 23 : f1_micro : 0.6281506036009107, f1_macro : 0.4945189186504909, tumor_f1 : 0.6666383998734611, stroma_f1 : 0.6004349419048854, infla_f1 : 0.2556238515036447, necr_f1 : 0.8512891190392631, other_f1 : 0.5213259543899247, acc_micro : 0.8512891190392631
[08:56:35.220] train iteration 3025 : loss : 0.906886, loss_ce: 1.275127
[08:56:55.248] train iteration 3075 : loss : 0.637537, loss_ce: 0.885431
[08:57:15.296] train iteration 3125 : loss : 0.837865, loss_ce: 1.238921
[08:57:26.713] val epoch 24 : f1_micro : 0.6125550695828029, f1_macro : 0.44249585270881653, tumor_f1 : 0.68608187351908, stroma_f1 : 0.5527804930295263, infla_f1 : 0.170137596981866, necr_f1 : 0.8450481210436139, other_f1 : 0.5177649770464215, acc_micro : 0.8450481210436139
[08:57:28.172] train iteration 3151 : loss : 0.767624, loss_ce: 1.128670
[08:57:48.157] train iteration 3201 : loss : 0.541331, loss_ce: 0.852616
[08:58:08.290] train iteration 3251 : loss : 0.567494, loss_ce: 0.836113
[08:58:19.782] val epoch 25 : f1_micro : 0.6430357439177377, f1_macro : 0.5608208562646594, tumor_f1 : 0.7221246319157737, stroma_f1 : 0.5743086934089661, infla_f1 : 0.5591196119785309, necr_f1 : 0.857214799949101, other_f1 : 0.5156631219599929, acc_micro : 0.857214799949101
[08:58:21.232] train iteration 3277 : loss : 0.541207, loss_ce: 0.687511
[08:58:41.092] train iteration 3327 : loss : 0.656471, loss_ce: 0.889305
[08:59:01.173] train iteration 3377 : loss : 0.687368, loss_ce: 0.878080
[08:59:12.824] val epoch 26 : f1_micro : 0.6388510508196694, f1_macro : 0.44679127420697895, tumor_f1 : 0.7189089485577175, stroma_f1 : 0.5612716951540538, infla_f1 : 0.27190448130880085, necr_f1 : 0.8555588637079511, other_f1 : 0.5337219829005855, acc_micro : 0.8555588637079511
[08:59:14.402] train iteration 3403 : loss : 0.630382, loss_ce: 0.846700
[08:59:34.228] train iteration 3453 : loss : 0.554021, loss_ce: 0.761872
[08:59:54.370] train iteration 3503 : loss : 0.677891, loss_ce: 0.984303
[09:00:05.792] val epoch 27 : f1_micro : 0.6147728817803519, f1_macro : 0.5023547283240727, tumor_f1 : 0.6888162067958287, stroma_f1 : 0.5723769026143211, infla_f1 : 0.3909261264987955, necr_f1 : 0.8459299717630658, other_f1 : 0.5399393567017147, acc_micro : 0.8459299717630658
[09:00:07.266] train iteration 3529 : loss : 0.580936, loss_ce: 0.664695
[09:00:27.192] train iteration 3579 : loss : 0.561980, loss_ce: 0.784176
[09:00:47.316] train iteration 3629 : loss : 0.728265, loss_ce: 0.907621
[09:00:58.803] val epoch 28 : f1_micro : 0.639223039150238, f1_macro : 0.42877652389662607, tumor_f1 : 0.7088633094515119, stroma_f1 : 0.5957836253302438, infla_f1 : 0.3125391517366682, necr_f1 : 0.8557224103382656, other_f1 : 0.5266965904406139, acc_micro : 0.8557224103382656
[09:01:00.259] train iteration 3655 : loss : 0.458804, loss_ce: 0.661290
[09:01:20.206] train iteration 3705 : loss : 0.788186, loss_ce: 1.138649
[09:01:40.374] train iteration 3755 : loss : 0.641199, loss_ce: 0.763379
[09:01:51.754] val epoch 29 : f1_micro : 0.6436472109385899, f1_macro : 0.5424504450389317, tumor_f1 : 0.7257930551256452, stroma_f1 : 0.5839771543230329, infla_f1 : 0.2986635948930468, necr_f1 : 0.8574836679867336, other_f1 : 0.5316643491387367, acc_micro : 0.8574836679867336
[09:01:53.224] train iteration 3781 : loss : 0.459703, loss_ce: 0.642756
[09:02:13.318] train iteration 3831 : loss : 0.616664, loss_ce: 0.846886
[09:02:33.436] train iteration 3881 : loss : 0.636073, loss_ce: 0.796312
[09:02:44.735] val epoch 30 : f1_micro : 0.627994213785444, f1_macro : 0.485495252268655, tumor_f1 : 0.705462566443852, stroma_f1 : 0.5726075364010674, infla_f1 : 0.3112294719155346, necr_f1 : 0.8512300423213414, other_f1 : 0.5476134036268506, acc_micro : 0.8512300423213414
[09:02:46.240] train iteration 3907 : loss : 0.588414, loss_ce: 0.869060
[09:03:06.305] train iteration 3957 : loss : 0.481974, loss_ce: 0.768652
[09:03:26.415] train iteration 4007 : loss : 0.458235, loss_ce: 0.626109
[09:03:37.942] val epoch 31 : f1_micro : 0.6261126271315983, f1_macro : 0.4249752334186009, tumor_f1 : 0.728971574987684, stroma_f1 : 0.5471322579043252, infla_f1 : 0.29722478134291513, necr_f1 : 0.8505049858774457, other_f1 : 0.5221947245299816, acc_micro : 0.8505049858774457
[09:03:39.380] train iteration 4033 : loss : 0.697125, loss_ce: 0.978467
[09:03:59.314] train iteration 4083 : loss : 0.594895, loss_ce: 0.893293
[09:04:19.372] train iteration 4133 : loss : 0.550275, loss_ce: 0.730293
[09:04:30.835] val epoch 32 : f1_micro : 0.645441825900759, f1_macro : 0.533700338431767, tumor_f1 : 0.7275416254997253, stroma_f1 : 0.5760481825896672, infla_f1 : 0.24693145815815246, necr_f1 : 0.8581916349274772, other_f1 : 0.5465518342597144, acc_micro : 0.8581916349274772
[09:04:32.329] train iteration 4159 : loss : 0.564802, loss_ce: 0.802807
[09:04:52.337] train iteration 4209 : loss : 0.612917, loss_ce: 0.883606
[09:05:12.472] train iteration 4259 : loss : 0.497817, loss_ce: 0.773961
[09:05:23.851] val epoch 33 : f1_micro : 0.638225930077689, f1_macro : 0.4655124843120575, tumor_f1 : 0.7041805940014976, stroma_f1 : 0.5840004490954536, infla_f1 : 0.20848118513822556, necr_f1 : 0.8553177033151899, other_f1 : 0.5385625085660389, acc_micro : 0.8553177033151899
[09:05:25.371] train iteration 4285 : loss : 0.634632, loss_ce: 0.724604
[09:05:45.271] train iteration 4335 : loss : 0.629898, loss_ce: 0.836343
[09:06:05.482] train iteration 4385 : loss : 0.626215, loss_ce: 0.882503
[09:06:16.919] val epoch 34 : f1_micro : 0.6497439401490348, f1_macro : 0.5386109820434025, tumor_f1 : 0.7263806973184858, stroma_f1 : 0.5861917414835521, infla_f1 : 0.2718778039727892, necr_f1 : 0.8599189860480172, other_f1 : 0.5371761077216693, acc_micro : 0.8599189860480172
[09:06:18.401] train iteration 4411 : loss : 0.472239, loss_ce: 0.707797
[09:06:38.396] train iteration 4461 : loss : 0.739552, loss_ce: 0.982218
[09:06:58.637] train iteration 4511 : loss : 0.685683, loss_ce: 0.832359
[09:07:09.952] val epoch 35 : f1_micro : 0.6512366831302643, f1_macro : 0.5639574740614209, tumor_f1 : 0.7400657449449811, stroma_f1 : 0.5722690692969731, infla_f1 : 0.39886300904410227, necr_f1 : 0.8605096595627921, other_f1 : 0.5371609654809747, acc_micro : 0.8605096595627921
[09:07:11.418] train iteration 4537 : loss : 0.491519, loss_ce: 0.724482
[09:07:31.370] train iteration 4587 : loss : 0.850893, loss_ce: 1.284929
[09:07:51.651] train iteration 4637 : loss : 0.859714, loss_ce: 1.170353
[09:08:03.121] val epoch 36 : f1_micro : 0.6534796357154846, f1_macro : 0.4860247458730425, tumor_f1 : 0.736395503793444, stroma_f1 : 0.5844218858650753, infla_f1 : 0.4241159089973995, necr_f1 : 0.8614446520805359, other_f1 : 0.5237589654113565, acc_micro : 0.8614446520805359
[09:08:04.592] train iteration 4663 : loss : 0.638185, loss_ce: 0.878397
[09:08:24.439] train iteration 4713 : loss : 0.801230, loss_ce: 1.187621
[09:08:44.740] train iteration 4763 : loss : 0.628448, loss_ce: 0.799544
[09:08:56.219] val epoch 37 : f1_micro : 0.6525887591498238, f1_macro : 0.4502613842487335, tumor_f1 : 0.7318427392414638, stroma_f1 : 0.5798922543014798, infla_f1 : 0.28448450565338135, necr_f1 : 0.8610915797097343, other_f1 : 0.5122302968853286, acc_micro : 0.8610915797097343
[09:08:57.696] train iteration 4789 : loss : 0.595038, loss_ce: 0.839362
[09:09:17.623] train iteration 4839 : loss : 0.594172, loss_ce: 0.851601
[09:09:37.895] train iteration 4889 : loss : 0.541106, loss_ce: 0.757778
[09:09:49.447] val epoch 38 : f1_micro : 0.6012870115893227, f1_macro : 0.4587639272212982, tumor_f1 : 0.6772843173571995, stroma_f1 : 0.5485120500837054, infla_f1 : 0.23326281484748637, necr_f1 : 0.8405432530811855, other_f1 : 0.5414386689662933, acc_micro : 0.8405432530811855
[09:09:50.986] train iteration 4915 : loss : 0.591088, loss_ce: 0.703118
[09:10:10.785] train iteration 4965 : loss : 0.492023, loss_ce: 0.706147
[09:10:31.020] train iteration 5015 : loss : 0.625015, loss_ce: 0.633889
[09:10:42.510] val epoch 39 : f1_micro : 0.6327222500528608, f1_macro : 0.4976259853158678, tumor_f1 : 0.7210841689790998, stroma_f1 : 0.5601555215460914, infla_f1 : 0.35140346815543516, necr_f1 : 0.8531055450439453, other_f1 : 0.5394478269985744, acc_micro : 0.8531055450439453
[09:10:44.054] train iteration 5041 : loss : 0.587280, loss_ce: 0.860133
[09:11:04.105] train iteration 5091 : loss : 0.632938, loss_ce: 0.799680
[09:11:24.328] train iteration 5141 : loss : 0.621920, loss_ce: 0.873569
[09:11:35.632] val epoch 40 : f1_micro : 0.6590205686432975, f1_macro : 0.55015914780753, tumor_f1 : 0.741386068718774, stroma_f1 : 0.5933620929718018, infla_f1 : 0.4622372303690229, necr_f1 : 0.8636490532330104, other_f1 : 0.5252389088273048, acc_micro : 0.8636490532330104
[09:11:37.107] train iteration 5167 : loss : 0.558404, loss_ce: 0.703248
[09:11:57.016] train iteration 5217 : loss : 0.683492, loss_ce: 0.898249
[09:12:17.256] train iteration 5267 : loss : 0.601353, loss_ce: 0.790008
[09:12:28.667] val epoch 41 : f1_micro : 0.6418494326727731, f1_macro : 0.561501681804657, tumor_f1 : 0.7299657080854688, stroma_f1 : 0.5542784971850259, infla_f1 : 0.4234473151820047, necr_f1 : 0.856784999370575, other_f1 : 0.5283883512020111, acc_micro : 0.856784999370575
[09:12:30.125] train iteration 5293 : loss : 0.700694, loss_ce: 0.943295
[09:12:50.069] train iteration 5343 : loss : 0.626383, loss_ce: 0.835579
[09:13:10.213] train iteration 5393 : loss : 0.425098, loss_ce: 0.675506
[09:13:21.667] val epoch 42 : f1_micro : 0.6415756515094212, f1_macro : 0.5322236163275582, tumor_f1 : 0.7252181427819389, stroma_f1 : 0.5714866838284901, infla_f1 : 0.5209722284759793, necr_f1 : 0.8566552741186959, other_f1 : 0.5347187710659844, acc_micro : 0.8566552741186959
[09:13:23.162] train iteration 5419 : loss : 0.560444, loss_ce: 0.597054
[09:13:43.060] train iteration 5469 : loss : 0.368912, loss_ce: 0.479783
[09:14:03.178] train iteration 5519 : loss : 0.539741, loss_ce: 0.750419
[09:14:14.703] val epoch 43 : f1_micro : 0.6510442069598606, f1_macro : 0.5224100691931588, tumor_f1 : 0.7230796643665859, stroma_f1 : 0.6064075934035438, infla_f1 : 0.3454934699194772, necr_f1 : 0.8604707717895508, other_f1 : 0.5084982344082424, acc_micro : 0.8604707717895508
[09:14:16.115] train iteration 5545 : loss : 0.628089, loss_ce: 0.852410
[09:14:36.159] train iteration 5595 : loss : 0.610609, loss_ce: 0.811854
[09:14:56.198] train iteration 5645 : loss : 0.448624, loss_ce: 0.676601
[09:15:07.610] val epoch 44 : f1_micro : 0.6416521412985665, f1_macro : 0.48881067974226816, tumor_f1 : 0.710959894316537, stroma_f1 : 0.5922028720378876, infla_f1 : 0.3276290254933493, necr_f1 : 0.8567286048616681, other_f1 : 0.5213648953608104, acc_micro : 0.8567286048616681
[09:15:09.123] train iteration 5671 : loss : 0.520003, loss_ce: 0.717250
[09:15:29.182] train iteration 5721 : loss : 0.272448, loss_ce: 0.404827
[09:15:49.485] train iteration 5771 : loss : 0.699791, loss_ce: 1.049937
[09:16:00.831] val epoch 45 : f1_micro : 0.6433210628373283, f1_macro : 0.5511714007173266, tumor_f1 : 0.7045676282473973, stroma_f1 : 0.606561039175306, infla_f1 : 0.34708347277981894, necr_f1 : 0.8573723605700901, other_f1 : 0.5262162823762212, acc_micro : 0.8573723605700901
[09:16:02.286] train iteration 5797 : loss : 0.596891, loss_ce: 0.638026
[09:16:22.334] train iteration 5847 : loss : 0.524979, loss_ce: 0.724903
[09:16:42.331] train iteration 5897 : loss : 0.662757, loss_ce: 0.891216
[09:16:53.903] val epoch 46 : f1_micro : 0.6592977728162494, f1_macro : 0.4688091831547873, tumor_f1 : 0.7288017102650234, stroma_f1 : 0.617282509803772, infla_f1 : 0.306494089109557, necr_f1 : 0.8637650523866925, other_f1 : 0.5166472622326442, acc_micro : 0.8637650523866925
[09:16:55.402] train iteration 5923 : loss : 0.769611, loss_ce: 1.067682
[09:17:15.296] train iteration 5973 : loss : 0.591258, loss_ce: 0.796689
[09:17:35.554] train iteration 6023 : loss : 0.596538, loss_ce: 0.855617
[09:17:47.122] val epoch 47 : f1_micro : 0.6194453026567187, f1_macro : 0.5034010367734092, tumor_f1 : 0.6981546069894519, stroma_f1 : 0.5585696537579808, infla_f1 : 0.2918125911216651, necr_f1 : 0.8478153773716518, other_f1 : 0.5341473338859422, acc_micro : 0.8478153773716518
[09:17:48.622] train iteration 6049 : loss : 0.545815, loss_ce: 0.681097
[09:18:08.509] train iteration 6099 : loss : 0.651419, loss_ce: 0.896218
[09:18:28.765] train iteration 6149 : loss : 0.792885, loss_ce: 0.954676
[09:18:40.179] val epoch 48 : f1_micro : 0.6508758238383702, f1_macro : 0.4949197471141815, tumor_f1 : 0.7227785161563328, stroma_f1 : 0.586900566305433, infla_f1 : 0.3344260496752603, necr_f1 : 0.8603653567177909, other_f1 : 0.5444544809205192, acc_micro : 0.8603653567177909
[09:18:41.693] train iteration 6175 : loss : 0.637521, loss_ce: 0.932907
[09:19:01.595] train iteration 6225 : loss : 0.657391, loss_ce: 1.002081
[09:19:21.856] train iteration 6275 : loss : 0.615696, loss_ce: 0.712449
[09:19:33.363] val epoch 49 : f1_micro : 0.6690532565116882, f1_macro : 0.5454752785818917, tumor_f1 : 0.7159685577665057, stroma_f1 : 0.6487626390797752, infla_f1 : 0.3994572354214532, necr_f1 : 0.8676513688904899, other_f1 : 0.5297676181154591, acc_micro : 0.8676513688904899
[09:19:34.843] train iteration 6301 : loss : 0.521574, loss_ce: 0.636115
[09:19:54.790] train iteration 6351 : loss : 0.613020, loss_ce: 0.902277
[09:20:15.089] train iteration 6401 : loss : 0.486475, loss_ce: 0.627266
[09:20:26.558] val epoch 50 : f1_micro : 0.6376125471932548, f1_macro : 0.5175098180770874, tumor_f1 : 0.7124920061656407, stroma_f1 : 0.591557400567191, infla_f1 : 0.462943741617242, necr_f1 : 0.855057452406202, other_f1 : 0.5299925931862423, acc_micro : 0.855057452406202
[09:20:28.076] train iteration 6427 : loss : 0.529904, loss_ce: 0.710412
[09:20:48.054] train iteration 6477 : loss : 0.519067, loss_ce: 0.573496
[09:21:08.247] train iteration 6527 : loss : 0.669463, loss_ce: 0.874436
[09:21:19.712] val epoch 51 : f1_micro : 0.6584502373422895, f1_macro : 0.5255389426435743, tumor_f1 : 0.7161605443273272, stroma_f1 : 0.6392439007759094, infla_f1 : 0.46384816084589275, necr_f1 : 0.8633980665888105, other_f1 : 0.5227277779153415, acc_micro : 0.8633980665888105
[09:21:21.196] train iteration 6553 : loss : 0.493597, loss_ce: 0.612443
[09:21:41.154] train iteration 6603 : loss : 0.444735, loss_ce: 0.663092
[09:22:01.420] train iteration 6653 : loss : 0.507183, loss_ce: 0.561662
[09:22:12.892] val epoch 52 : f1_micro : 0.6613141553742545, f1_macro : 0.522035824401038, tumor_f1 : 0.6990657363619123, stroma_f1 : 0.6498154657227653, infla_f1 : 0.4577022876058306, necr_f1 : 0.8645457199641636, other_f1 : 0.5178813029612813, acc_micro : 0.8645457199641636
[09:22:14.389] train iteration 6679 : loss : 0.707285, loss_ce: 0.825287
[09:22:34.428] train iteration 6729 : loss : 0.605605, loss_ce: 0.812621
[09:22:54.668] train iteration 6779 : loss : 0.635015, loss_ce: 0.876255
[09:23:06.129] val epoch 53 : f1_micro : 0.6650463172367641, f1_macro : 0.5096081793308258, tumor_f1 : 0.7362913915089199, stroma_f1 : 0.6206779990877423, infla_f1 : 0.38316487414496286, necr_f1 : 0.8660370196614947, other_f1 : 0.5221923215389584, acc_micro : 0.8660370196614947
[09:23:07.566] train iteration 6805 : loss : 0.567343, loss_ce: 0.720066
[09:23:27.547] train iteration 6855 : loss : 0.689583, loss_ce: 0.941652
[09:23:47.825] train iteration 6905 : loss : 0.437545, loss_ce: 0.535898
[09:23:59.241] val epoch 54 : f1_micro : 0.6425215091024127, f1_macro : 0.49512335658073425, tumor_f1 : 0.7238616517611912, stroma_f1 : 0.6029524377414158, infla_f1 : 0.3186681142875126, necr_f1 : 0.8570565581321716, other_f1 : 0.5433385276368686, acc_micro : 0.8570565581321716
[09:24:00.793] train iteration 6931 : loss : 0.519603, loss_ce: 0.582400
[09:24:20.786] train iteration 6981 : loss : 0.500090, loss_ce: 0.638293
[09:24:40.974] train iteration 7031 : loss : 0.520346, loss_ce: 0.637738
[09:24:52.349] val epoch 55 : f1_micro : 0.6641234500067574, f1_macro : 0.5114910006523132, tumor_f1 : 0.7330331972667149, stroma_f1 : 0.6268607250281742, infla_f1 : 0.3753153660467693, necr_f1 : 0.8656789064407349, other_f1 : 0.5316824199897903, acc_micro : 0.8656789064407349
[09:24:53.766] train iteration 7057 : loss : 0.742103, loss_ce: 0.990947
[09:25:13.736] train iteration 7107 : loss : 0.532768, loss_ce: 0.583125
[09:25:33.881] train iteration 7157 : loss : 0.771640, loss_ce: 1.010611
[09:25:45.310] val epoch 56 : f1_micro : 0.6758514046669006, f1_macro : 0.5703151992389134, tumor_f1 : 0.7503042646816799, stroma_f1 : 0.6278907230922154, infla_f1 : 0.606497796518462, necr_f1 : 0.8703873753547668, other_f1 : 0.53633981144854, acc_micro : 0.8703873753547668
[09:25:46.792] train iteration 7183 : loss : 0.610277, loss_ce: 0.860483
[09:26:06.782] train iteration 7233 : loss : 0.532951, loss_ce: 0.608330
[09:26:26.991] train iteration 7283 : loss : 0.501649, loss_ce: 0.592137
[09:26:38.460] val epoch 57 : f1_micro : 0.6660005705697196, f1_macro : 0.5264195799827576, tumor_f1 : 0.7027842700481415, stroma_f1 : 0.6462185893739972, infla_f1 : 0.317774840763637, necr_f1 : 0.8664321984563556, other_f1 : 0.5268213631851333, acc_micro : 0.8664321984563556
[09:26:39.953] train iteration 7309 : loss : 0.569653, loss_ce: 0.767028
[09:26:59.904] train iteration 7359 : loss : 0.586460, loss_ce: 0.667270
[09:27:20.097] train iteration 7409 : loss : 0.548651, loss_ce: 0.624700
[09:27:31.487] val epoch 58 : f1_micro : 0.6824652552604675, f1_macro : 0.5059719724314553, tumor_f1 : 0.7352909445762634, stroma_f1 : 0.664690124137061, infla_f1 : 0.4134434105030128, necr_f1 : 0.8730327827589852, other_f1 : 0.5333924846989768, acc_micro : 0.8730327827589852
[09:27:32.977] train iteration 7435 : loss : 0.664152, loss_ce: 0.945993
[09:27:52.891] train iteration 7485 : loss : 0.792950, loss_ce: 1.098994
[09:28:13.075] train iteration 7535 : loss : 0.729713, loss_ce: 1.095979
[09:28:24.587] val epoch 59 : f1_micro : 0.6695230177470616, f1_macro : 0.5382144749164581, tumor_f1 : 0.7400544243199485, stroma_f1 : 0.6309324886117663, infla_f1 : 0.3450834367956434, necr_f1 : 0.8678530369486127, other_f1 : 0.5414421760610172, acc_micro : 0.8678530369486127
[09:28:26.084] train iteration 7561 : loss : 0.608256, loss_ce: 0.927071
[09:28:45.956] train iteration 7611 : loss : 0.455345, loss_ce: 0.494783
[09:29:06.166] train iteration 7661 : loss : 0.731234, loss_ce: 1.042403
[09:29:17.576] val epoch 60 : f1_micro : 0.6735489623887199, f1_macro : 0.5336139585290637, tumor_f1 : 0.7400049226624625, stroma_f1 : 0.6346264779567719, infla_f1 : 0.3273554614612034, necr_f1 : 0.869452314717429, other_f1 : 0.5241514412420136, acc_micro : 0.869452314717429
[09:29:19.060] train iteration 7687 : loss : 0.641417, loss_ce: 0.772599
[09:29:39.043] train iteration 7737 : loss : 0.568263, loss_ce: 0.653388
[09:29:59.187] train iteration 7787 : loss : 0.590882, loss_ce: 0.779175
[09:30:10.489] val epoch 61 : f1_micro : 0.6380934885569981, f1_macro : 0.5457235830170768, tumor_f1 : 0.7063080413000924, stroma_f1 : 0.5991859840495246, infla_f1 : 0.32362391693251474, necr_f1 : 0.8552461181368146, other_f1 : 0.5280713545424598, acc_micro : 0.8552461181368146
[09:30:11.983] train iteration 7813 : loss : 0.625288, loss_ce: 0.878478
[09:30:31.997] train iteration 7863 : loss : 0.470618, loss_ce: 0.670205
[09:30:52.093] train iteration 7913 : loss : 0.619920, loss_ce: 0.913372
[09:31:03.469] val epoch 62 : f1_micro : 0.6251508934157235, f1_macro : 0.47205877729824613, tumor_f1 : 0.6925532008920398, stroma_f1 : 0.5834777482918331, infla_f1 : 0.2603061135326113, necr_f1 : 0.8500860674040658, other_f1 : 0.525075304721083, acc_micro : 0.8500860674040658
[09:31:04.936] train iteration 7939 : loss : 0.718180, loss_ce: 0.966065
[09:31:24.828] train iteration 7989 : loss : 0.590477, loss_ce: 0.823120
[09:31:44.931] train iteration 8039 : loss : 0.601643, loss_ce: 0.841187
[09:31:56.429] val epoch 63 : f1_micro : 0.651275634765625, f1_macro : 0.5281037219933101, tumor_f1 : 0.7062362091881889, stroma_f1 : 0.6179860830307007, infla_f1 : 0.34127349512917654, necr_f1 : 0.8605302827698844, other_f1 : 0.5396301427057811, acc_micro : 0.8605302827698844
[09:31:57.909] train iteration 8065 : loss : 0.730442, loss_ce: 0.931481
[09:32:17.840] train iteration 8115 : loss : 0.588291, loss_ce: 0.745450
[09:32:38.071] train iteration 8165 : loss : 0.681665, loss_ce: 0.917968
[09:32:49.420] val epoch 64 : f1_micro : 0.667307836668832, f1_macro : 0.5272921877247947, tumor_f1 : 0.7268223336764744, stroma_f1 : 0.6277255245617458, infla_f1 : 0.4497711147580828, necr_f1 : 0.866973740713937, other_f1 : 0.5392360389232635, acc_micro : 0.866973740713937
[09:32:50.864] train iteration 8191 : loss : 0.726721, loss_ce: 1.097571
[09:33:10.772] train iteration 8241 : loss : 0.480345, loss_ce: 0.643543
[09:33:31.097] train iteration 8291 : loss : 0.528438, loss_ce: 0.744126
[09:33:42.447] val epoch 65 : f1_micro : 0.658514107976641, f1_macro : 0.5646995987210955, tumor_f1 : 0.7239383629390171, stroma_f1 : 0.6200268566608429, infla_f1 : 0.38262752975736347, necr_f1 : 0.8634180085999625, other_f1 : 0.525271298629897, acc_micro : 0.8634180085999625
[09:33:43.953] train iteration 8317 : loss : 0.569788, loss_ce: 0.781045
[09:34:03.795] train iteration 8367 : loss : 0.763463, loss_ce: 1.018338
[09:34:24.097] train iteration 8417 : loss : 0.392302, loss_ce: 0.490453
[09:34:35.444] val epoch 66 : f1_micro : 0.6670749528067452, f1_macro : 0.5434332958289555, tumor_f1 : 0.7286192774772644, stroma_f1 : 0.6302593009812492, infla_f1 : 0.5459907352924347, necr_f1 : 0.8668672953333173, other_f1 : 0.5231884036745343, acc_micro : 0.8668672953333173
[09:34:37.025] train iteration 8443 : loss : 0.583401, loss_ce: 0.836163
[09:34:56.881] train iteration 8493 : loss : 0.629065, loss_ce: 0.787739
[09:35:17.133] train iteration 8543 : loss : 0.660740, loss_ce: 0.862275
[09:35:28.482] val epoch 67 : f1_micro : 0.6720948474747794, f1_macro : 0.5737663337162563, tumor_f1 : 0.7377562778336662, stroma_f1 : 0.6395928093365261, infla_f1 : 0.3960423937865666, necr_f1 : 0.8688558340072632, other_f1 : 0.5240116640925407, acc_micro : 0.8688558340072632
[09:35:30.018] train iteration 8569 : loss : 0.518941, loss_ce: 0.647529
[09:35:49.884] train iteration 8619 : loss : 0.602160, loss_ce: 0.849972
[09:36:10.211] train iteration 8669 : loss : 0.753832, loss_ce: 1.184123
[09:36:21.532] val epoch 68 : f1_micro : 0.6633275491850716, f1_macro : 0.5219517222472599, tumor_f1 : 0.7301110369818551, stroma_f1 : 0.6035155228206089, infla_f1 : 0.43315382514681133, necr_f1 : 0.8653527838843209, other_f1 : 0.5339457887623992, acc_micro : 0.8653527838843209
[09:36:23.037] train iteration 8695 : loss : 0.555933, loss_ce: 0.724214
[09:36:43.013] train iteration 8745 : loss : 0.591176, loss_ce: 0.842170
[09:37:03.258] train iteration 8795 : loss : 0.583963, loss_ce: 0.893689
[09:37:14.626] val epoch 69 : f1_micro : 0.6437383890151978, f1_macro : 0.5309890678950718, tumor_f1 : 0.7135967867715018, stroma_f1 : 0.6212313175201416, infla_f1 : 0.33343712493868743, necr_f1 : 0.8575130190168109, other_f1 : 0.5329431593418121, acc_micro : 0.8575130190168109
[09:37:16.176] train iteration 8821 : loss : 0.702785, loss_ce: 0.947595
[09:37:36.064] train iteration 8871 : loss : 0.585028, loss_ce: 0.783424
[09:37:56.275] train iteration 8921 : loss : 0.509990, loss_ce: 0.698431
[09:38:07.688] val epoch 70 : f1_micro : 0.6802359223365784, f1_macro : 0.5119974655764443, tumor_f1 : 0.7548486547810691, stroma_f1 : 0.637378317969186, infla_f1 : 0.3369449632508414, necr_f1 : 0.8721178770065308, other_f1 : 0.5365372715251786, acc_micro : 0.8721178770065308
[09:38:09.207] train iteration 8947 : loss : 0.671475, loss_ce: 0.849665
[09:38:29.194] train iteration 8997 : loss : 0.675199, loss_ce: 0.907088
[09:38:49.320] train iteration 9047 : loss : 0.454312, loss_ce: 0.613179
[09:39:00.902] val epoch 71 : f1_micro : 0.6843354787145343, f1_macro : 0.5670050978660583, tumor_f1 : 0.7327743342944554, stroma_f1 : 0.6597908054079328, infla_f1 : 0.46370171649115427, necr_f1 : 0.873774698802403, other_f1 : 0.5450084166867393, acc_micro : 0.873774698802403
[09:39:02.446] train iteration 9073 : loss : 0.665630, loss_ce: 0.749716
[09:39:22.359] train iteration 9123 : loss : 0.613168, loss_ce: 0.987541
[09:39:42.540] train iteration 9173 : loss : 0.541402, loss_ce: 0.604746
[09:39:53.934] val epoch 72 : f1_micro : 0.6633040990148272, f1_macro : 0.5155667109148843, tumor_f1 : 0.7296616392476218, stroma_f1 : 0.6196640857628414, infla_f1 : 0.3992109170981816, necr_f1 : 0.865347853728703, other_f1 : 0.5277897247246334, acc_micro : 0.865347853728703
[09:39:55.379] train iteration 9199 : loss : 0.582667, loss_ce: 0.830455
[09:40:15.264] train iteration 9249 : loss : 0.622712, loss_ce: 0.789266
[09:40:35.426] train iteration 9299 : loss : 0.547306, loss_ce: 0.693148
[09:40:47.022] val epoch 73 : f1_micro : 0.677102770124163, f1_macro : 0.5202080437115261, tumor_f1 : 0.7077000864914486, stroma_f1 : 0.6565952386174884, infla_f1 : 0.3584967425891331, necr_f1 : 0.8708726678575788, other_f1 : 0.5418187975883484, acc_micro : 0.8708726678575788
[09:40:48.523] train iteration 9325 : loss : 0.539646, loss_ce: 0.739985
[09:41:08.364] train iteration 9375 : loss : 0.573572, loss_ce: 0.748521
[09:41:28.452] train iteration 9425 : loss : 0.645318, loss_ce: 0.982838
[09:41:39.840] val epoch 74 : f1_micro : 0.6451201694352287, f1_macro : 0.5070395299366542, tumor_f1 : 0.7071125507354736, stroma_f1 : 0.6071992665529251, infla_f1 : 0.4012123165718679, necr_f1 : 0.8580717103821891, other_f1 : 0.5339592418500355, acc_micro : 0.8580717103821891
[09:41:41.308] train iteration 9451 : loss : 0.651454, loss_ce: 0.751465
[09:42:01.332] train iteration 9501 : loss : 0.655952, loss_ce: 0.789250
[09:42:21.531] train iteration 9551 : loss : 0.373171, loss_ce: 0.477008
[09:42:32.926] val epoch 75 : f1_micro : 0.6437228918075562, f1_macro : 0.5513385917459216, tumor_f1 : 0.7128139776842934, stroma_f1 : 0.5972992054053715, infla_f1 : 0.3351313370679106, necr_f1 : 0.8575113671166557, other_f1 : 0.5400199027998107, acc_micro : 0.8575113671166557
[09:42:34.451] train iteration 9577 : loss : 0.468873, loss_ce: 0.537293
[09:42:54.394] train iteration 9627 : loss : 0.701181, loss_ce: 0.860326
[09:43:14.536] train iteration 9677 : loss : 0.585667, loss_ce: 0.757021
[09:43:25.862] val epoch 76 : f1_micro : 0.664683290890285, f1_macro : 0.571771787745612, tumor_f1 : 0.7172060608863831, stroma_f1 : 0.6348076505320412, infla_f1 : 0.4036969925676073, necr_f1 : 0.8659203904015678, other_f1 : 0.5317196271249226, acc_micro : 0.8659203904015678
[09:43:27.342] train iteration 9703 : loss : 0.586474, loss_ce: 0.830678
[09:43:47.330] train iteration 9753 : loss : 0.502028, loss_ce: 0.770712
[09:44:07.509] train iteration 9803 : loss : 0.611671, loss_ce: 0.911082
[09:44:18.788] val epoch 77 : f1_micro : 0.6714217492512294, f1_macro : 0.5269597470760345, tumor_f1 : 0.7359359519822257, stroma_f1 : 0.6450404950550624, infla_f1 : 0.29835789118494305, necr_f1 : 0.8686063459941319, other_f1 : 0.5245993541819709, acc_micro : 0.8686063459941319
[09:44:20.262] train iteration 9829 : loss : 0.545366, loss_ce: 0.829108
[09:44:40.153] train iteration 9879 : loss : 0.581568, loss_ce: 0.789693
[09:45:00.424] train iteration 9929 : loss : 0.534763, loss_ce: 0.702067
[09:45:11.917] val epoch 78 : f1_micro : 0.6463784916060311, f1_macro : 0.49343450154576984, tumor_f1 : 0.7184070433889117, stroma_f1 : 0.604079761675426, infla_f1 : 0.33020107900457724, necr_f1 : 0.8585742541721889, other_f1 : 0.5256547800132206, acc_micro : 0.8585742541721889
[09:45:13.435] train iteration 9955 : loss : 0.535536, loss_ce: 0.576365
[09:45:33.247] train iteration 10005 : loss : 0.560013, loss_ce: 0.781724
[09:45:53.527] train iteration 10055 : loss : 0.534112, loss_ce: 0.665118
[09:46:04.864] val epoch 79 : f1_micro : 0.6850094624928066, f1_macro : 0.5574489533901215, tumor_f1 : 0.7337570105280194, stroma_f1 : 0.667520501783916, infla_f1 : 0.41481432744434904, necr_f1 : 0.8740319524492536, other_f1 : 0.5417958375598703, acc_micro : 0.8740319524492536
[09:46:06.339] train iteration 10081 : loss : 0.482220, loss_ce: 0.467332
[09:46:26.294] train iteration 10131 : loss : 0.582426, loss_ce: 0.760885
[09:46:46.524] train iteration 10181 : loss : 0.549425, loss_ce: 0.695996
[09:46:57.987] val epoch 80 : f1_micro : 0.6676988686834063, f1_macro : 0.5419532826968602, tumor_f1 : 0.7306856683322361, stroma_f1 : 0.636294003043856, infla_f1 : 0.3794860563107899, necr_f1 : 0.8671096222741264, other_f1 : 0.5347292880926814, acc_micro : 0.8671096222741264
[09:46:59.529] train iteration 10207 : loss : 0.726712, loss_ce: 0.921806
[09:47:19.440] train iteration 10257 : loss : 0.556521, loss_ce: 0.787593
[09:47:39.526] train iteration 10307 : loss : 0.562088, loss_ce: 0.652329
[09:47:50.938] val epoch 81 : f1_micro : 0.6043224632740021, f1_macro : 0.49816735301698956, tumor_f1 : 0.6785363938127246, stroma_f1 : 0.5599177745836121, infla_f1 : 0.29659396609557526, necr_f1 : 0.8417377557073321, other_f1 : 0.52721720295293, acc_micro : 0.8417377557073321
[09:47:52.496] train iteration 10333 : loss : 0.635993, loss_ce: 0.793679
[09:48:12.320] train iteration 10383 : loss : 0.363357, loss_ce: 0.488863
[09:48:32.550] train iteration 10433 : loss : 0.599383, loss_ce: 0.836764
[09:48:44.036] val epoch 82 : f1_micro : 0.6782843470573425, f1_macro : 0.551823364836829, tumor_f1 : 0.7358211960111346, stroma_f1 : 0.6430283273969378, infla_f1 : 0.2843057598386492, necr_f1 : 0.8713468994413104, other_f1 : 0.5245329801525388, acc_micro : 0.8713468994413104
[09:48:45.581] train iteration 10459 : loss : 0.540091, loss_ce: 0.709877
[09:49:05.546] train iteration 10509 : loss : 0.731013, loss_ce: 0.892948
[09:49:25.596] train iteration 10559 : loss : 0.574854, loss_ce: 0.812531
[09:49:37.068] val epoch 83 : f1_micro : 0.6564750330788749, f1_macro : 0.5152451651436942, tumor_f1 : 0.7218813300132751, stroma_f1 : 0.645005600793021, infla_f1 : 0.2464825330036027, necr_f1 : 0.8626155427524022, other_f1 : 0.5342849801693644, acc_micro : 0.8626155427524022
[09:49:38.523] train iteration 10585 : loss : 0.542412, loss_ce: 0.687018
[09:49:58.438] train iteration 10635 : loss : 0.666405, loss_ce: 0.902319
[09:50:18.674] train iteration 10685 : loss : 0.770549, loss_ce: 1.043838
[09:50:30.076] val epoch 84 : f1_micro : 0.6597374251910618, f1_macro : 0.5704859708036695, tumor_f1 : 0.7308793238231114, stroma_f1 : 0.5996225093092237, infla_f1 : 0.4033819245440619, necr_f1 : 0.8639333503586906, other_f1 : 0.5369859486818314, acc_micro : 0.8639333503586906
[09:50:31.503] train iteration 10711 : loss : 0.312184, loss_ce: 0.474484
[09:50:51.448] train iteration 10761 : loss : 0.385486, loss_ce: 0.527976
[09:51:11.600] train iteration 10811 : loss : 0.563664, loss_ce: 0.726742
[09:51:22.965] val epoch 85 : f1_micro : 0.6852758782250541, f1_macro : 0.5056378032479968, tumor_f1 : 0.7471638492175511, stroma_f1 : 0.6643790687833514, infla_f1 : 0.3040621251400028, necr_f1 : 0.8741329738071987, other_f1 : 0.5268695950508118, acc_micro : 0.8741329738071987
[09:51:24.458] train iteration 10837 : loss : 0.558482, loss_ce: 0.775216
[09:51:44.331] train iteration 10887 : loss : 0.506368, loss_ce: 0.665934
[09:52:04.384] train iteration 10937 : loss : 0.588455, loss_ce: 0.818389
[09:52:15.878] val epoch 86 : f1_micro : 0.6845410636493138, f1_macro : 0.5102663508483342, tumor_f1 : 0.749836129801614, stroma_f1 : 0.6549324180398669, infla_f1 : 0.31492861253874643, necr_f1 : 0.8738457390240261, other_f1 : 0.5355623114321914, acc_micro : 0.8738457390240261
[09:52:17.376] train iteration 10963 : loss : 0.436478, loss_ce: 0.570015
[09:52:37.414] train iteration 11013 : loss : 0.555940, loss_ce: 0.691658
[09:52:57.442] train iteration 11063 : loss : 0.486434, loss_ce: 0.622279
[09:53:08.804] val epoch 87 : f1_micro : 0.6823431168283735, f1_macro : 0.550143084355763, tumor_f1 : 0.7527799691472735, stroma_f1 : 0.6602992756026131, infla_f1 : 0.4785900350127901, necr_f1 : 0.8729576894215175, other_f1 : 0.5404439605772495, acc_micro : 0.8729576894215175
[09:53:10.330] train iteration 11089 : loss : 0.586914, loss_ce: 0.832905
[09:53:30.328] train iteration 11139 : loss : 0.624423, loss_ce: 0.868495
[09:53:50.436] train iteration 11189 : loss : 0.413122, loss_ce: 0.560183
[09:54:01.864] val epoch 88 : f1_micro : 0.6922745364052909, f1_macro : 0.5577950647899083, tumor_f1 : 0.7593048725809369, stroma_f1 : 0.6658312337739127, infla_f1 : 0.40905031136104036, necr_f1 : 0.8769355586596898, other_f1 : 0.5262174755334854, acc_micro : 0.8769355586596898
[09:54:03.395] train iteration 11215 : loss : 0.533772, loss_ce: 0.642730
[09:54:23.236] train iteration 11265 : loss : 0.464511, loss_ce: 0.664645
[09:54:43.470] train iteration 11315 : loss : 0.731935, loss_ce: 0.975564
[09:54:54.801] val epoch 89 : f1_micro : 0.6955445323671613, f1_macro : 0.5721582004002163, tumor_f1 : 0.7594079886163984, stroma_f1 : 0.6641848172460284, infla_f1 : 0.44116477242537905, necr_f1 : 0.8782394358089992, other_f1 : 0.5382627929959979, acc_micro : 0.8782394358089992
[09:54:56.342] train iteration 11341 : loss : 0.515575, loss_ce: 0.699007
[09:55:16.223] train iteration 11391 : loss : 0.508960, loss_ce: 0.667919
[09:55:36.463] train iteration 11441 : loss : 0.510644, loss_ce: 0.765328
[09:55:48.056] val epoch 90 : f1_micro : 0.6718862737928119, f1_macro : 0.47023148621831623, tumor_f1 : 0.7343750170298985, stroma_f1 : 0.6489904778344291, infla_f1 : 0.2813188105023333, necr_f1 : 0.8688011595181057, other_f1 : 0.5436160085456712, acc_micro : 0.8688011595181057
[09:55:49.532] train iteration 11467 : loss : 0.580339, loss_ce: 0.658706
[09:56:09.360] train iteration 11517 : loss : 0.577723, loss_ce: 0.823382
[09:56:29.435] train iteration 11567 : loss : 0.517867, loss_ce: 0.657525
[09:56:40.985] val epoch 91 : f1_micro : 0.679410287312099, f1_macro : 0.5782314709254673, tumor_f1 : 0.7462985856192452, stroma_f1 : 0.6464841110365731, infla_f1 : 0.39562367115701946, necr_f1 : 0.8717916267258781, other_f1 : 0.5313224105962685, acc_micro : 0.8717916267258781
[09:56:42.464] train iteration 11593 : loss : 0.477421, loss_ce: 0.560871
[09:57:02.484] train iteration 11643 : loss : 0.500712, loss_ce: 0.728522
[09:57:22.473] train iteration 11693 : loss : 0.482595, loss_ce: 0.620791
[09:57:34.042] val epoch 92 : f1_micro : 0.6883973394121442, f1_macro : 0.514576677765165, tumor_f1 : 0.75650007384164, stroma_f1 : 0.6432013767106193, infla_f1 : 0.3437791551862444, necr_f1 : 0.8753988742828369, other_f1 : 0.5374418864292758, acc_micro : 0.8753988742828369
[09:57:35.515] train iteration 11719 : loss : 0.446695, loss_ce: 0.509250
[09:57:55.504] train iteration 11769 : loss : 0.668616, loss_ce: 0.898620
[09:58:15.613] train iteration 11819 : loss : 0.548047, loss_ce: 0.778417
[09:58:27.025] val epoch 93 : f1_micro : 0.6620352608816964, f1_macro : 0.4968577580792563, tumor_f1 : 0.7263422182628086, stroma_f1 : 0.6335082181862423, infla_f1 : 0.3034541319523539, necr_f1 : 0.8648393154144287, other_f1 : 0.5351543149777821, acc_micro : 0.8648393154144287
[09:58:28.528] train iteration 11845 : loss : 0.474620, loss_ce: 0.571037
[09:58:48.438] train iteration 11895 : loss : 0.623749, loss_ce: 0.795673
[09:59:08.704] train iteration 11945 : loss : 0.523798, loss_ce: 0.792093
[09:59:19.987] val epoch 94 : f1_micro : 0.6581342773778098, f1_macro : 0.5589670964649746, tumor_f1 : 0.7286901814596993, stroma_f1 : 0.6193327903747559, infla_f1 : 0.3420532601220267, necr_f1 : 0.8632754002298627, other_f1 : 0.5333306789398193, acc_micro : 0.8632754002298627
[09:59:21.531] train iteration 11971 : loss : 0.634800, loss_ce: 0.795559
[09:59:41.506] train iteration 12021 : loss : 0.596924, loss_ce: 0.789028
[10:00:01.580] train iteration 12071 : loss : 0.639955, loss_ce: 0.894336
[10:00:12.906] val epoch 95 : f1_micro : 0.661176323890686, f1_macro : 0.505159501518522, tumor_f1 : 0.7247683916773114, stroma_f1 : 0.6606367230415344, infla_f1 : 0.182710542543126, necr_f1 : 0.8644902535847255, other_f1 : 0.5291104327355113, acc_micro : 0.8644902535847255
[10:00:14.439] train iteration 12097 : loss : 0.536496, loss_ce: 0.615069
[10:00:34.366] train iteration 12147 : loss : 0.541072, loss_ce: 0.744699
[10:00:54.597] train iteration 12197 : loss : 0.440752, loss_ce: 0.587286
[10:01:05.957] val epoch 96 : f1_micro : 0.7049984506198338, f1_macro : 0.5549243560859135, tumor_f1 : 0.7611230271203178, stroma_f1 : 0.6900611179215568, infla_f1 : 0.3631457046805216, necr_f1 : 0.882028443472726, other_f1 : 0.531720503100327, acc_micro : 0.882028443472726
[10:01:07.569] train iteration 12223 : loss : 0.493970, loss_ce: 0.593340
[10:01:27.444] train iteration 12273 : loss : 0.609411, loss_ce: 0.710306
[10:01:47.558] train iteration 12323 : loss : 0.491194, loss_ce: 0.785483
[10:01:59.156] val epoch 97 : f1_micro : 0.6797986371176583, f1_macro : 0.5062308950083596, tumor_f1 : 0.7175351296152387, stroma_f1 : 0.662319506917681, infla_f1 : 0.3321890277521951, necr_f1 : 0.8719428096498761, other_f1 : 0.5333965473941394, acc_micro : 0.8719428096498761
[10:02:00.660] train iteration 12349 : loss : 0.761112, loss_ce: 1.036174
[10:02:20.477] train iteration 12399 : loss : 0.309398, loss_ce: 0.479245
[10:02:40.810] train iteration 12449 : loss : 0.536312, loss_ce: 0.778576
[10:02:52.262] val epoch 98 : f1_micro : 0.6874960575784955, f1_macro : 0.4970143905707768, tumor_f1 : 0.7464792472975594, stroma_f1 : 0.6668268953050885, infla_f1 : 0.24612710092748916, necr_f1 : 0.8750246507780892, other_f1 : 0.5399245130164283, acc_micro : 0.8750246507780892
[10:02:53.746] train iteration 12475 : loss : 0.534084, loss_ce: 0.768481
[10:03:13.522] train iteration 12525 : loss : 0.481295, loss_ce: 0.522459
[10:03:33.761] train iteration 12575 : loss : 0.476022, loss_ce: 0.589567
[10:03:45.154] val epoch 99 : f1_micro : 0.6650808112961906, f1_macro : 0.5290443130901882, tumor_f1 : 0.7368343642779759, stroma_f1 : 0.6376718367849078, infla_f1 : 0.30506983692092554, necr_f1 : 0.8660588349614825, other_f1 : 0.5370741124664035, acc_micro : 0.8660588349614825
[10:03:46.046] save model to ./logs/frac_0.5/fold_4/epoch_99.pth
[10:03:47.589] train iteration 12601 : loss : 0.429956, loss_ce: 0.459494
[10:04:07.379] train iteration 12651 : loss : 0.564378, loss_ce: 0.732482
[10:04:27.511] train iteration 12701 : loss : 0.402465, loss_ce: 0.488803
[10:04:39.096] val epoch 100 : f1_micro : 0.6600693038531712, f1_macro : 0.5271626838615963, tumor_f1 : 0.7331077201025826, stroma_f1 : 0.6475603069577899, infla_f1 : 0.2615382176424776, necr_f1 : 0.8640487194061279, other_f1 : 0.5373517679316657, acc_micro : 0.8640487194061279
[10:04:40.536] train iteration 12727 : loss : 0.443964, loss_ce: 0.528091
[10:05:00.406] train iteration 12777 : loss : 0.593897, loss_ce: 0.791829
[10:05:20.506] train iteration 12827 : loss : 0.593046, loss_ce: 0.783629
[10:05:31.935] val epoch 101 : f1_micro : 0.663944695677076, f1_macro : 0.5225626443113599, tumor_f1 : 0.7256599536963871, stroma_f1 : 0.644526549748012, infla_f1 : 0.4296897841351373, necr_f1 : 0.8656103100095477, other_f1 : 0.5272226446707334, acc_micro : 0.8656103100095477
[10:05:33.410] train iteration 12853 : loss : 0.618455, loss_ce: 0.784358
[10:05:53.346] train iteration 12903 : loss : 0.533333, loss_ce: 0.727643
[10:06:13.497] train iteration 12953 : loss : 0.604365, loss_ce: 0.895603
[10:06:25.001] val epoch 102 : f1_micro : 0.6848406195640564, f1_macro : 0.5740160686629159, tumor_f1 : 0.7437793271882194, stroma_f1 : 0.6587822948183332, infla_f1 : 0.5146638878754207, necr_f1 : 0.873960724898747, other_f1 : 0.5242834218910762, acc_micro : 0.873960724898747
[10:06:26.504] train iteration 12979 : loss : 0.612520, loss_ce: 0.827301
[10:06:46.451] train iteration 13029 : loss : 0.564094, loss_ce: 0.796997
[10:07:06.611] train iteration 13079 : loss : 0.465951, loss_ce: 0.620490
[10:07:17.936] val epoch 103 : f1_micro : 0.6925514084952218, f1_macro : 0.5117235311440059, tumor_f1 : 0.7489249961716788, stroma_f1 : 0.6654558479785919, infla_f1 : 0.3186632479940142, necr_f1 : 0.8770637341908046, other_f1 : 0.5398592608315604, acc_micro : 0.8770637341908046
[10:07:19.434] train iteration 13105 : loss : 0.465759, loss_ce: 0.563572
[10:07:39.372] train iteration 13155 : loss : 0.697175, loss_ce: 1.058052
[10:07:59.465] train iteration 13205 : loss : 0.414141, loss_ce: 0.507281
[10:08:10.958] val epoch 104 : f1_micro : 0.6480934875352042, f1_macro : 0.5078556111880711, tumor_f1 : 0.7139401861599514, stroma_f1 : 0.621564656496048, infla_f1 : 0.24480874863054072, necr_f1 : 0.8592769418443952, other_f1 : 0.5303930214473179, acc_micro : 0.8592769418443952
[10:08:12.352] train iteration 13231 : loss : 0.525471, loss_ce: 0.680267
[10:08:32.221] train iteration 13281 : loss : 0.533096, loss_ce: 0.534162
[10:08:52.522] train iteration 13331 : loss : 0.535898, loss_ce: 0.662782
[10:09:03.908] val epoch 105 : f1_micro : 0.6651415782315391, f1_macro : 0.5481041244098118, tumor_f1 : 0.7086355430739266, stroma_f1 : 0.6751411386898586, infla_f1 : 0.25383926928043365, necr_f1 : 0.8660817997796195, other_f1 : 0.5314761283142226, acc_micro : 0.8660817997796195
[10:09:05.445] train iteration 13357 : loss : 0.568223, loss_ce: 0.782364
[10:09:25.492] train iteration 13407 : loss : 0.588982, loss_ce: 0.804029
[10:09:45.531] train iteration 13457 : loss : 0.437126, loss_ce: 0.446423
[10:09:57.041] val epoch 106 : f1_micro : 0.6608075754983085, f1_macro : 0.5475691556930542, tumor_f1 : 0.7178377083369664, stroma_f1 : 0.6304635660988944, infla_f1 : 0.4083842230694635, necr_f1 : 0.8643441200256348, other_f1 : 0.5475026432956968, acc_micro : 0.8643441200256348
[10:09:58.549] train iteration 13483 : loss : 0.470816, loss_ce: 0.664753
[10:10:18.467] train iteration 13533 : loss : 0.470969, loss_ce: 0.674951
[10:10:38.565] train iteration 13583 : loss : 0.464525, loss_ce: 0.557340
[10:10:49.983] val epoch 107 : f1_micro : 0.6564673440796989, f1_macro : 0.49659428000450134, tumor_f1 : 0.7193308557782855, stroma_f1 : 0.6404243622507367, infla_f1 : 0.15364288538694382, necr_f1 : 0.8626257606915065, other_f1 : 0.534233570098877, acc_micro : 0.8626257606915065
[10:10:51.493] train iteration 13609 : loss : 0.622347, loss_ce: 0.833618
[10:11:11.332] train iteration 13659 : loss : 0.525492, loss_ce: 0.730991
[10:11:31.464] train iteration 13709 : loss : 0.516702, loss_ce: 0.673007
[10:11:42.888] val epoch 108 : f1_micro : 0.6723993846348354, f1_macro : 0.5535344396318708, tumor_f1 : 0.7294456362724304, stroma_f1 : 0.6709539209093366, infla_f1 : 0.4012904720646994, necr_f1 : 0.868978602545602, other_f1 : 0.5374107286334038, acc_micro : 0.868978602545602
[10:11:44.368] train iteration 13735 : loss : 0.452495, loss_ce: 0.545366
[10:12:04.406] train iteration 13785 : loss : 0.394805, loss_ce: 0.449771
[10:12:24.599] train iteration 13835 : loss : 0.482087, loss_ce: 0.699442
[10:12:36.049] val epoch 109 : f1_micro : 0.6906839609146118, f1_macro : 0.4982484834534781, tumor_f1 : 0.742151175226484, stroma_f1 : 0.6796370148658752, infla_f1 : 0.24453931834016526, necr_f1 : 0.8763053928102765, other_f1 : 0.5392006784677505, acc_micro : 0.8763053928102765
[10:12:37.489] train iteration 13861 : loss : 0.539759, loss_ce: 0.727888
[10:12:57.436] train iteration 13911 : loss : 0.467025, loss_ce: 0.570060
[10:13:17.551] train iteration 13961 : loss : 0.587221, loss_ce: 0.646319
[10:13:29.001] val epoch 110 : f1_micro : 0.636485721383776, f1_macro : 0.5342786524977002, tumor_f1 : 0.7077219571386065, stroma_f1 : 0.6185114298548017, infla_f1 : 0.4009428120085171, necr_f1 : 0.8546169485364642, other_f1 : 0.5111569325838771, acc_micro : 0.8546169485364642
[10:13:30.511] train iteration 13987 : loss : 0.501341, loss_ce: 0.707010
[10:13:50.479] train iteration 14037 : loss : 0.536008, loss_ce: 0.546025
[10:14:10.616] train iteration 14087 : loss : 0.534817, loss_ce: 0.661683
[10:14:21.986] val epoch 111 : f1_micro : 0.6782584275518145, f1_macro : 0.5246441108839852, tumor_f1 : 0.7452160205159869, stroma_f1 : 0.6352655376706805, infla_f1 : 0.565408638545445, necr_f1 : 0.8713442427771432, other_f1 : 0.5344731584191322, acc_micro : 0.8713442427771432
[10:14:23.511] train iteration 14113 : loss : 0.561460, loss_ce: 0.587926
[10:14:43.526] train iteration 14163 : loss : 0.506195, loss_ce: 0.526043
[10:15:03.596] train iteration 14213 : loss : 0.406954, loss_ce: 0.455754
[10:15:15.098] val epoch 112 : f1_micro : 0.6709087405885968, f1_macro : 0.5287746105875287, tumor_f1 : 0.7355355109487262, stroma_f1 : 0.6399692637579781, infla_f1 : 0.44517985938832033, necr_f1 : 0.8683952007974897, other_f1 : 0.5364844221621752, acc_micro : 0.8683952007974897
[10:15:16.608] train iteration 14239 : loss : 0.454359, loss_ce: 0.603466
[10:15:36.607] train iteration 14289 : loss : 0.534301, loss_ce: 0.660931
[10:15:56.771] train iteration 14339 : loss : 0.485789, loss_ce: 0.664442
[10:16:08.098] val epoch 113 : f1_micro : 0.6566231080463955, f1_macro : 0.4789401079927172, tumor_f1 : 0.7153270159448896, stroma_f1 : 0.6573737689426967, infla_f1 : 0.34185101421150776, necr_f1 : 0.8626697148595538, other_f1 : 0.5372915800128665, acc_micro : 0.8626697148595538
[10:16:09.602] train iteration 14365 : loss : 0.552388, loss_ce: 0.711798
[10:16:29.595] train iteration 14415 : loss : 0.548695, loss_ce: 0.741694
[10:16:49.715] train iteration 14465 : loss : 0.586686, loss_ce: 0.768327
[10:17:01.204] val epoch 114 : f1_micro : 0.669123147215162, f1_macro : 0.5445215020860944, tumor_f1 : 0.7161877070154462, stroma_f1 : 0.6564263616289411, infla_f1 : 0.38186052441596985, necr_f1 : 0.8676720517022269, other_f1 : 0.5395614286618573, acc_micro : 0.8676720517022269
[10:17:02.544] train iteration 14491 : loss : 0.564480, loss_ce: 0.821792
[10:17:22.471] train iteration 14541 : loss : 0.795063, loss_ce: 1.094152
[10:17:42.584] train iteration 14591 : loss : 0.449369, loss_ce: 0.640350
[10:17:54.108] val epoch 115 : f1_micro : 0.6955776640347072, f1_macro : 0.5686029578958239, tumor_f1 : 0.7424145000321525, stroma_f1 : 0.6812641748360225, infla_f1 : 0.439323970249721, necr_f1 : 0.8782523274421692, other_f1 : 0.5513738460306611, acc_micro : 0.8782523274421692
[10:17:55.613] train iteration 14617 : loss : 0.661467, loss_ce: 0.970494
[10:18:15.510] train iteration 14667 : loss : 0.660991, loss_ce: 0.936797
[10:18:35.608] train iteration 14717 : loss : 0.397721, loss_ce: 0.487830
[10:18:47.144] val epoch 116 : f1_micro : 0.6757226501192365, f1_macro : 0.5198469928332737, tumor_f1 : 0.7308374302727836, stroma_f1 : 0.6677544074399131, infla_f1 : 0.24316964192049845, necr_f1 : 0.8703084077153888, other_f1 : 0.5276599787175655, acc_micro : 0.8703084077153888
[10:18:48.607] train iteration 14743 : loss : 0.480043, loss_ce: 0.620633
[10:19:08.501] train iteration 14793 : loss : 0.432323, loss_ce: 0.494594
[10:19:28.641] train iteration 14843 : loss : 0.502972, loss_ce: 0.671208
[10:19:40.011] val epoch 117 : f1_micro : 0.687162092753819, f1_macro : 0.506958612373897, tumor_f1 : 0.7448856745447431, stroma_f1 : 0.642713338136673, infla_f1 : 0.2910158336162567, necr_f1 : 0.8748907957758222, other_f1 : 0.5315709326948438, acc_micro : 0.8748907957758222
[10:19:41.587] train iteration 14869 : loss : 0.507224, loss_ce: 0.729915
[10:20:01.626] train iteration 14919 : loss : 0.515360, loss_ce: 0.640188
[10:20:21.669] train iteration 14969 : loss : 0.590020, loss_ce: 0.831734
[10:20:33.236] val epoch 118 : f1_micro : 0.6851557237761361, f1_macro : 0.5480683829103198, tumor_f1 : 0.7400866150856018, stroma_f1 : 0.6716685124805996, infla_f1 : 0.5070813085351672, necr_f1 : 0.8740869760513306, other_f1 : 0.5246613291757447, acc_micro : 0.8740869760513306
[10:20:34.685] train iteration 14995 : loss : 0.512710, loss_ce: 0.597803
[10:20:54.606] train iteration 15045 : loss : 0.606468, loss_ce: 0.944898
[10:21:14.780] train iteration 15095 : loss : 0.561922, loss_ce: 0.825287
[10:21:26.182] val epoch 119 : f1_micro : 0.6802322353635516, f1_macro : 0.5708665422030857, tumor_f1 : 0.7427925893238613, stroma_f1 : 0.661452089037214, infla_f1 : 0.4934290179184505, necr_f1 : 0.8721155268805367, other_f1 : 0.528087642043829, acc_micro : 0.8721155268805367
[10:21:27.585] train iteration 15121 : loss : 0.434105, loss_ce: 0.615530
[10:21:47.649] train iteration 15171 : loss : 0.475181, loss_ce: 0.482214
[10:22:07.771] train iteration 15221 : loss : 0.263503, loss_ce: 0.373900
[10:22:19.300] val epoch 120 : f1_micro : 0.6773964422089713, f1_macro : 0.5596421871866498, tumor_f1 : 0.7386147720473153, stroma_f1 : 0.6583938726357051, infla_f1 : 0.436794000012534, necr_f1 : 0.8709743704114642, other_f1 : 0.5358368296708379, acc_micro : 0.8709743704114642
[10:22:20.728] train iteration 15247 : loss : 0.789467, loss_ce: 1.160017
[10:22:40.751] train iteration 15297 : loss : 0.486989, loss_ce: 0.679697
[10:23:00.819] train iteration 15347 : loss : 0.462662, loss_ce: 0.506837
[10:23:12.358] val epoch 121 : f1_micro : 0.6943392157554626, f1_macro : 0.5857232255595071, tumor_f1 : 0.757631174155644, stroma_f1 : 0.6698595115116665, infla_f1 : 0.5159429631062916, necr_f1 : 0.8777555567877633, other_f1 : 0.5333594355200019, acc_micro : 0.8777555567877633
[10:23:13.804] train iteration 15373 : loss : 0.482125, loss_ce: 0.658414
[10:23:33.703] train iteration 15423 : loss : 0.461906, loss_ce: 0.604511
[10:23:53.844] train iteration 15473 : loss : 0.614116, loss_ce: 0.757737
[10:24:05.301] val epoch 122 : f1_micro : 0.683468222618103, f1_macro : 0.5292608610221318, tumor_f1 : 0.743857170854296, stroma_f1 : 0.6730416161673409, infla_f1 : 0.26690480621930746, necr_f1 : 0.8734201107706342, other_f1 : 0.5313020290008613, acc_micro : 0.8734201107706342
[10:24:06.774] train iteration 15499 : loss : 0.603921, loss_ce: 0.608647
[10:24:26.776] train iteration 15549 : loss : 0.500825, loss_ce: 0.808819
[10:24:46.869] train iteration 15599 : loss : 0.561425, loss_ce: 0.747191
[10:24:58.419] val epoch 123 : f1_micro : 0.6955109068325588, f1_macro : 0.5278734011309487, tumor_f1 : 0.7550628440720695, stroma_f1 : 0.6737198233604431, infla_f1 : 0.3843731944050108, necr_f1 : 0.8782323854310172, other_f1 : 0.540131117333658, acc_micro : 0.8782323854310172
[10:24:59.917] train iteration 15625 : loss : 0.683610, loss_ce: 1.023214
[10:25:19.764] train iteration 15675 : loss : 0.643205, loss_ce: 0.799548
[10:25:39.939] train iteration 15725 : loss : 0.633040, loss_ce: 0.934831
[10:25:51.468] val epoch 124 : f1_micro : 0.6964645215443203, f1_macro : 0.5265841909817287, tumor_f1 : 0.7666584934507098, stroma_f1 : 0.6809441021510533, infla_f1 : 0.33135662972927094, necr_f1 : 0.878615311213902, other_f1 : 0.5419094504655472, acc_micro : 0.878615311213902
[10:25:52.875] train iteration 15751 : loss : 0.577060, loss_ce: 0.796410
[10:26:12.821] train iteration 15801 : loss : 0.509661, loss_ce: 0.726323
[10:26:33.005] train iteration 15851 : loss : 0.692167, loss_ce: 0.917939
[10:26:44.411] val epoch 125 : f1_micro : 0.6882141573088509, f1_macro : 0.513878311429705, tumor_f1 : 0.7453852125576564, stroma_f1 : 0.6619106318269458, infla_f1 : 0.283138564654759, necr_f1 : 0.8753077813557216, other_f1 : 0.5556991536702428, acc_micro : 0.8753077813557216
[10:26:45.935] train iteration 15877 : loss : 0.463552, loss_ce: 0.619825
[10:27:05.974] train iteration 15927 : loss : 0.473798, loss_ce: 0.591923
[10:27:26.053] train iteration 15977 : loss : 0.440178, loss_ce: 0.557993
[10:27:37.584] val epoch 126 : f1_micro : 0.6994344762393406, f1_macro : 0.570619421345847, tumor_f1 : 0.7503797326769147, stroma_f1 : 0.6742748873574393, infla_f1 : 0.45269776242119925, necr_f1 : 0.8797942485128131, other_f1 : 0.5448130765663726, acc_micro : 0.8797942485128131
[10:27:39.038] train iteration 16003 : loss : 0.551974, loss_ce: 0.742152
[10:27:59.087] train iteration 16053 : loss : 0.544082, loss_ce: 0.724847
[10:28:19.246] train iteration 16103 : loss : 0.541908, loss_ce: 0.798301
[10:28:30.734] val epoch 127 : f1_micro : 0.6931685720171247, f1_macro : 0.5208068106855664, tumor_f1 : 0.7600306187357221, stroma_f1 : 0.6813568770885468, infla_f1 : 0.30831845104694366, necr_f1 : 0.8773173434393746, other_f1 : 0.5529607497155666, acc_micro : 0.8773173434393746
[10:28:32.328] train iteration 16129 : loss : 0.389435, loss_ce: 0.441163
[10:28:52.285] train iteration 16179 : loss : 0.597395, loss_ce: 0.795241
[10:29:12.345] train iteration 16229 : loss : 0.680536, loss_ce: 0.863233
[10:29:24.031] val epoch 128 : f1_micro : 0.6934570244380406, f1_macro : 0.5253915573869433, tumor_f1 : 0.7608994586127145, stroma_f1 : 0.67507004737854, infla_f1 : 0.3260363276515688, necr_f1 : 0.877416057246072, other_f1 : 0.5621753313711711, acc_micro : 0.877416057246072
[10:29:25.625] train iteration 16255 : loss : 0.564457, loss_ce: 0.762419
[10:29:45.578] train iteration 16305 : loss : 0.490321, loss_ce: 0.638346
[10:30:05.660] train iteration 16355 : loss : 0.675601, loss_ce: 0.942015
[10:30:17.209] val epoch 129 : f1_micro : 0.6792804769107273, f1_macro : 0.5357608624867031, tumor_f1 : 0.7314145735331944, stroma_f1 : 0.6703717708587646, infla_f1 : 0.43911337978871806, necr_f1 : 0.8717417631830487, other_f1 : 0.5521903591496604, acc_micro : 0.8717417631830487
[10:30:18.679] train iteration 16381 : loss : 0.426144, loss_ce: 0.605498
[10:30:38.580] train iteration 16431 : loss : 0.367958, loss_ce: 0.437714
[10:30:58.909] train iteration 16481 : loss : 0.431663, loss_ce: 0.532853
[10:31:10.405] val epoch 130 : f1_micro : 0.6725837418011257, f1_macro : 0.49194471325193134, tumor_f1 : 0.7386946933610099, stroma_f1 : 0.6682932078838348, infla_f1 : 0.21314434421115688, necr_f1 : 0.8690608739852905, other_f1 : 0.549805549638612, acc_micro : 0.8690608739852905
[10:31:11.891] train iteration 16507 : loss : 0.444976, loss_ce: 0.686627
[10:31:31.832] train iteration 16557 : loss : 0.465736, loss_ce: 0.662250
[10:31:52.089] train iteration 16607 : loss : 0.468130, loss_ce: 0.720924
[10:32:03.560] val epoch 131 : f1_micro : 0.6925856811659676, f1_macro : 0.5795104588781085, tumor_f1 : 0.7456911206245422, stroma_f1 : 0.6739952223641532, infla_f1 : 0.5137658659368753, necr_f1 : 0.8770585145269122, other_f1 : 0.5355286342757088, acc_micro : 0.8770585145269122
[10:32:05.132] train iteration 16633 : loss : 0.524354, loss_ce: 0.789133
[10:32:25.088] train iteration 16683 : loss : 0.591099, loss_ce: 0.765065
[10:32:45.359] train iteration 16733 : loss : 0.449089, loss_ce: 0.599589
[10:32:56.770] val epoch 132 : f1_micro : 0.6999196495328631, f1_macro : 0.5284454354218074, tumor_f1 : 0.756806126662663, stroma_f1 : 0.6829421988555363, infla_f1 : 0.34827251732349396, necr_f1 : 0.880007130759103, other_f1 : 0.5684921368956566, acc_micro : 0.880007130759103
[10:32:58.322] train iteration 16759 : loss : 0.499178, loss_ce: 0.694037
[10:33:18.281] train iteration 16809 : loss : 0.482803, loss_ce: 0.699174
[10:33:38.434] train iteration 16859 : loss : 0.477344, loss_ce: 0.645059
[10:33:50.035] val epoch 133 : f1_micro : 0.6797665016991752, f1_macro : 0.5592445049967084, tumor_f1 : 0.7397155250821795, stroma_f1 : 0.6743604285376412, infla_f1 : 0.4073995546038662, necr_f1 : 0.8719329408236912, other_f1 : 0.5461756432695049, acc_micro : 0.8719329408236912
[10:33:51.589] train iteration 16885 : loss : 0.496558, loss_ce: 0.581695
[10:34:11.522] train iteration 16935 : loss : 0.670668, loss_ce: 0.841477
[10:34:31.643] train iteration 16985 : loss : 0.407627, loss_ce: 0.520813
[10:34:43.194] val epoch 134 : f1_micro : 0.7016087429864066, f1_macro : 0.546469475541796, tumor_f1 : 0.769044748374394, stroma_f1 : 0.6889085897377559, infla_f1 : 0.4477886262216738, necr_f1 : 0.880673348903656, other_f1 : 0.5408911112962025, acc_micro : 0.880673348903656
[10:34:44.772] train iteration 17011 : loss : 0.433620, loss_ce: 0.524708
[10:35:04.679] train iteration 17061 : loss : 0.502672, loss_ce: 0.688218
[10:35:24.997] train iteration 17111 : loss : 0.465284, loss_ce: 0.589744
[10:35:36.413] val epoch 135 : f1_micro : 0.6957083429609027, f1_macro : 0.5378226850714002, tumor_f1 : 0.7568898456437247, stroma_f1 : 0.6886197328567505, infla_f1 : 0.3965693621763161, necr_f1 : 0.8783131156648908, other_f1 : 0.5613202495234353, acc_micro : 0.8783131156648908
[10:35:37.951] train iteration 17137 : loss : 0.608960, loss_ce: 0.861064
[10:35:57.860] train iteration 17187 : loss : 0.526008, loss_ce: 0.745591
[10:36:18.061] train iteration 17237 : loss : 0.607210, loss_ce: 0.905025
[10:36:29.523] val epoch 136 : f1_micro : 0.6945255654198783, f1_macro : 0.5528498930590493, tumor_f1 : 0.75274487052645, stroma_f1 : 0.6759323392595563, infla_f1 : 0.5077446688498769, necr_f1 : 0.8778470584324428, other_f1 : 0.5421133174427918, acc_micro : 0.8778470584324428
[10:36:31.030] train iteration 17263 : loss : 0.439211, loss_ce: 0.563579
[10:36:50.958] train iteration 17313 : loss : 0.399073, loss_ce: 0.425851
[10:37:11.151] train iteration 17363 : loss : 0.450331, loss_ce: 0.522895
[10:37:22.610] val epoch 137 : f1_micro : 0.6772293959345136, f1_macro : 0.5515759246689933, tumor_f1 : 0.7349211999348232, stroma_f1 : 0.6767281080995288, infla_f1 : 0.384501907043159, necr_f1 : 0.8709134714944022, other_f1 : 0.5331570295883077, acc_micro : 0.8709134714944022
[10:37:24.065] train iteration 17389 : loss : 0.447454, loss_ce: 0.626692
[10:37:43.983] train iteration 17439 : loss : 0.495022, loss_ce: 0.553300
[10:38:04.257] train iteration 17489 : loss : 0.568729, loss_ce: 0.819477
[10:38:15.667] val epoch 138 : f1_micro : 0.686830963407244, f1_macro : 0.5779379989419665, tumor_f1 : 0.7492242625781468, stroma_f1 : 0.6710734963417053, infla_f1 : 0.4818994924426079, necr_f1 : 0.8747625606400626, other_f1 : 0.5589212743299348, acc_micro : 0.8747625606400626
[10:38:17.214] train iteration 17515 : loss : 0.547659, loss_ce: 0.674511
[10:38:37.186] train iteration 17565 : loss : 0.493301, loss_ce: 0.726847
[10:38:57.405] train iteration 17615 : loss : 0.579498, loss_ce: 0.816410
[10:39:08.723] val epoch 139 : f1_micro : 0.6974699241774422, f1_macro : 0.5480633888925824, tumor_f1 : 0.746795117855072, stroma_f1 : 0.6946696639060974, infla_f1 : 0.4382691645462598, necr_f1 : 0.8790223598480225, other_f1 : 0.5748686894242253, acc_micro : 0.8790223598480225
[10:39:10.209] train iteration 17641 : loss : 0.409219, loss_ce: 0.584970
[10:39:30.233] train iteration 17691 : loss : 0.467553, loss_ce: 0.595815
[10:39:50.352] train iteration 17741 : loss : 0.378038, loss_ce: 0.438286
[10:40:01.909] val epoch 140 : f1_micro : 0.6836329783712115, f1_macro : 0.5657011611121041, tumor_f1 : 0.7472354173660278, stroma_f1 : 0.6724868885108403, infla_f1 : 0.4363650716841221, necr_f1 : 0.8734879664012364, other_f1 : 0.5438470116683415, acc_micro : 0.8734879664012364
[10:40:03.431] train iteration 17767 : loss : 0.453023, loss_ce: 0.519512
[10:40:23.287] train iteration 17817 : loss : 0.556446, loss_ce: 0.621463
[10:40:43.445] train iteration 17867 : loss : 0.401466, loss_ce: 0.575185
[10:40:55.007] val epoch 141 : f1_micro : 0.6906215633664813, f1_macro : 0.5473897499697549, tumor_f1 : 0.7427891918591091, stroma_f1 : 0.6760373115539551, infla_f1 : 0.4726783743660365, necr_f1 : 0.8762789794376918, other_f1 : 0.5597295596131256, acc_micro : 0.8762789794376918
[10:40:56.534] train iteration 17893 : loss : 0.456282, loss_ce: 0.629928
[10:41:16.491] train iteration 17943 : loss : 0.259174, loss_ce: 0.313736
[10:41:36.622] train iteration 17993 : loss : 0.475230, loss_ce: 0.730411
[10:41:48.025] val epoch 142 : f1_micro : 0.6901921544756208, f1_macro : 0.545834060226168, tumor_f1 : 0.745157505784716, stroma_f1 : 0.6772606372833252, infla_f1 : 0.461067622261388, necr_f1 : 0.8761046954563686, other_f1 : 0.5599703001124519, acc_micro : 0.8761046954563686
[10:41:49.629] train iteration 18019 : loss : 0.529999, loss_ce: 0.580242
[10:42:09.628] train iteration 18069 : loss : 0.529127, loss_ce: 0.775567
[10:42:29.701] train iteration 18119 : loss : 0.430514, loss_ce: 0.613376
[10:42:41.182] val epoch 143 : f1_micro : 0.682599493435451, f1_macro : 0.5393485299178532, tumor_f1 : 0.7473857998847961, stroma_f1 : 0.674511696611132, infla_f1 : 0.4331490525177547, necr_f1 : 0.8730695503098624, other_f1 : 0.5559818542429379, acc_micro : 0.8730695503098624
[10:42:42.749] train iteration 18145 : loss : 0.501501, loss_ce: 0.682986
[10:43:02.719] train iteration 18195 : loss : 0.580634, loss_ce: 0.791621
[10:43:22.884] train iteration 18245 : loss : 0.398766, loss_ce: 0.574485
[10:43:34.345] val epoch 144 : f1_micro : 0.6906603745051793, f1_macro : 0.5506667750222343, tumor_f1 : 0.745163117136274, stroma_f1 : 0.676010365997042, infla_f1 : 0.49386674132464187, necr_f1 : 0.8762952770505633, other_f1 : 0.5525794095758881, acc_micro : 0.8762952770505633
[10:43:35.884] train iteration 18271 : loss : 0.392289, loss_ce: 0.575064
[10:43:55.840] train iteration 18321 : loss : 0.502878, loss_ce: 0.539877
[10:44:16.097] train iteration 18371 : loss : 0.465128, loss_ce: 0.641076
[10:44:27.405] val epoch 145 : f1_micro : 0.68633462701525, f1_macro : 0.5466393104621342, tumor_f1 : 0.7410334093230111, stroma_f1 : 0.6746702534811837, infla_f1 : 0.47432051386151997, necr_f1 : 0.8745609096118382, other_f1 : 0.5574580343174083, acc_micro : 0.8745609096118382
[10:44:28.818] train iteration 18397 : loss : 0.393212, loss_ce: 0.491198
[10:44:48.814] train iteration 18447 : loss : 0.428698, loss_ce: 0.561273
[10:45:08.897] train iteration 18497 : loss : 0.446284, loss_ce: 0.493411
[10:45:20.373] val epoch 146 : f1_micro : 0.6850325635501316, f1_macro : 0.5409796961716243, tumor_f1 : 0.7395241260528564, stroma_f1 : 0.6777375255312238, infla_f1 : 0.44742819028241293, necr_f1 : 0.8740451421056475, other_f1 : 0.5544943476894072, acc_micro : 0.8740451421056475
[10:45:21.825] train iteration 18523 : loss : 0.343108, loss_ce: 0.458584
[10:45:41.823] train iteration 18573 : loss : 0.508649, loss_ce: 0.564546
[10:46:01.970] train iteration 18623 : loss : 0.500131, loss_ce: 0.609711
[10:46:13.319] val epoch 147 : f1_micro : 0.6820570060185024, f1_macro : 0.5348651920046125, tumor_f1 : 0.7408003381320408, stroma_f1 : 0.6792209233556475, infla_f1 : 0.4120246797600495, necr_f1 : 0.8728542072432381, other_f1 : 0.5565656655068908, acc_micro : 0.8728542072432381
[10:46:14.821] train iteration 18649 : loss : 0.414249, loss_ce: 0.552971
[10:46:34.798] train iteration 18699 : loss : 0.367218, loss_ce: 0.426260
[10:46:55.031] train iteration 18749 : loss : 0.449885, loss_ce: 0.649582
[10:47:06.473] val epoch 148 : f1_micro : 0.6910846488816398, f1_macro : 0.5494713570390429, tumor_f1 : 0.7486198885100228, stroma_f1 : 0.6785818423543658, infla_f1 : 0.4754411988625569, necr_f1 : 0.8764654057366508, other_f1 : 0.558999668274607, acc_micro : 0.8764654057366508
[10:47:07.969] train iteration 18775 : loss : 0.314439, loss_ce: 0.450133
[10:47:27.955] train iteration 18825 : loss : 0.603088, loss_ce: 0.855393
[10:47:48.133] train iteration 18875 : loss : 0.392498, loss_ce: 0.533624
[10:47:59.502] val epoch 149 : f1_micro : 0.6909077422959464, f1_macro : 0.5484597342354911, tumor_f1 : 0.7476627315793719, stroma_f1 : 0.6791727202279227, infla_f1 : 0.47040780101503643, necr_f1 : 0.8763942633356366, other_f1 : 0.5593411773443222, acc_micro : 0.8763942633356366
[10:48:00.414] save model to ./logs/frac_0.5/fold_4/epoch_149.pth
[10:48:01.375] save model to ./logs/frac_0.5/fold_4/epoch_149.pth

[09:23:48.680] Namespace(root_path='../data/bcss/L0_1024_s512', dataset='bcss', list_dir='./lists/lists_Synapse', num_classes=6, output_dir='./logs/frac_1.0/fold_2', max_iterations=30000, max_epochs=150, batch_size=24, n_gpu=1, deterministic=0, base_lr=0.05, img_size=224, seed=1234, cfg='configs/swin_tiny_patch4_window7_224_lite.yaml', opts=None, zip=False, cache_mode='part', resume=None, accumulation_steps=None, use_checkpoint=False, amp_opt_level='O1', tag=None, eval=False, throughput=False, frac=1.0, fold=2)
[09:23:48.703] Reading 9897 files in ../data/bcss/L0_1024_s512/data.csv...
[09:23:48.716] Using fold 2 and keep 7011 train files only...
[09:23:48.716] Removing images with threshold of 0.1...
[09:23:48.717] Create train set with 6253 files...
[09:23:48.718] Use 1.0 percent of data to train: 6253!
[09:23:48.722] Reading 804 files in ../data/bcss/L0_1024_s512/val_data.csv...
[09:23:48.725] Using fold 2 and keep 257 val files only...
[09:23:48.725] Removing images with threshold of 0.1...
[09:23:48.726] Create val set with 220 files...
[09:23:49.589] 261 iterations per epoch. 39150 max iterations 
[09:23:52.443] train iteration 1 : loss : 1.271811, loss_ce: 1.907508
[09:24:12.069] train iteration 51 : loss : 0.937326, loss_ce: 1.180365
[09:24:31.720] train iteration 101 : loss : 0.942246, loss_ce: 1.189181
[09:24:51.676] train iteration 151 : loss : 0.936436, loss_ce: 1.292730
[09:25:11.784] train iteration 201 : loss : 0.900887, loss_ce: 1.146253
[09:25:31.980] train iteration 251 : loss : 0.731055, loss_ce: 0.882123
[09:25:39.958] val epoch 0 : f1_micro : 0.5022602166448321, f1_macro : 0.30090040394238066, tumor_f1 : 0.5848760902881622, stroma_f1 : 0.5111791880003044, infla_f1 : 0.1658302509625043, necr_f1 : 0.8035125476973397, other_f1 : 0.15281565152690746, acc_micro : 0.8035125476973397
[09:25:41.429] train iteration 262 : loss : 0.907019, loss_ce: 1.195819
[09:26:01.159] train iteration 312 : loss : 0.776194, loss_ce: 0.990173
[09:26:21.221] train iteration 362 : loss : 1.038602, loss_ce: 1.468024
[09:26:41.311] train iteration 412 : loss : 0.862330, loss_ce: 1.057302
[09:27:01.370] train iteration 462 : loss : 1.000773, loss_ce: 1.426867
[09:27:21.457] train iteration 512 : loss : 0.959543, loss_ce: 1.466099
[09:27:29.136] val epoch 1 : f1_micro : 0.5756239082132067, f1_macro : 0.4509955474308559, tumor_f1 : 0.6265058049133846, stroma_f1 : 0.6323520009006772, infla_f1 : 0.1334782388626731, necr_f1 : 0.8303003822054181, other_f1 : 0.29121311714074444, acc_micro : 0.8303003822054181
[09:27:30.510] train iteration 523 : loss : 0.951781, loss_ce: 1.276185
[09:27:50.205] train iteration 573 : loss : 0.883122, loss_ce: 1.270251
[09:28:10.194] train iteration 623 : loss : 0.729164, loss_ce: 0.968151
[09:28:30.100] train iteration 673 : loss : 0.865007, loss_ce: 1.263317
[09:28:50.206] train iteration 723 : loss : 0.789561, loss_ce: 1.024238
[09:29:10.171] train iteration 773 : loss : 0.871110, loss_ce: 1.047621
[09:29:17.569] val epoch 2 : f1_micro : 0.548665348972593, f1_macro : 0.47693981123822077, tumor_f1 : 0.6004738573517118, stroma_f1 : 0.5268283640699727, infla_f1 : 0.3275696262717247, necr_f1 : 0.819724440574646, other_f1 : 0.35839858185499907, acc_micro : 0.819724440574646
[09:29:19.075] train iteration 784 : loss : 0.828623, loss_ce: 1.085578
[09:29:38.755] train iteration 834 : loss : 0.889159, loss_ce: 1.249858
[09:29:58.673] train iteration 884 : loss : 0.840663, loss_ce: 1.142287
[09:30:18.599] train iteration 934 : loss : 0.740301, loss_ce: 0.887171
[09:30:38.590] train iteration 984 : loss : 0.714113, loss_ce: 0.898185
[09:30:58.585] train iteration 1034 : loss : 0.733302, loss_ce: 0.887508
[09:31:06.097] val epoch 3 : f1_micro : 0.6234344840049744, f1_macro : 0.516639551946095, tumor_f1 : 0.6742636029209409, stroma_f1 : 0.596124563898359, infla_f1 : 0.5006390341690609, necr_f1 : 0.8494781298296792, other_f1 : 0.3082763412967324, acc_micro : 0.8494781298296792
[09:31:07.590] train iteration 1045 : loss : 0.801673, loss_ce: 1.101823
[09:31:27.262] train iteration 1095 : loss : 0.781897, loss_ce: 1.004223
[09:31:47.117] train iteration 1145 : loss : 0.867127, loss_ce: 1.206067
[09:32:06.958] train iteration 1195 : loss : 0.846644, loss_ce: 1.209570
[09:32:26.831] train iteration 1245 : loss : 0.748890, loss_ce: 0.947753
[09:32:46.903] train iteration 1295 : loss : 0.914127, loss_ce: 1.241906
[09:32:54.476] val epoch 4 : f1_micro : 0.6131805969136102, f1_macro : 0.4919544298733984, tumor_f1 : 0.6420745487724032, stroma_f1 : 0.6216770740492004, infla_f1 : 0.47857226112059187, necr_f1 : 0.84538534283638, other_f1 : 0.3596404460842158, acc_micro : 0.84538534283638
[09:32:55.930] train iteration 1306 : loss : 0.763033, loss_ce: 1.034645
[09:33:15.613] train iteration 1356 : loss : 0.631554, loss_ce: 0.920381
[09:33:35.370] train iteration 1406 : loss : 0.816425, loss_ce: 1.096015
[09:33:55.312] train iteration 1456 : loss : 0.874637, loss_ce: 1.199198
[09:34:15.351] train iteration 1506 : loss : 0.605642, loss_ce: 0.778550
[09:34:35.121] train iteration 1556 : loss : 0.613385, loss_ce: 0.947278
[09:34:42.749] val epoch 5 : f1_micro : 0.6063550646815982, f1_macro : 0.5073138922452927, tumor_f1 : 0.6570868108953748, stroma_f1 : 0.6200921753687518, infla_f1 : 0.40288166449006113, necr_f1 : 0.8427280272756305, other_f1 : 0.35569903893130167, acc_micro : 0.8427280272756305
[09:34:44.175] train iteration 1567 : loss : 0.881209, loss_ce: 1.274579
[09:35:03.843] train iteration 1617 : loss : 0.449206, loss_ce: 0.676538
[09:35:23.586] train iteration 1667 : loss : 0.655712, loss_ce: 0.743703
[09:35:43.563] train iteration 1717 : loss : 0.918635, loss_ce: 1.341074
[09:36:03.519] train iteration 1767 : loss : 0.828533, loss_ce: 1.118774
[09:36:23.388] train iteration 1817 : loss : 0.961578, loss_ce: 1.477842
[09:36:30.828] val epoch 6 : f1_micro : 0.634603847350393, f1_macro : 0.5290188863873482, tumor_f1 : 0.688791281410626, stroma_f1 : 0.607886727899313, infla_f1 : 0.5457196086645126, necr_f1 : 0.8539340198040009, other_f1 : 0.3707184397083308, acc_micro : 0.8539340198040009
[09:36:32.408] train iteration 1828 : loss : 0.783074, loss_ce: 0.986471
[09:36:52.076] train iteration 1878 : loss : 0.664910, loss_ce: 0.836825
[09:37:11.839] train iteration 1928 : loss : 0.702726, loss_ce: 0.902829
[09:37:31.822] train iteration 1978 : loss : 0.759275, loss_ce: 1.068766
[09:37:51.621] train iteration 2028 : loss : 0.703664, loss_ce: 0.868034
[09:38:11.528] train iteration 2078 : loss : 0.834306, loss_ce: 1.120771
[09:38:18.950] val epoch 7 : f1_micro : 0.6230831167527607, f1_macro : 0.4562610260077885, tumor_f1 : 0.6588465613978249, stroma_f1 : 0.6398407870105335, infla_f1 : 0.3818642840321575, necr_f1 : 0.8492568901606968, other_f1 : 0.3863170679126467, acc_micro : 0.8492568901606968
[09:38:20.449] train iteration 2089 : loss : 0.628646, loss_ce: 0.817214
[09:38:40.117] train iteration 2139 : loss : 0.882380, loss_ce: 1.189557
[09:38:59.885] train iteration 2189 : loss : 0.622351, loss_ce: 0.726149
[09:39:19.771] train iteration 2239 : loss : 0.717294, loss_ce: 0.899790
[09:39:39.675] train iteration 2289 : loss : 0.546237, loss_ce: 0.862764
[09:39:59.622] train iteration 2339 : loss : 0.739555, loss_ce: 0.853028
[09:40:07.014] val epoch 8 : f1_micro : 0.6326047735554832, f1_macro : 0.5116235134857041, tumor_f1 : 0.6834270783833095, stroma_f1 : 0.5591423729700702, infla_f1 : 0.5651824516909463, necr_f1 : 0.8530892814908709, other_f1 : 0.3877806929605348, acc_micro : 0.8530892814908709
[09:40:08.460] train iteration 2350 : loss : 0.722011, loss_ce: 0.941954
[09:40:28.140] train iteration 2400 : loss : 0.601752, loss_ce: 0.693874
[09:40:47.999] train iteration 2450 : loss : 0.680626, loss_ce: 0.937041
[09:41:07.829] train iteration 2500 : loss : 0.866733, loss_ce: 1.269409
[09:41:27.709] train iteration 2550 : loss : 1.016848, loss_ce: 1.500363
[09:41:47.558] train iteration 2600 : loss : 0.877674, loss_ce: 1.139989
[09:41:55.165] val epoch 9 : f1_micro : 0.6418020725250244, f1_macro : 0.4980184861591884, tumor_f1 : 0.6840602393661227, stroma_f1 : 0.6065980068274907, infla_f1 : 0.5769024108137403, necr_f1 : 0.8567615321704319, other_f1 : 0.39094375958666205, acc_micro : 0.8567615321704319
[09:41:56.660] train iteration 2611 : loss : 0.656211, loss_ce: 0.970956
[09:42:16.330] train iteration 2661 : loss : 0.735156, loss_ce: 1.008977
[09:42:36.207] train iteration 2711 : loss : 0.713931, loss_ce: 1.082371
[09:42:56.067] train iteration 2761 : loss : 0.671428, loss_ce: 0.829966
[09:43:16.022] train iteration 2811 : loss : 0.634153, loss_ce: 0.783901
[09:43:36.031] train iteration 2861 : loss : 0.655796, loss_ce: 0.897401
[09:43:43.472] val epoch 10 : f1_micro : 0.6532192485673087, f1_macro : 0.4809996911457607, tumor_f1 : 0.6848346356834684, stroma_f1 : 0.6494628073913711, infla_f1 : 0.6011476601873126, necr_f1 : 0.8614145347050258, other_f1 : 0.3750353424610304, acc_micro : 0.8614145347050258
[09:43:44.965] train iteration 2872 : loss : 0.541247, loss_ce: 0.825490
[09:44:04.632] train iteration 2922 : loss : 0.577561, loss_ce: 0.731057
[09:44:24.445] train iteration 2972 : loss : 0.612311, loss_ce: 0.716144
[09:44:44.449] train iteration 3022 : loss : 0.782858, loss_ce: 1.079172
[09:45:04.333] train iteration 3072 : loss : 0.700342, loss_ce: 0.795815
[09:45:24.221] train iteration 3122 : loss : 0.638485, loss_ce: 0.803458
[09:45:31.652] val epoch 11 : f1_micro : 0.6444437780550548, f1_macro : 0.4585539868899754, tumor_f1 : 0.705450890319688, stroma_f1 : 0.615005224943161, infla_f1 : 0.5836659478289741, necr_f1 : 0.8578200340270996, other_f1 : 0.35709799263609704, acc_micro : 0.8578200340270996
[09:45:33.181] train iteration 3133 : loss : 0.758111, loss_ce: 0.993602
[09:45:52.854] train iteration 3183 : loss : 0.789930, loss_ce: 0.990918
[09:46:12.695] train iteration 3233 : loss : 0.757033, loss_ce: 0.991569
[09:46:32.658] train iteration 3283 : loss : 0.639559, loss_ce: 0.911070
[09:46:52.600] train iteration 3333 : loss : 0.656056, loss_ce: 0.864205
[09:47:12.401] train iteration 3383 : loss : 0.709998, loss_ce: 0.868271
[09:47:19.954] val epoch 12 : f1_micro : 0.5905752990927015, f1_macro : 0.47203480132988523, tumor_f1 : 0.6548744248492377, stroma_f1 : 0.5360712877341679, infla_f1 : 0.5928183022354331, necr_f1 : 0.8362665474414825, other_f1 : 0.396800536396248, acc_micro : 0.8362665474414825
[09:47:21.439] train iteration 3394 : loss : 0.714695, loss_ce: 0.967602
[09:47:41.109] train iteration 3444 : loss : 0.563749, loss_ce: 0.723511
[09:48:01.013] train iteration 3494 : loss : 0.663112, loss_ce: 0.748435
[09:48:20.929] train iteration 3544 : loss : 0.569391, loss_ce: 0.759375
[09:48:40.949] train iteration 3594 : loss : 0.765572, loss_ce: 0.964875
[09:49:00.804] train iteration 3644 : loss : 0.904744, loss_ce: 1.355329
[09:49:08.270] val epoch 13 : f1_micro : 0.6429535554988044, f1_macro : 0.5083837062120438, tumor_f1 : 0.6909049493925912, stroma_f1 : 0.5974939114281109, infla_f1 : 0.6409487053751945, necr_f1 : 0.8572277724742889, other_f1 : 0.32041790815336363, acc_micro : 0.8572277724742889
[09:49:09.849] train iteration 3655 : loss : 0.646536, loss_ce: 0.812166
[09:49:29.532] train iteration 3705 : loss : 0.832538, loss_ce: 1.075325
[09:49:49.423] train iteration 3755 : loss : 0.688349, loss_ce: 0.894182
[09:50:09.428] train iteration 3805 : loss : 0.701062, loss_ce: 0.959417
[09:50:29.326] train iteration 3855 : loss : 0.528153, loss_ce: 0.733142
[09:50:49.250] train iteration 3905 : loss : 0.696999, loss_ce: 0.934207
[09:50:56.760] val epoch 14 : f1_micro : 0.6691022387572697, f1_macro : 0.49421888164111544, tumor_f1 : 0.7185111897332328, stroma_f1 : 0.623935552580016, infla_f1 : 0.6108155782733645, necr_f1 : 0.8677145370415279, other_f1 : 0.3691734606400132, acc_micro : 0.8677145370415279
[09:50:58.280] train iteration 3916 : loss : 0.599374, loss_ce: 0.706550
[09:51:17.962] train iteration 3966 : loss : 0.636205, loss_ce: 0.741385
[09:51:37.897] train iteration 4016 : loss : 0.583515, loss_ce: 0.686483
[09:51:57.782] train iteration 4066 : loss : 0.498006, loss_ce: 0.646699
[09:52:17.738] train iteration 4116 : loss : 0.819833, loss_ce: 1.009506
[09:52:37.680] train iteration 4166 : loss : 0.585719, loss_ce: 0.940613
[09:52:45.106] val epoch 15 : f1_micro : 0.6099771346364703, f1_macro : 0.4522176172052111, tumor_f1 : 0.7100934599127088, stroma_f1 : 0.5257145219615528, infla_f1 : 0.5713374550853457, necr_f1 : 0.8440117623124804, other_f1 : 0.38811949134937357, acc_micro : 0.8440117623124804
[09:52:46.599] train iteration 4177 : loss : 0.567588, loss_ce: 0.727189
[09:53:06.286] train iteration 4227 : loss : 0.682477, loss_ce: 0.790038
[09:53:26.223] train iteration 4277 : loss : 0.811690, loss_ce: 1.331409
[09:53:46.151] train iteration 4327 : loss : 0.765821, loss_ce: 1.039672
[09:54:06.007] train iteration 4377 : loss : 0.680763, loss_ce: 0.931824
[09:54:25.931] train iteration 4427 : loss : 0.601610, loss_ce: 0.836124
[09:54:33.320] val epoch 16 : f1_micro : 0.5887729440416608, f1_macro : 0.4350844972899982, tumor_f1 : 0.6549408691270011, stroma_f1 : 0.5329025462269783, infla_f1 : 0.5739470911877496, necr_f1 : 0.8355617693492344, other_f1 : 0.382323610995497, acc_micro : 0.8355617693492344
[09:54:34.799] train iteration 4438 : loss : 0.643639, loss_ce: 0.783763
[09:54:54.480] train iteration 4488 : loss : 0.620209, loss_ce: 0.805304
[09:55:14.352] train iteration 4538 : loss : 0.766492, loss_ce: 1.009423
[09:55:34.227] train iteration 4588 : loss : 0.462339, loss_ce: 0.589179
[09:55:54.150] train iteration 4638 : loss : 0.520975, loss_ce: 0.652187
[09:56:14.120] train iteration 4688 : loss : 0.880603, loss_ce: 1.287589
[09:56:21.604] val epoch 17 : f1_micro : 0.6141708024910518, f1_macro : 0.45505218527146746, tumor_f1 : 0.6969084909984044, stroma_f1 : 0.5446682050824165, infla_f1 : 0.5963356154305595, necr_f1 : 0.8457390538283757, other_f1 : 0.3472375880394663, acc_micro : 0.8457390538283757
[09:56:23.121] train iteration 4699 : loss : 0.564824, loss_ce: 0.643225
[09:56:42.792] train iteration 4749 : loss : 0.711122, loss_ce: 0.941859
[09:57:02.542] train iteration 4799 : loss : 0.721011, loss_ce: 0.914586
[09:57:22.446] train iteration 4849 : loss : 0.649401, loss_ce: 0.699652
[09:57:42.445] train iteration 4899 : loss : 0.518226, loss_ce: 0.663104
[09:58:02.279] train iteration 4949 : loss : 0.884295, loss_ce: 1.302512
[09:58:09.766] val epoch 18 : f1_micro : 0.6150626157011304, f1_macro : 0.44011187979153227, tumor_f1 : 0.686092734336853, stroma_f1 : 0.6079210266470909, infla_f1 : 0.4250446063067232, necr_f1 : 0.8460478484630585, other_f1 : 0.38366762841386454, acc_micro : 0.8460478484630585
[09:58:11.275] train iteration 4960 : loss : 0.751551, loss_ce: 0.963382
[09:58:30.960] train iteration 5010 : loss : 0.647831, loss_ce: 0.939453
[09:58:50.843] train iteration 5060 : loss : 0.535190, loss_ce: 0.698166
[09:59:10.720] train iteration 5110 : loss : 0.706422, loss_ce: 0.841270
[09:59:30.614] train iteration 5160 : loss : 0.451574, loss_ce: 0.606223
[09:59:50.473] train iteration 5210 : loss : 0.807326, loss_ce: 1.110117
[09:59:58.044] val epoch 19 : f1_micro : 0.5951576701232365, f1_macro : 0.45074008085897993, tumor_f1 : 0.6956461987325123, stroma_f1 : 0.5174436526639121, infla_f1 : 0.5477591710431235, necr_f1 : 0.8380922632558006, other_f1 : 0.3988111157502447, acc_micro : 0.8380922632558006
[09:59:59.544] train iteration 5221 : loss : 0.541475, loss_ce: 0.607618
[10:00:19.215] train iteration 5271 : loss : 0.615711, loss_ce: 0.771303
[10:00:38.944] train iteration 5321 : loss : 0.608068, loss_ce: 0.868814
[10:00:58.864] train iteration 5371 : loss : 0.672579, loss_ce: 0.814239
[10:01:18.717] train iteration 5421 : loss : 0.811400, loss_ce: 1.217309
[10:01:38.558] train iteration 5471 : loss : 0.569993, loss_ce: 0.782243
[10:01:46.082] val epoch 20 : f1_micro : 0.671536019870213, f1_macro : 0.5080100127628872, tumor_f1 : 0.7110759403024401, stroma_f1 : 0.6524231348718915, infla_f1 : 0.5773797748344285, necr_f1 : 0.868645042181015, other_f1 : 0.3679046742618084, acc_micro : 0.868645042181015
[10:01:47.577] train iteration 5482 : loss : 0.766373, loss_ce: 1.108677
[10:02:07.254] train iteration 5532 : loss : 0.673817, loss_ce: 0.830037
[10:02:27.130] train iteration 5582 : loss : 0.529665, loss_ce: 0.718437
[10:02:47.021] train iteration 5632 : loss : 0.604824, loss_ce: 0.674583
[10:03:06.839] train iteration 5682 : loss : 0.604443, loss_ce: 0.816510
[10:03:26.745] train iteration 5732 : loss : 0.524567, loss_ce: 0.580161
[10:03:34.256] val epoch 21 : f1_micro : 0.6320619796003614, f1_macro : 0.47636525865112034, tumor_f1 : 0.6996700784989766, stroma_f1 : 0.5657699895756585, infla_f1 : 0.6136205494403839, necr_f1 : 0.8528772166797093, other_f1 : 0.388539548431124, acc_micro : 0.8528772166797093
[10:03:35.724] train iteration 5743 : loss : 0.805842, loss_ce: 1.047143
[10:03:55.403] train iteration 5793 : loss : 0.711882, loss_ce: 0.972279
[10:04:15.238] train iteration 5843 : loss : 0.730406, loss_ce: 0.997121
[10:04:35.160] train iteration 5893 : loss : 0.588454, loss_ce: 0.738252
[10:04:55.026] train iteration 5943 : loss : 0.606336, loss_ce: 0.726040
[10:05:14.977] train iteration 5993 : loss : 0.418790, loss_ce: 0.601464
[10:05:22.462] val epoch 22 : f1_micro : 0.6528202401740211, f1_macro : 0.4727660758154733, tumor_f1 : 0.7104955251727786, stroma_f1 : 0.6191159305827958, infla_f1 : 0.5961049624851772, necr_f1 : 0.8611524786267962, other_f1 : 0.3793615595038448, acc_micro : 0.8611524786267962
[10:05:24.006] train iteration 6004 : loss : 0.624454, loss_ce: 0.866425
[10:05:43.684] train iteration 6054 : loss : 0.638974, loss_ce: 0.840341
[10:06:03.521] train iteration 6104 : loss : 0.659443, loss_ce: 0.898601
[10:06:23.450] train iteration 6154 : loss : 0.666308, loss_ce: 0.936570
[10:06:43.481] train iteration 6204 : loss : 0.487795, loss_ce: 0.651689
[10:07:03.430] train iteration 6254 : loss : 0.661241, loss_ce: 0.782819
[10:07:10.897] val epoch 23 : f1_micro : 0.6503236357654844, f1_macro : 0.49559480803353445, tumor_f1 : 0.6928101905754634, stroma_f1 : 0.6148955374956131, infla_f1 : 0.5600035647928182, necr_f1 : 0.8601494431495667, other_f1 : 0.39464440249970983, acc_micro : 0.8601494431495667
[10:07:12.389] train iteration 6265 : loss : 0.680180, loss_ce: 0.996891
[10:07:32.069] train iteration 6315 : loss : 0.792359, loss_ce: 1.173322
[10:07:51.896] train iteration 6365 : loss : 0.723942, loss_ce: 1.015568
[10:08:11.861] train iteration 6415 : loss : 0.439655, loss_ce: 0.678918
[10:08:31.779] train iteration 6465 : loss : 0.592349, loss_ce: 0.901746
[10:08:51.707] train iteration 6515 : loss : 0.729945, loss_ce: 1.054988
[10:08:59.122] val epoch 24 : f1_micro : 0.67201814694064, f1_macro : 0.48941097940717426, tumor_f1 : 0.7171292049544198, stroma_f1 : 0.647611283830234, infla_f1 : 0.5811973703759057, necr_f1 : 0.8689088863985879, other_f1 : 0.3908517839653151, acc_micro : 0.8689088863985879
[10:09:00.634] train iteration 6526 : loss : 0.560364, loss_ce: 0.670711
[10:09:20.332] train iteration 6576 : loss : 0.562063, loss_ce: 0.641455
[10:09:40.278] train iteration 6626 : loss : 0.807842, loss_ce: 1.117702
[10:10:00.154] train iteration 6676 : loss : 0.509279, loss_ce: 0.766482
[10:10:20.050] train iteration 6726 : loss : 0.548061, loss_ce: 0.703549
[10:10:39.923] train iteration 6776 : loss : 0.674913, loss_ce: 1.041365
[10:10:47.646] val epoch 25 : f1_micro : 0.6228658663375037, f1_macro : 0.4700056899871145, tumor_f1 : 0.7033913965736117, stroma_f1 : 0.5380516658936229, infla_f1 : 0.5984378584793636, necr_f1 : 0.8492211486612048, other_f1 : 0.397267755653177, acc_micro : 0.8492211486612048
[10:10:49.205] train iteration 6787 : loss : 0.714274, loss_ce: 1.027733
[10:11:08.875] train iteration 6837 : loss : 0.554215, loss_ce: 0.680783
[10:11:28.765] train iteration 6887 : loss : 0.435991, loss_ce: 0.549650
[10:11:48.680] train iteration 6937 : loss : 0.836394, loss_ce: 1.152901
[10:12:08.621] train iteration 6987 : loss : 0.815273, loss_ce: 1.148802
[10:12:28.578] train iteration 7037 : loss : 0.632634, loss_ce: 0.848689
[10:12:36.012] val epoch 26 : f1_micro : 0.6488178010497775, f1_macro : 0.4932821754898344, tumor_f1 : 0.7032905838319233, stroma_f1 : 0.5882819262998444, infla_f1 : 0.6364988152469907, necr_f1 : 0.859584778547287, other_f1 : 0.41285778262785505, acc_micro : 0.859584778547287
[10:12:37.532] train iteration 7048 : loss : 0.598912, loss_ce: 0.806482
[10:12:57.214] train iteration 7098 : loss : 0.620579, loss_ce: 0.721386
[10:13:17.059] train iteration 7148 : loss : 0.656135, loss_ce: 0.921937
[10:13:37.093] train iteration 7198 : loss : 0.468129, loss_ce: 0.556250
[10:13:56.930] train iteration 7248 : loss : 0.720873, loss_ce: 0.926205
[10:14:16.850] train iteration 7298 : loss : 0.636790, loss_ce: 0.868216
[10:14:24.248] val epoch 27 : f1_micro : 0.6337954146521432, f1_macro : 0.4717248412115233, tumor_f1 : 0.6929138089929309, stroma_f1 : 0.5851007817046983, infla_f1 : 0.5853556576850159, necr_f1 : 0.8535480839865548, other_f1 : 0.3966856018773147, acc_micro : 0.8535480839865548
[10:14:25.799] train iteration 7309 : loss : 0.452535, loss_ce: 0.501937
[10:14:45.472] train iteration 7359 : loss : 0.831372, loss_ce: 1.137792
[10:15:05.340] train iteration 7409 : loss : 0.620054, loss_ce: 0.830388
[10:15:25.308] train iteration 7459 : loss : 0.559728, loss_ce: 0.794314
[10:15:45.248] train iteration 7509 : loss : 0.737863, loss_ce: 1.009649
[10:16:05.146] train iteration 7559 : loss : 0.618343, loss_ce: 0.905712
[10:16:12.630] val epoch 28 : f1_micro : 0.6338195587907519, f1_macro : 0.48062168593917576, tumor_f1 : 0.7086356409958431, stroma_f1 : 0.562659427523613, infla_f1 : 0.6223818532058171, necr_f1 : 0.8536104474748883, other_f1 : 0.403633819094726, acc_micro : 0.8536104474748883
[10:16:14.167] train iteration 7570 : loss : 0.725478, loss_ce: 0.970751
[10:16:33.831] train iteration 7620 : loss : 0.497100, loss_ce: 0.599111
[10:16:53.804] train iteration 7670 : loss : 0.546808, loss_ce: 0.567892
[10:17:13.775] train iteration 7720 : loss : 0.646814, loss_ce: 0.778196
[10:17:33.600] train iteration 7770 : loss : 0.615073, loss_ce: 0.858402
[10:17:53.554] train iteration 7820 : loss : 0.694883, loss_ce: 0.871956
[10:18:00.995] val epoch 29 : f1_micro : 0.5916341745427677, f1_macro : 0.4449481836387089, tumor_f1 : 0.7053778214114053, stroma_f1 : 0.5110401255743844, infla_f1 : 0.5413768206323896, necr_f1 : 0.8367029598781041, other_f1 : 0.37871961985781255, acc_micro : 0.8367029598781041
[10:18:02.498] train iteration 7831 : loss : 0.649839, loss_ce: 0.913653
[10:18:22.182] train iteration 7881 : loss : 0.625255, loss_ce: 0.901625
[10:18:42.048] train iteration 7931 : loss : 0.631105, loss_ce: 0.711035
[10:19:01.906] train iteration 7981 : loss : 0.620076, loss_ce: 0.800183
[10:19:21.928] train iteration 8031 : loss : 0.544028, loss_ce: 0.669208
[10:19:41.792] train iteration 8081 : loss : 0.526864, loss_ce: 0.735081
[10:19:49.195] val epoch 30 : f1_micro : 0.6147838447775159, f1_macro : 0.4699903556278774, tumor_f1 : 0.7035124195473534, stroma_f1 : 0.5427777682031903, infla_f1 : 0.5831091297524316, necr_f1 : 0.8459475636482239, other_f1 : 0.3773184424000127, acc_micro : 0.8459475636482239
[10:19:50.628] train iteration 8092 : loss : 0.652990, loss_ce: 0.939519
[10:20:10.313] train iteration 8142 : loss : 0.575267, loss_ce: 0.838663
[10:20:30.204] train iteration 8192 : loss : 0.618908, loss_ce: 0.851352
[10:20:50.154] train iteration 8242 : loss : 0.444455, loss_ce: 0.702422
[10:21:10.029] train iteration 8292 : loss : 0.705079, loss_ce: 0.874354
[10:21:30.023] train iteration 8342 : loss : 0.836752, loss_ce: 1.154576
[10:21:37.396] val epoch 31 : f1_micro : 0.6216713402952466, f1_macro : 0.47033589652606417, tumor_f1 : 0.7168207530464444, stroma_f1 : 0.5294072755745479, infla_f1 : 0.616171413234302, necr_f1 : 0.8487255019801003, other_f1 : 0.38506098304476055, acc_micro : 0.8487255019801003
[10:21:38.848] train iteration 8353 : loss : 0.526189, loss_ce: 0.633978
[10:21:58.513] train iteration 8403 : loss : 0.530141, loss_ce: 0.713947
[10:22:18.273] train iteration 8453 : loss : 0.412817, loss_ce: 0.554677
[10:22:38.158] train iteration 8503 : loss : 0.524240, loss_ce: 0.634944
[10:22:58.040] train iteration 8553 : loss : 0.689779, loss_ce: 0.895303
[10:23:18.020] train iteration 8603 : loss : 0.582618, loss_ce: 0.742315
[10:23:25.455] val epoch 32 : f1_micro : 0.6214150871549334, f1_macro : 0.48896430858543943, tumor_f1 : 0.7241647690534592, stroma_f1 : 0.5297601744532585, infla_f1 : 0.643272135306948, necr_f1 : 0.8485935756138393, other_f1 : 0.3933550630130672, acc_micro : 0.8485935756138393
[10:23:26.934] train iteration 8614 : loss : 0.578852, loss_ce: 0.748156
[10:23:46.611] train iteration 8664 : loss : 0.709090, loss_ce: 1.005796
[10:24:06.412] train iteration 8714 : loss : 0.537684, loss_ce: 0.680322
[10:24:26.363] train iteration 8764 : loss : 0.791291, loss_ce: 1.124525
[10:24:46.205] train iteration 8814 : loss : 0.452307, loss_ce: 0.551613
[10:25:06.134] train iteration 8864 : loss : 0.764296, loss_ce: 0.991864
[10:25:13.694] val epoch 33 : f1_micro : 0.6149059725659234, f1_macro : 0.4748500351394926, tumor_f1 : 0.6961479548897062, stroma_f1 : 0.5547799989581108, infla_f1 : 0.5706847512296268, necr_f1 : 0.845991279397692, other_f1 : 0.3950098319245236, acc_micro : 0.845991279397692
[10:25:15.201] train iteration 8875 : loss : 0.715279, loss_ce: 0.834669
[10:25:34.868] train iteration 8925 : loss : 0.538186, loss_ce: 0.792039
[10:25:54.632] train iteration 8975 : loss : 0.616806, loss_ce: 0.882707
[10:26:14.530] train iteration 9025 : loss : 0.546315, loss_ce: 0.523298
[10:26:34.489] train iteration 9075 : loss : 0.655343, loss_ce: 0.765551
[10:26:54.404] train iteration 9125 : loss : 0.730089, loss_ce: 1.064411
[10:27:01.879] val epoch 34 : f1_micro : 0.6726254905973162, f1_macro : 0.5354275107383728, tumor_f1 : 0.7228099043880191, stroma_f1 : 0.6405375301837921, infla_f1 : 0.6142214472804751, necr_f1 : 0.8691230842045375, other_f1 : 0.3859792988015605, acc_micro : 0.8691230842045375
[10:27:03.349] train iteration 9136 : loss : 0.684059, loss_ce: 0.871234
[10:27:23.020] train iteration 9186 : loss : 0.819854, loss_ce: 1.187887
[10:27:42.838] train iteration 9236 : loss : 0.551468, loss_ce: 0.640576
[10:28:02.773] train iteration 9286 : loss : 0.596228, loss_ce: 0.782921
[10:28:22.543] train iteration 9336 : loss : 0.715961, loss_ce: 0.982426
[10:28:42.401] train iteration 9386 : loss : 0.590687, loss_ce: 0.740803
[10:28:49.763] val epoch 35 : f1_micro : 0.6070497930049896, f1_macro : 0.4772482897554125, tumor_f1 : 0.7263463480131966, stroma_f1 : 0.5162057780793735, infla_f1 : 0.629473381808826, necr_f1 : 0.8428666549069541, other_f1 : 0.3959175555833748, acc_micro : 0.8428666549069541
[10:28:51.310] train iteration 9397 : loss : 0.550759, loss_ce: 0.677664
[10:29:10.989] train iteration 9447 : loss : 0.719342, loss_ce: 0.970629
[10:29:30.735] train iteration 9497 : loss : 0.484551, loss_ce: 0.551659
[10:29:50.702] train iteration 9547 : loss : 0.656687, loss_ce: 0.832899
[10:30:10.561] train iteration 9597 : loss : 0.644070, loss_ce: 0.879783
[10:30:30.455] train iteration 9647 : loss : 0.505980, loss_ce: 0.680252
[10:30:37.993] val epoch 36 : f1_micro : 0.6674380046980721, f1_macro : 0.524766994374139, tumor_f1 : 0.7384377547672817, stroma_f1 : 0.5887845946209771, infla_f1 : 0.5864847408873695, necr_f1 : 0.8670392206736973, other_f1 : 0.39405833557248116, acc_micro : 0.8670392206736973
[10:30:39.463] train iteration 9658 : loss : 0.621570, loss_ce: 0.717842
[10:30:59.125] train iteration 9708 : loss : 0.570717, loss_ce: 0.770687
[10:31:18.892] train iteration 9758 : loss : 0.601068, loss_ce: 0.770931
[10:31:38.707] train iteration 9808 : loss : 0.672850, loss_ce: 0.826044
[10:31:58.705] train iteration 9858 : loss : 0.688512, loss_ce: 0.862415
[10:32:18.463] train iteration 9908 : loss : 0.437521, loss_ce: 0.569689
[10:32:25.928] val epoch 37 : f1_micro : 0.6440971429858889, f1_macro : 0.5229021928140095, tumor_f1 : 0.6998443497078759, stroma_f1 : 0.6078435289008277, infla_f1 : 0.6002611400825637, necr_f1 : 0.8577041157654354, other_f1 : 0.40546954955373493, acc_micro : 0.8577041157654354
[10:32:27.345] train iteration 9919 : loss : 0.467460, loss_ce: 0.659623
[10:32:47.016] train iteration 9969 : loss : 0.683329, loss_ce: 1.108446
[10:33:06.739] train iteration 10019 : loss : 0.541428, loss_ce: 0.647131
[10:33:26.641] train iteration 10069 : loss : 0.638011, loss_ce: 0.712690
[10:33:46.614] train iteration 10119 : loss : 0.601121, loss_ce: 0.817051
[10:34:06.448] train iteration 10169 : loss : 0.691263, loss_ce: 0.832412
[10:34:13.945] val epoch 38 : f1_micro : 0.6656426127467837, f1_macro : 0.5150618361575263, tumor_f1 : 0.7177012860774994, stroma_f1 : 0.6106289220707757, infla_f1 : 0.6197305885808808, necr_f1 : 0.8663259148597717, other_f1 : 0.402552316231387, acc_micro : 0.8663259148597717
[10:34:15.445] train iteration 10180 : loss : 0.471701, loss_ce: 0.622002
[10:34:35.128] train iteration 10230 : loss : 0.714396, loss_ce: 0.895979
[10:34:54.882] train iteration 10280 : loss : 0.473104, loss_ce: 0.633749
[10:35:14.811] train iteration 10330 : loss : 0.676142, loss_ce: 0.958981
[10:35:34.774] train iteration 10380 : loss : 0.502867, loss_ce: 0.627555
[10:35:54.546] train iteration 10430 : loss : 0.606238, loss_ce: 0.774610
[10:36:02.049] val epoch 39 : f1_micro : 0.6251929466213498, f1_macro : 0.4641079881361553, tumor_f1 : 0.7077578604221344, stroma_f1 : 0.5660312303474971, infla_f1 : 0.5686855635930053, necr_f1 : 0.8501048598970685, other_f1 : 0.3778890754495348, acc_micro : 0.8501048598970685
[10:36:03.578] train iteration 10441 : loss : 0.505785, loss_ce: 0.584540
[10:36:23.243] train iteration 10491 : loss : 0.428862, loss_ce: 0.574029
[10:36:42.983] train iteration 10541 : loss : 0.563134, loss_ce: 0.720770
[10:37:02.853] train iteration 10591 : loss : 0.442492, loss_ce: 0.557309
[10:37:22.773] train iteration 10641 : loss : 0.630439, loss_ce: 0.826471
[10:37:42.536] train iteration 10691 : loss : 0.424540, loss_ce: 0.657554
[10:37:49.944] val epoch 40 : f1_micro : 0.6598773321935109, f1_macro : 0.4956609904766083, tumor_f1 : 0.7417305771793637, stroma_f1 : 0.5761927350291184, infla_f1 : 0.5951553945030484, necr_f1 : 0.8639918778623853, other_f1 : 0.3884693309664726, acc_micro : 0.8639918778623853
[10:37:51.407] train iteration 10702 : loss : 0.540032, loss_ce: 0.724706
[10:38:11.076] train iteration 10752 : loss : 0.454100, loss_ce: 0.588243
[10:38:30.806] train iteration 10802 : loss : 0.702161, loss_ce: 1.021699
[10:38:50.671] train iteration 10852 : loss : 0.594106, loss_ce: 0.908186
[10:39:10.515] train iteration 10902 : loss : 0.527263, loss_ce: 0.557679
[10:39:30.476] train iteration 10952 : loss : 0.485335, loss_ce: 0.614761
[10:39:38.080] val epoch 41 : f1_micro : 0.6585935609681266, f1_macro : 0.5247526722294944, tumor_f1 : 0.721231398837907, stroma_f1 : 0.5913397584642682, infla_f1 : 0.5892860242830855, necr_f1 : 0.8634732365608215, other_f1 : 0.38940783004675594, acc_micro : 0.8634732365608215
[10:39:39.600] train iteration 10963 : loss : 0.614579, loss_ce: 0.852138
[10:39:59.263] train iteration 11013 : loss : 0.605679, loss_ce: 0.838142
[10:40:19.023] train iteration 11063 : loss : 0.672537, loss_ce: 0.944361
[10:40:38.959] train iteration 11113 : loss : 0.640950, loss_ce: 0.730253
[10:40:58.878] train iteration 11163 : loss : 0.516865, loss_ce: 0.620814
[10:41:18.721] train iteration 11213 : loss : 0.758421, loss_ce: 1.038285
[10:41:26.198] val epoch 42 : f1_micro : 0.6487172394990921, f1_macro : 0.5394841347421918, tumor_f1 : 0.7482292481831142, stroma_f1 : 0.5390322868313108, infla_f1 : 0.6608097319092069, necr_f1 : 0.8595191240310669, other_f1 : 0.38010877344225136, acc_micro : 0.8595191240310669
[10:41:27.648] train iteration 11224 : loss : 0.341001, loss_ce: 0.590656
[10:41:47.328] train iteration 11274 : loss : 0.620566, loss_ce: 0.896056
[10:42:07.189] train iteration 11324 : loss : 0.626874, loss_ce: 0.793958
[10:42:27.095] train iteration 11374 : loss : 0.512644, loss_ce: 0.696426
[10:42:46.995] train iteration 11424 : loss : 0.537852, loss_ce: 0.681850
[10:43:06.827] train iteration 11474 : loss : 0.624095, loss_ce: 0.796497
[10:43:14.415] val epoch 43 : f1_micro : 0.6741489129407066, f1_macro : 0.5461663092885699, tumor_f1 : 0.7350126930645534, stroma_f1 : 0.6140940253223691, infla_f1 : 0.5737470037170819, necr_f1 : 0.8696794722761426, other_f1 : 0.36935776764793055, acc_micro : 0.8696794722761426
[10:43:15.965] train iteration 11485 : loss : 0.647674, loss_ce: 0.926740
[10:43:35.639] train iteration 11535 : loss : 0.530750, loss_ce: 0.673380
[10:43:55.391] train iteration 11585 : loss : 0.647727, loss_ce: 0.875957
[10:44:15.279] train iteration 11635 : loss : 0.611032, loss_ce: 0.697405
[10:44:35.181] train iteration 11685 : loss : 0.760145, loss_ce: 1.034440
[10:44:55.057] train iteration 11735 : loss : 0.488608, loss_ce: 0.534472
[10:45:02.591] val epoch 44 : f1_micro : 0.6196285635232925, f1_macro : 0.500461112175669, tumor_f1 : 0.7232196756771633, stroma_f1 : 0.5183767431548664, infla_f1 : 0.6086113963808332, necr_f1 : 0.847915381193161, other_f1 : 0.39278190370116917, acc_micro : 0.847915381193161
[10:45:04.161] train iteration 11746 : loss : 0.511110, loss_ce: 0.689681
[10:45:23.828] train iteration 11796 : loss : 0.790269, loss_ce: 1.092890
[10:45:43.645] train iteration 11846 : loss : 0.454059, loss_ce: 0.592933
[10:46:03.502] train iteration 11896 : loss : 0.745335, loss_ce: 1.077897
[10:46:23.490] train iteration 11946 : loss : 0.628950, loss_ce: 0.863519
[10:46:43.420] train iteration 11996 : loss : 0.556829, loss_ce: 0.728714
[10:46:50.924] val epoch 45 : f1_micro : 0.6689798065594265, f1_macro : 0.5324261358806065, tumor_f1 : 0.7084177391869682, stroma_f1 : 0.6278323041541236, infla_f1 : 0.592886066862515, necr_f1 : 0.867608483348574, other_f1 : 0.3842666707932949, acc_micro : 0.867608483348574
[10:46:52.486] train iteration 12007 : loss : 0.754381, loss_ce: 1.034662
[10:47:12.158] train iteration 12057 : loss : 0.587304, loss_ce: 0.864591
[10:47:31.888] train iteration 12107 : loss : 0.537112, loss_ce: 0.823451
[10:47:51.765] train iteration 12157 : loss : 0.655493, loss_ce: 0.922996
[10:48:11.731] train iteration 12207 : loss : 0.475389, loss_ce: 0.700724
[10:48:31.654] train iteration 12257 : loss : 0.309308, loss_ce: 0.410975
[10:48:39.086] val epoch 46 : f1_micro : 0.6371111103466579, f1_macro : 0.5042341287646975, tumor_f1 : 0.7263483596699578, stroma_f1 : 0.5484430646257741, infla_f1 : 0.5919484453541892, necr_f1 : 0.8548694508416312, other_f1 : 0.36329004753913197, acc_micro : 0.8548694508416312
[10:48:40.487] train iteration 12268 : loss : 0.719718, loss_ce: 1.090745
[10:49:00.165] train iteration 12318 : loss : 0.528797, loss_ce: 0.671168
[10:49:19.982] train iteration 12368 : loss : 0.649202, loss_ce: 0.720851
[10:49:39.850] train iteration 12418 : loss : 0.709846, loss_ce: 0.922716
[10:49:59.707] train iteration 12468 : loss : 0.821679, loss_ce: 1.144491
[10:50:19.630] train iteration 12518 : loss : 0.610005, loss_ce: 0.893144
[10:50:27.094] val epoch 47 : f1_micro : 0.6180789193936757, f1_macro : 0.5133811767612185, tumor_f1 : 0.7371858656406403, stroma_f1 : 0.5123974638325828, infla_f1 : 0.6735885611602238, necr_f1 : 0.8472734902586255, other_f1 : 0.39135978986243053, acc_micro : 0.8472734902586255
[10:50:28.564] train iteration 12529 : loss : 0.660084, loss_ce: 0.798239
[10:50:48.246] train iteration 12579 : loss : 0.679784, loss_ce: 0.872343
[10:51:07.981] train iteration 12629 : loss : 0.603795, loss_ce: 0.872688
[10:51:27.861] train iteration 12679 : loss : 0.546776, loss_ce: 0.709207
[10:51:47.831] train iteration 12729 : loss : 0.798085, loss_ce: 1.100464
[10:52:07.654] train iteration 12779 : loss : 0.588703, loss_ce: 0.686872
[10:52:15.140] val epoch 48 : f1_micro : 0.6858798733779362, f1_macro : 0.523074169244085, tumor_f1 : 0.7553976710353579, stroma_f1 : 0.606667405792645, infla_f1 : 0.5984752966490176, necr_f1 : 0.8744379452296666, other_f1 : 0.37974657118320465, acc_micro : 0.8744379452296666
[10:52:16.641] train iteration 12790 : loss : 0.610205, loss_ce: 0.797496
[10:52:36.318] train iteration 12840 : loss : 0.493307, loss_ce: 0.686993
[10:52:56.140] train iteration 12890 : loss : 0.675463, loss_ce: 0.935373
[10:53:16.011] train iteration 12940 : loss : 0.571370, loss_ce: 0.716303
[10:53:35.876] train iteration 12990 : loss : 0.765672, loss_ce: 0.985355
[10:53:55.738] train iteration 13040 : loss : 0.536494, loss_ce: 0.711674
[10:54:03.224] val epoch 49 : f1_micro : 0.6507639331477029, f1_macro : 0.5238075809819358, tumor_f1 : 0.7371702321938106, stroma_f1 : 0.5563563661915916, infla_f1 : 0.66934021455901, necr_f1 : 0.8603567438466209, other_f1 : 0.39443304509456667, acc_micro : 0.8603567438466209
[10:54:04.736] train iteration 13051 : loss : 0.544605, loss_ce: 0.720909
[10:54:24.415] train iteration 13101 : loss : 0.617690, loss_ce: 0.713966
[10:54:44.199] train iteration 13151 : loss : 0.592848, loss_ce: 0.868680
[10:55:04.076] train iteration 13201 : loss : 0.605419, loss_ce: 0.922935
[10:55:23.943] train iteration 13251 : loss : 0.563071, loss_ce: 0.841293
[10:55:43.872] train iteration 13301 : loss : 0.622678, loss_ce: 0.858185
[10:55:51.415] val epoch 50 : f1_micro : 0.6731408664158413, f1_macro : 0.5557916739157268, tumor_f1 : 0.7418227940797806, stroma_f1 : 0.6043448575905391, infla_f1 : 0.6411917135119438, necr_f1 : 0.8693055084773472, other_f1 : 0.4224045989768846, acc_micro : 0.8693055084773472
[10:55:52.959] train iteration 13312 : loss : 0.686858, loss_ce: 0.862622
[10:56:12.634] train iteration 13362 : loss : 0.640440, loss_ce: 0.851834
[10:56:32.411] train iteration 13412 : loss : 0.634039, loss_ce: 0.806859
[10:56:52.333] train iteration 13462 : loss : 0.557054, loss_ce: 0.793443
[10:57:12.141] train iteration 13512 : loss : 0.713315, loss_ce: 0.938803
[10:57:32.061] train iteration 13562 : loss : 0.586085, loss_ce: 0.708418
[10:57:39.490] val epoch 51 : f1_micro : 0.6385641396045685, f1_macro : 0.5099451392889023, tumor_f1 : 0.7465601733752659, stroma_f1 : 0.5339944431824344, infla_f1 : 0.6623076157910484, necr_f1 : 0.8554641008377075, other_f1 : 0.39597086501973017, acc_micro : 0.8554641008377075
[10:57:40.974] train iteration 13573 : loss : 0.384915, loss_ce: 0.533411
[10:58:00.645] train iteration 13623 : loss : 0.594854, loss_ce: 0.628167
[10:58:20.397] train iteration 13673 : loss : 0.505138, loss_ce: 0.673472
[10:58:40.313] train iteration 13723 : loss : 0.605932, loss_ce: 0.619300
[10:59:00.153] train iteration 13773 : loss : 0.598056, loss_ce: 0.719923
[10:59:19.941] train iteration 13823 : loss : 0.420280, loss_ce: 0.575908
[10:59:27.472] val epoch 52 : f1_micro : 0.63799116228308, f1_macro : 0.5186098579849515, tumor_f1 : 0.7330929934978485, stroma_f1 : 0.5327325010938304, infla_f1 : 0.6497649805886405, necr_f1 : 0.8552215482507434, other_f1 : 0.37950952038435, acc_micro : 0.8552215482507434
[10:59:29.046] train iteration 13834 : loss : 0.791583, loss_ce: 1.186896
[10:59:48.725] train iteration 13884 : loss : 0.568774, loss_ce: 0.813361
[11:00:08.505] train iteration 13934 : loss : 0.607433, loss_ce: 0.867823
[11:00:28.344] train iteration 13984 : loss : 0.500971, loss_ce: 0.621018
[11:00:48.225] train iteration 14034 : loss : 0.449238, loss_ce: 0.645484
[11:01:08.086] train iteration 14084 : loss : 0.816388, loss_ce: 1.221654
[11:01:15.627] val epoch 53 : f1_micro : 0.6699146521942956, f1_macro : 0.5385170876979828, tumor_f1 : 0.7407021224498749, stroma_f1 : 0.5917813373463494, infla_f1 : 0.6581704365754766, necr_f1 : 0.8680044327463422, other_f1 : 0.3802797075893198, acc_micro : 0.8680044327463422
[11:01:17.144] train iteration 14095 : loss : 0.566780, loss_ce: 0.602781
[11:01:36.820] train iteration 14145 : loss : 0.682388, loss_ce: 0.871245
[11:01:56.649] train iteration 14195 : loss : 0.583451, loss_ce: 0.765745
[11:02:16.493] train iteration 14245 : loss : 0.573228, loss_ce: 0.792179
[11:02:36.366] train iteration 14295 : loss : 0.803448, loss_ce: 1.166719
[11:02:56.224] train iteration 14345 : loss : 0.654446, loss_ce: 0.970658
[11:03:03.773] val epoch 54 : f1_micro : 0.6373401262930461, f1_macro : 0.4949693392430033, tumor_f1 : 0.6965391508170536, stroma_f1 : 0.5962975195475987, infla_f1 : 0.5137951831732478, necr_f1 : 0.8549602627754211, other_f1 : 0.4033603021608932, acc_micro : 0.8549602627754211
[11:03:05.163] train iteration 14356 : loss : 0.510132, loss_ce: 0.724500
[11:03:24.866] train iteration 14406 : loss : 0.521026, loss_ce: 0.676369
[11:03:44.574] train iteration 14456 : loss : 0.652757, loss_ce: 0.795806
[11:04:04.557] train iteration 14506 : loss : 0.387088, loss_ce: 0.563083
[11:04:24.510] train iteration 14556 : loss : 0.540058, loss_ce: 0.660251
[11:04:44.318] train iteration 14606 : loss : 0.588571, loss_ce: 0.777427
[11:04:51.788] val epoch 55 : f1_micro : 0.6277916197265897, f1_macro : 0.5169305609805244, tumor_f1 : 0.7443333885499409, stroma_f1 : 0.49451944551297594, infla_f1 : 0.6698648833802768, necr_f1 : 0.8511482392038617, other_f1 : 0.38790269089596613, acc_micro : 0.8511482392038617
[11:04:53.192] train iteration 14617 : loss : 0.400488, loss_ce: 0.501919
[11:05:12.868] train iteration 14667 : loss : 0.662353, loss_ce: 0.885611
[11:05:32.639] train iteration 14717 : loss : 0.435548, loss_ce: 0.618298
[11:05:52.462] train iteration 14767 : loss : 0.527748, loss_ce: 0.531354
[11:06:12.312] train iteration 14817 : loss : 0.721257, loss_ce: 1.118574
[11:06:32.217] train iteration 14867 : loss : 0.764252, loss_ce: 1.074125
[11:06:39.723] val epoch 56 : f1_micro : 0.6656163143260139, f1_macro : 0.5691202857664653, tumor_f1 : 0.7507846589599337, stroma_f1 : 0.5520429916546813, infla_f1 : 0.6817199502672467, necr_f1 : 0.866269588470459, other_f1 : 0.3892639071335517, acc_micro : 0.866269588470459
[11:06:41.254] train iteration 14878 : loss : 0.398844, loss_ce: 0.579704
[11:07:00.936] train iteration 14928 : loss : 0.566859, loss_ce: 0.875533
[11:07:20.627] train iteration 14978 : loss : 0.647573, loss_ce: 0.869591
[11:07:40.460] train iteration 15028 : loss : 0.688406, loss_ce: 0.958533
[11:08:00.337] train iteration 15078 : loss : 0.686823, loss_ce: 0.957988
[11:08:20.251] train iteration 15128 : loss : 0.483851, loss_ce: 0.568275
[11:08:27.747] val epoch 57 : f1_micro : 0.6181605969156537, f1_macro : 0.49138001458985464, tumor_f1 : 0.7356149277516774, stroma_f1 : 0.5097800727401461, infla_f1 : 0.6866237755332675, necr_f1 : 0.8473281519753593, other_f1 : 0.38623278867453337, acc_micro : 0.8473281519753593
[11:08:29.162] train iteration 15139 : loss : 0.710529, loss_ce: 0.906942
[11:08:48.836] train iteration 15189 : loss : 0.735569, loss_ce: 0.958243
[11:09:08.614] train iteration 15239 : loss : 0.696408, loss_ce: 1.008943
[11:09:28.452] train iteration 15289 : loss : 0.638902, loss_ce: 0.768645
[11:09:48.320] train iteration 15339 : loss : 0.614764, loss_ce: 0.840628
[11:10:08.168] train iteration 15389 : loss : 0.444691, loss_ce: 0.492526
[11:10:15.620] val epoch 58 : f1_micro : 0.6501581413405282, f1_macro : 0.5185008645057678, tumor_f1 : 0.7535428532532283, stroma_f1 : 0.5412229352763721, infla_f1 : 0.6717125278498445, necr_f1 : 0.8601235747337341, other_f1 : 0.3323195414351566, acc_micro : 0.8601235747337341
[11:10:17.147] train iteration 15400 : loss : 0.580373, loss_ce: 0.672813
[11:10:36.826] train iteration 15450 : loss : 0.650931, loss_ce: 0.923598
[11:10:56.626] train iteration 15500 : loss : 0.750557, loss_ce: 1.144031
[11:11:16.391] train iteration 15550 : loss : 0.664165, loss_ce: 0.851536
[11:11:36.341] train iteration 15600 : loss : 0.519875, loss_ce: 0.672354
[11:11:56.173] train iteration 15650 : loss : 0.419654, loss_ce: 0.441068
[11:12:03.714] val epoch 59 : f1_micro : 0.6061135594333921, f1_macro : 0.4833755599600928, tumor_f1 : 0.7349335466112409, stroma_f1 : 0.49114032089710236, infla_f1 : 0.6063853821584156, necr_f1 : 0.8425743707588741, other_f1 : 0.386383197669472, acc_micro : 0.8425743707588741
[11:12:05.220] train iteration 15661 : loss : 0.434264, loss_ce: 0.672215
[11:12:24.885] train iteration 15711 : loss : 0.468961, loss_ce: 0.551791
[11:12:44.598] train iteration 15761 : loss : 0.763464, loss_ce: 1.137106
[11:13:04.492] train iteration 15811 : loss : 0.428423, loss_ce: 0.551391
[11:13:24.342] train iteration 15861 : loss : 0.567609, loss_ce: 0.580466
[11:13:44.256] train iteration 15911 : loss : 0.431986, loss_ce: 0.436721
[11:13:51.754] val epoch 60 : f1_micro : 0.620331232036863, f1_macro : 0.5256652140191623, tumor_f1 : 0.7273076112781253, stroma_f1 : 0.5242123720901353, infla_f1 : 0.6228584093706948, necr_f1 : 0.8481638899871281, other_f1 : 0.37939000671862494, acc_micro : 0.8481638899871281
[11:13:53.244] train iteration 15922 : loss : 0.724260, loss_ce: 0.988749
[11:14:12.918] train iteration 15972 : loss : 0.442890, loss_ce: 0.585708
[11:14:32.750] train iteration 16022 : loss : 0.526368, loss_ce: 0.639217
[11:14:52.640] train iteration 16072 : loss : 0.643855, loss_ce: 0.895721
[11:15:12.501] train iteration 16122 : loss : 0.664673, loss_ce: 0.967631
[11:15:32.421] train iteration 16172 : loss : 0.492642, loss_ce: 0.657746
[11:15:39.836] val epoch 61 : f1_micro : 0.6583618564265115, f1_macro : 0.5264298170804977, tumor_f1 : 0.736765633736338, stroma_f1 : 0.5941427562917981, infla_f1 : 0.6289498571838651, necr_f1 : 0.8633795380592346, other_f1 : 0.3438160565814802, acc_micro : 0.8633795380592346
[11:15:41.294] train iteration 16183 : loss : 0.548306, loss_ce: 0.718498
[11:16:00.975] train iteration 16233 : loss : 0.626858, loss_ce: 0.890935
[11:16:20.727] train iteration 16283 : loss : 0.470072, loss_ce: 0.553191
[11:16:40.664] train iteration 16333 : loss : 0.521382, loss_ce: 0.796440
[11:17:00.528] train iteration 16383 : loss : 0.664340, loss_ce: 0.899374
[11:17:20.480] train iteration 16433 : loss : 0.443110, loss_ce: 0.528063
[11:17:28.037] val epoch 62 : f1_micro : 0.6743037721940449, f1_macro : 0.5645142559494291, tumor_f1 : 0.7497690916061401, stroma_f1 : 0.5968866944313049, infla_f1 : 0.6896804722824267, necr_f1 : 0.8697574649538312, other_f1 : 0.3322529909866197, acc_micro : 0.8697574649538312
[11:17:29.455] train iteration 16444 : loss : 0.496873, loss_ce: 0.611809
[11:17:49.129] train iteration 16494 : loss : 0.475511, loss_ce: 0.659887
[11:18:08.877] train iteration 16544 : loss : 0.395033, loss_ce: 0.444867
[11:18:28.878] train iteration 16594 : loss : 0.537372, loss_ce: 0.724096
[11:18:48.826] train iteration 16644 : loss : 0.326454, loss_ce: 0.476337
[11:19:08.711] train iteration 16694 : loss : 0.469308, loss_ce: 0.560938
[11:19:16.226] val epoch 63 : f1_micro : 0.6810545069830758, f1_macro : 0.5578675078494209, tumor_f1 : 0.7493980314050402, stroma_f1 : 0.6124922899263245, infla_f1 : 0.6643066424876451, necr_f1 : 0.872450223990849, other_f1 : 0.38446648498731, acc_micro : 0.872450223990849
[11:19:17.766] train iteration 16705 : loss : 0.485044, loss_ce: 0.710465
[11:19:37.447] train iteration 16755 : loss : 0.415330, loss_ce: 0.579593
[11:19:57.252] train iteration 16805 : loss : 0.485344, loss_ce: 0.604562
[11:20:17.223] train iteration 16855 : loss : 0.756991, loss_ce: 1.101107
[11:20:37.123] train iteration 16905 : loss : 0.620390, loss_ce: 0.839990
[11:20:57.028] train iteration 16955 : loss : 0.522046, loss_ce: 0.710820
[11:21:04.497] val epoch 64 : f1_micro : 0.6377160464014325, f1_macro : 0.5362099920000348, tumor_f1 : 0.7281410438673837, stroma_f1 : 0.5414424400244441, infla_f1 : 0.6579476807798658, necr_f1 : 0.8551129060132163, other_f1 : 0.3877598007176338, acc_micro : 0.8551129060132163
[11:21:05.973] train iteration 16966 : loss : 0.400698, loss_ce: 0.412632
[11:21:25.655] train iteration 17016 : loss : 0.601235, loss_ce: 0.771934
[11:21:45.479] train iteration 17066 : loss : 0.615892, loss_ce: 0.813183
[11:22:05.401] train iteration 17116 : loss : 0.568069, loss_ce: 0.829745
[11:22:25.292] train iteration 17166 : loss : 0.376129, loss_ce: 0.526994
[11:22:45.221] train iteration 17216 : loss : 0.622774, loss_ce: 0.781442
[11:22:52.765] val epoch 65 : f1_micro : 0.6241137044770377, f1_macro : 0.5152550829308373, tumor_f1 : 0.728876069188118, stroma_f1 : 0.5307003078716142, infla_f1 : 0.6980272318635669, necr_f1 : 0.8497209634099688, other_f1 : 0.36612455166011515, acc_micro : 0.8497209634099688
[11:22:54.320] train iteration 17227 : loss : 0.368095, loss_ce: 0.487979
[11:23:13.993] train iteration 17277 : loss : 0.456464, loss_ce: 0.531473
[11:23:33.767] train iteration 17327 : loss : 0.584650, loss_ce: 0.910306
[11:23:53.659] train iteration 17377 : loss : 0.527701, loss_ce: 0.742991
[11:24:13.669] train iteration 17427 : loss : 0.515926, loss_ce: 0.660342
[11:24:33.532] train iteration 17477 : loss : 0.496542, loss_ce: 0.716664
[11:24:40.970] val epoch 66 : f1_micro : 0.6689862821783338, f1_macro : 0.5404712025608335, tumor_f1 : 0.7436899968555996, stroma_f1 : 0.585302825484957, infla_f1 : 0.6328358118023191, necr_f1 : 0.8676264541489738, other_f1 : 0.42496783499206814, acc_micro : 0.8676264541489738
[11:24:42.457] train iteration 17488 : loss : 0.549029, loss_ce: 0.726481
[11:25:02.130] train iteration 17538 : loss : 0.566106, loss_ce: 0.761602
[11:25:21.977] train iteration 17588 : loss : 0.648846, loss_ce: 0.960912
[11:25:41.875] train iteration 17638 : loss : 0.546460, loss_ce: 0.692973
[11:26:01.738] train iteration 17688 : loss : 0.499043, loss_ce: 0.607353
[11:26:21.622] train iteration 17738 : loss : 0.470902, loss_ce: 0.699002
[11:26:29.029] val epoch 67 : f1_micro : 0.691227953348841, f1_macro : 0.5142532459327153, tumor_f1 : 0.7277589631932122, stroma_f1 : 0.6434888924871173, infla_f1 : 0.6101972343666213, necr_f1 : 0.8765403926372528, other_f1 : 0.34476264246872496, acc_micro : 0.8765403926372528
[11:26:30.550] train iteration 17749 : loss : 0.697515, loss_ce: 0.973689
[11:26:50.236] train iteration 17799 : loss : 0.622949, loss_ce: 0.717169
[11:27:10.041] train iteration 17849 : loss : 0.586049, loss_ce: 0.803653
[11:27:29.964] train iteration 17899 : loss : 0.743462, loss_ce: 0.986856
[11:27:49.844] train iteration 17949 : loss : 0.803405, loss_ce: 1.101072
[11:28:09.729] train iteration 17999 : loss : 0.645483, loss_ce: 0.848859
[11:28:17.159] val epoch 68 : f1_micro : 0.6336236468383244, f1_macro : 0.5046121605804988, tumor_f1 : 0.7429332690579551, stroma_f1 : 0.5047815718821117, infla_f1 : 0.64929846567767, necr_f1 : 0.8534907102584839, other_f1 : 0.3890594551838668, acc_micro : 0.8534907102584839
[11:28:18.661] train iteration 18010 : loss : 0.626859, loss_ce: 0.844476
[11:28:38.339] train iteration 18060 : loss : 0.663362, loss_ce: 0.955237
[11:28:58.176] train iteration 18110 : loss : 0.631476, loss_ce: 0.815312
[11:29:18.009] train iteration 18160 : loss : 0.772588, loss_ce: 1.173104
[11:29:37.992] train iteration 18210 : loss : 0.643614, loss_ce: 0.899746
[11:29:57.900] train iteration 18260 : loss : 0.498968, loss_ce: 0.654048
[11:30:05.402] val epoch 69 : f1_micro : 0.6185556607586997, f1_macro : 0.5058300473860332, tumor_f1 : 0.7565782623631614, stroma_f1 : 0.4854720208261694, infla_f1 : 0.6730491524296147, necr_f1 : 0.8475318721362523, other_f1 : 0.34073863817112787, acc_micro : 0.8475318721362523
[11:30:06.894] train iteration 18271 : loss : 0.483394, loss_ce: 0.591504
[11:30:26.559] train iteration 18321 : loss : 0.667326, loss_ce: 1.086962
[11:30:46.362] train iteration 18371 : loss : 0.531261, loss_ce: 0.688563
[11:31:06.233] train iteration 18421 : loss : 0.475443, loss_ce: 0.624773
[11:31:26.098] train iteration 18471 : loss : 0.627900, loss_ce: 0.965370
[11:31:46.029] train iteration 18521 : loss : 0.756262, loss_ce: 1.064018
[11:31:53.554] val epoch 70 : f1_micro : 0.6032496350152152, f1_macro : 0.5068252895559583, tumor_f1 : 0.720404788851738, stroma_f1 : 0.4842002352358707, infla_f1 : 0.5426501360322747, necr_f1 : 0.8413441819804055, other_f1 : 0.3987352562003902, acc_micro : 0.8413441819804055
[11:31:55.022] train iteration 18532 : loss : 0.493054, loss_ce: 0.637383
[11:32:14.705] train iteration 18582 : loss : 0.677701, loss_ce: 0.887724
[11:32:34.426] train iteration 18632 : loss : 0.496465, loss_ce: 0.747481
[11:32:54.292] train iteration 18682 : loss : 0.460910, loss_ce: 0.608319
[11:33:14.177] train iteration 18732 : loss : 0.558324, loss_ce: 0.631479
[11:33:34.155] train iteration 18782 : loss : 0.622293, loss_ce: 0.794335
[11:33:41.581] val epoch 71 : f1_micro : 0.6421993268387658, f1_macro : 0.5323076163019452, tumor_f1 : 0.737354006086077, stroma_f1 : 0.5571525341698101, infla_f1 : 0.6303490533360413, necr_f1 : 0.8569194589342389, other_f1 : 0.39461276547185015, acc_micro : 0.8569194589342389
[11:33:43.040] train iteration 18793 : loss : 0.654414, loss_ce: 0.960316
[11:34:02.719] train iteration 18843 : loss : 0.489941, loss_ce: 0.581717
[11:34:22.441] train iteration 18893 : loss : 0.427706, loss_ce: 0.541811
[11:34:42.321] train iteration 18943 : loss : 0.641313, loss_ce: 0.882376
[11:35:02.316] train iteration 18993 : loss : 0.418120, loss_ce: 0.406531
[11:35:22.132] train iteration 19043 : loss : 0.597039, loss_ce: 0.899515
[11:35:29.743] val epoch 72 : f1_micro : 0.6933365081037793, f1_macro : 0.5733173936605453, tumor_f1 : 0.7497245520353317, stroma_f1 : 0.633287579885551, infla_f1 : 0.6063788746084485, necr_f1 : 0.8773966431617737, other_f1 : 0.3970866353650178, acc_micro : 0.8773966431617737
[11:35:31.249] train iteration 19054 : loss : 0.616561, loss_ce: 0.868857
[11:35:50.922] train iteration 19104 : loss : 0.614279, loss_ce: 0.835036
[11:36:10.639] train iteration 19154 : loss : 0.597474, loss_ce: 0.878480
[11:36:30.584] train iteration 19204 : loss : 0.432078, loss_ce: 0.512891
[11:36:50.459] train iteration 19254 : loss : 0.651781, loss_ce: 0.905347
[11:37:10.405] train iteration 19304 : loss : 0.543053, loss_ce: 0.585517
[11:37:18.013] val epoch 73 : f1_micro : 0.6779948004654476, f1_macro : 0.5248013394219535, tumor_f1 : 0.7481501357895988, stroma_f1 : 0.609602116048336, infla_f1 : 0.6201257229965579, necr_f1 : 0.8712448179721832, other_f1 : 0.3501007136489664, acc_micro : 0.8712448179721832
[11:37:19.534] train iteration 19315 : loss : 0.508953, loss_ce: 0.686235
[11:37:39.207] train iteration 19365 : loss : 0.783731, loss_ce: 1.109418
[11:37:59.015] train iteration 19415 : loss : 0.476155, loss_ce: 0.647155
[11:38:18.901] train iteration 19465 : loss : 0.493992, loss_ce: 0.589152
[11:38:38.773] train iteration 19515 : loss : 0.443829, loss_ce: 0.579902
[11:38:58.789] train iteration 19565 : loss : 0.571294, loss_ce: 0.779489
[11:39:06.319] val epoch 74 : f1_micro : 0.6041646770068577, f1_macro : 0.48488509229251314, tumor_f1 : 0.7373556516000203, stroma_f1 : 0.47327902380909237, infla_f1 : 0.6246391960552761, necr_f1 : 0.8417073573384967, other_f1 : 0.3271282953210175, acc_micro : 0.8417073573384967
[11:39:07.833] train iteration 19576 : loss : 0.671225, loss_ce: 1.017064
[11:39:27.513] train iteration 19626 : loss : 0.434663, loss_ce: 0.594620
[11:39:47.361] train iteration 19676 : loss : 0.617149, loss_ce: 0.913088
[11:40:07.301] train iteration 19726 : loss : 0.622517, loss_ce: 0.944242
[11:40:27.265] train iteration 19776 : loss : 0.385571, loss_ce: 0.383503
[11:40:47.171] train iteration 19826 : loss : 0.442361, loss_ce: 0.618095
[11:40:54.564] val epoch 75 : f1_micro : 0.6225469325269971, f1_macro : 0.5026290246418544, tumor_f1 : 0.7310552980218615, stroma_f1 : 0.5375899938600404, infla_f1 : 0.5959919749626091, necr_f1 : 0.8490791491099766, other_f1 : 0.4206786389861788, acc_micro : 0.8490791491099766
[11:40:56.066] train iteration 19837 : loss : 0.512795, loss_ce: 0.656760
[11:41:15.753] train iteration 19887 : loss : 0.506149, loss_ce: 0.718345
[11:41:35.626] train iteration 19937 : loss : 0.314834, loss_ce: 0.364136
[11:41:55.552] train iteration 19987 : loss : 0.597460, loss_ce: 0.753215
[11:42:15.454] train iteration 20037 : loss : 0.784096, loss_ce: 1.199895
[11:42:35.409] train iteration 20087 : loss : 0.537151, loss_ce: 0.687817
[11:42:42.949] val epoch 76 : f1_micro : 0.650485064302172, f1_macro : 0.5494693879570279, tumor_f1 : 0.7282533113445554, stroma_f1 : 0.571363169167723, infla_f1 : 0.6541296562978199, necr_f1 : 0.8602361593927655, other_f1 : 0.39609113122735706, acc_micro : 0.8602361593927655
[11:42:44.423] train iteration 20098 : loss : 0.625137, loss_ce: 0.778559
[11:43:04.095] train iteration 20148 : loss : 0.429265, loss_ce: 0.515938
[11:43:23.923] train iteration 20198 : loss : 0.586983, loss_ce: 0.658925
[11:43:43.868] train iteration 20248 : loss : 0.447101, loss_ce: 0.462025
[11:44:03.871] train iteration 20298 : loss : 0.636318, loss_ce: 0.895419
[11:44:23.824] train iteration 20348 : loss : 0.539397, loss_ce: 0.673200
[11:44:31.261] val epoch 77 : f1_micro : 0.6306172630616597, f1_macro : 0.487992776291711, tumor_f1 : 0.7306481216635022, stroma_f1 : 0.5204505185995784, infla_f1 : 0.5841515702860696, necr_f1 : 0.8523068513189044, other_f1 : 0.38584949874452185, acc_micro : 0.8523068513189044
[11:44:32.665] train iteration 20359 : loss : 0.562682, loss_ce: 0.814136
[11:44:52.344] train iteration 20409 : loss : 0.429616, loss_ce: 0.606925
[11:45:12.154] train iteration 20459 : loss : 0.507771, loss_ce: 0.686454
[11:45:32.102] train iteration 20509 : loss : 0.539582, loss_ce: 0.532476
[11:45:52.110] train iteration 20559 : loss : 0.658463, loss_ce: 0.834694
[11:46:12.045] train iteration 20609 : loss : 0.405101, loss_ce: 0.609966
[11:46:19.565] val epoch 78 : f1_micro : 0.6297771675246102, f1_macro : 0.5166851473706109, tumor_f1 : 0.696529956800597, stroma_f1 : 0.5592129294361387, infla_f1 : 0.6626452968588897, necr_f1 : 0.8519447445869446, other_f1 : 0.4138728247157165, acc_micro : 0.8519447445869446
[11:46:21.087] train iteration 20620 : loss : 0.484215, loss_ce: 0.608900
[11:46:40.770] train iteration 20670 : loss : 0.403767, loss_ce: 0.608379
[11:47:00.512] train iteration 20720 : loss : 0.471426, loss_ce: 0.516712
[11:47:20.500] train iteration 20770 : loss : 0.436620, loss_ce: 0.475584
[11:47:40.315] train iteration 20820 : loss : 0.475787, loss_ce: 0.630877
[11:48:00.231] train iteration 20870 : loss : 0.552811, loss_ce: 0.698758
[11:48:07.719] val epoch 79 : f1_micro : 0.642901633466993, f1_macro : 0.5212379310812268, tumor_f1 : 0.746376633644104, stroma_f1 : 0.5354969991104943, infla_f1 : 0.6134597244007247, necr_f1 : 0.8572069661957877, other_f1 : 0.35566614142486025, acc_micro : 0.8572069661957877
[11:48:09.205] train iteration 20881 : loss : 0.428078, loss_ce: 0.540531
[11:48:28.875] train iteration 20931 : loss : 0.579805, loss_ce: 0.833929
[11:48:48.662] train iteration 20981 : loss : 0.517451, loss_ce: 0.636451
[11:49:08.595] train iteration 21031 : loss : 0.435285, loss_ce: 0.605069
[11:49:28.523] train iteration 21081 : loss : 0.605118, loss_ce: 0.665384
[11:49:48.428] train iteration 21131 : loss : 0.475389, loss_ce: 0.418973
[11:49:55.840] val epoch 80 : f1_micro : 0.6561816079275948, f1_macro : 0.5368740452187402, tumor_f1 : 0.7430527763707298, stroma_f1 : 0.5761864621724401, infla_f1 : 0.677826060780457, necr_f1 : 0.8625088334083557, other_f1 : 0.3393057582101652, acc_micro : 0.8625088334083557
[11:49:57.324] train iteration 21142 : loss : 0.515417, loss_ce: 0.714235
[11:50:17.013] train iteration 21192 : loss : 0.639572, loss_ce: 0.976264
[11:50:36.778] train iteration 21242 : loss : 0.431990, loss_ce: 0.573434
[11:50:56.656] train iteration 21292 : loss : 0.561945, loss_ce: 0.712302
[11:51:16.615] train iteration 21342 : loss : 0.577064, loss_ce: 0.767939
[11:51:36.411] train iteration 21392 : loss : 0.390830, loss_ce: 0.460537
[11:51:43.847] val epoch 81 : f1_micro : 0.6586628173078809, f1_macro : 0.5600788699729102, tumor_f1 : 0.7370412669011525, stroma_f1 : 0.5863410383462906, infla_f1 : 0.6066706638251033, necr_f1 : 0.8635016552039555, other_f1 : 0.417035967909864, acc_micro : 0.8635016552039555
[11:51:45.271] train iteration 21403 : loss : 0.714818, loss_ce: 0.956261
[11:52:04.944] train iteration 21453 : loss : 0.338130, loss_ce: 0.433365
[11:52:24.741] train iteration 21503 : loss : 0.518245, loss_ce: 0.728662
[11:52:44.551] train iteration 21553 : loss : 0.438814, loss_ce: 0.537441
[11:53:04.459] train iteration 21603 : loss : 0.601357, loss_ce: 0.892767
[11:53:24.301] train iteration 21653 : loss : 0.574549, loss_ce: 0.879413
[11:53:31.846] val epoch 82 : f1_micro : 0.6172799233879361, f1_macro : 0.5262929222413472, tumor_f1 : 0.7294046069894519, stroma_f1 : 0.5205850468150207, infla_f1 : 0.6866255849599838, necr_f1 : 0.8469793711389814, other_f1 : 0.42042608569525847, acc_micro : 0.8469793711389814
[11:53:33.299] train iteration 21664 : loss : 0.684488, loss_ce: 0.951987
[11:53:52.967] train iteration 21714 : loss : 0.377779, loss_ce: 0.359602
[11:54:12.756] train iteration 21764 : loss : 0.413709, loss_ce: 0.537326
[11:54:32.529] train iteration 21814 : loss : 0.680915, loss_ce: 1.107507
[11:54:52.510] train iteration 21864 : loss : 0.710224, loss_ce: 0.977459
[11:55:12.357] train iteration 21914 : loss : 0.362697, loss_ce: 0.564264
[11:55:19.855] val epoch 83 : f1_micro : 0.608716603900705, f1_macro : 0.49483119377068113, tumor_f1 : 0.7380642614194325, stroma_f1 : 0.4973907342978886, infla_f1 : 0.6372686156204769, necr_f1 : 0.8435504266193935, other_f1 : 0.38845653655256945, acc_micro : 0.8435504266193935
[11:55:21.422] train iteration 21925 : loss : 0.558151, loss_ce: 0.768985
[11:55:41.093] train iteration 21975 : loss : 0.592341, loss_ce: 0.657179
[11:56:00.876] train iteration 22025 : loss : 0.628157, loss_ce: 0.888421
[11:56:20.759] train iteration 22075 : loss : 0.367922, loss_ce: 0.484715
[11:56:40.649] train iteration 22125 : loss : 0.543587, loss_ce: 0.753249
[11:57:00.518] train iteration 22175 : loss : 0.562708, loss_ce: 0.789022
[11:57:07.967] val epoch 84 : f1_micro : 0.6511188128164836, f1_macro : 0.5421864943844932, tumor_f1 : 0.7420239661421094, stroma_f1 : 0.5600523586784091, infla_f1 : 0.5992706237094743, necr_f1 : 0.8604802191257477, other_f1 : 0.4221755356660911, acc_micro : 0.8604802191257477
[11:57:09.428] train iteration 22186 : loss : 0.724833, loss_ce: 0.987895
[11:57:29.097] train iteration 22236 : loss : 0.522326, loss_ce: 0.575746
[11:57:48.801] train iteration 22286 : loss : 0.557763, loss_ce: 0.705358
[11:58:08.720] train iteration 22336 : loss : 0.443015, loss_ce: 0.728361
[11:58:28.598] train iteration 22386 : loss : 0.432437, loss_ce: 0.589762
[11:58:48.495] train iteration 22436 : loss : 0.521816, loss_ce: 0.751363
[11:58:56.067] val epoch 85 : f1_micro : 0.6977428240435464, f1_macro : 0.5881820214646203, tumor_f1 : 0.7640789427927562, stroma_f1 : 0.6315067751067025, infla_f1 : 0.6541168625865664, necr_f1 : 0.8791379843439374, other_f1 : 0.3510886175291879, acc_micro : 0.8791379843439374
[11:58:57.592] train iteration 22447 : loss : 0.547178, loss_ce: 0.813421
[11:59:17.270] train iteration 22497 : loss : 0.745536, loss_ce: 1.054324
[11:59:36.994] train iteration 22547 : loss : 0.453644, loss_ce: 0.592636
[11:59:56.980] train iteration 22597 : loss : 0.504647, loss_ce: 0.722817
[12:00:16.882] train iteration 22647 : loss : 0.402698, loss_ce: 0.571428
[12:00:36.809] train iteration 22697 : loss : 0.424743, loss_ce: 0.568064
[12:00:44.281] val epoch 86 : f1_micro : 0.6859728332076754, f1_macro : 0.5655718169042042, tumor_f1 : 0.7569607283387866, stroma_f1 : 0.6096110131059375, infla_f1 : 0.6823000333138874, necr_f1 : 0.8744384050369263, other_f1 : 0.41814808920025826, acc_micro : 0.8744384050369263
[12:00:45.716] train iteration 22708 : loss : 0.503442, loss_ce: 0.773147
[12:01:05.385] train iteration 22758 : loss : 0.583928, loss_ce: 0.827317
[12:01:25.221] train iteration 22808 : loss : 0.527604, loss_ce: 0.692901
[12:01:45.099] train iteration 22858 : loss : 0.394950, loss_ce: 0.440548
[12:02:05.099] train iteration 22908 : loss : 0.431011, loss_ce: 0.609903
[12:02:25.005] train iteration 22958 : loss : 0.548735, loss_ce: 0.540837
[12:02:32.619] val epoch 87 : f1_micro : 0.6481033350740161, f1_macro : 0.5394860591207232, tumor_f1 : 0.7477314259324755, stroma_f1 : 0.5347512917859214, infla_f1 : 0.6398612303393227, necr_f1 : 0.8592684268951416, other_f1 : 0.3960387318262032, acc_micro : 0.8592684268951416
[12:02:34.081] train iteration 22969 : loss : 0.547693, loss_ce: 0.757871
[12:02:53.766] train iteration 23019 : loss : 0.734282, loss_ce: 1.015345
[12:03:13.616] train iteration 23069 : loss : 0.604929, loss_ce: 0.733757
[12:03:33.480] train iteration 23119 : loss : 0.458074, loss_ce: 0.684137
[12:03:53.383] train iteration 23169 : loss : 0.428522, loss_ce: 0.522356
[12:04:13.269] train iteration 23219 : loss : 0.520243, loss_ce: 0.698740
[12:04:20.696] val epoch 88 : f1_micro : 0.6384912644113813, f1_macro : 0.5509691451277051, tumor_f1 : 0.7147348672151566, stroma_f1 : 0.556043375815664, infla_f1 : 0.6532619083300233, necr_f1 : 0.8554176219872066, other_f1 : 0.41203805644597324, acc_micro : 0.8554176219872066
[12:04:22.144] train iteration 23230 : loss : 0.498703, loss_ce: 0.572963
[12:04:41.833] train iteration 23280 : loss : 0.380516, loss_ce: 0.376945
[12:05:01.724] train iteration 23330 : loss : 0.793990, loss_ce: 1.253111
[12:05:21.677] train iteration 23380 : loss : 0.333620, loss_ce: 0.476863
[12:05:41.625] train iteration 23430 : loss : 0.557519, loss_ce: 0.734488
[12:06:01.580] train iteration 23480 : loss : 0.486501, loss_ce: 0.571204
[12:06:09.068] val epoch 89 : f1_micro : 0.656100115605763, f1_macro : 0.5387124185051236, tumor_f1 : 0.7345899513789585, stroma_f1 : 0.6068900759731021, infla_f1 : 0.6596774735621044, necr_f1 : 0.8624842635222844, other_f1 : 0.4204621357577188, acc_micro : 0.8624842635222844
[12:06:10.541] train iteration 23491 : loss : 0.349132, loss_ce: 0.468475
[12:06:30.227] train iteration 23541 : loss : 0.610866, loss_ce: 0.865295
[12:06:50.064] train iteration 23591 : loss : 0.452723, loss_ce: 0.627796
[12:07:10.020] train iteration 23641 : loss : 0.360828, loss_ce: 0.562910
[12:07:30.063] train iteration 23691 : loss : 0.608861, loss_ce: 0.882244
[12:07:49.894] train iteration 23741 : loss : 0.496371, loss_ce: 0.737009
[12:07:57.493] val epoch 90 : f1_micro : 0.6868412899119514, f1_macro : 0.5889512066330228, tumor_f1 : 0.7537461348942348, stroma_f1 : 0.6320802260722432, infla_f1 : 0.653367994087083, necr_f1 : 0.8747543139117104, other_f1 : 0.4191085754760674, acc_micro : 0.8747543139117104
[12:07:58.998] train iteration 23752 : loss : 0.529720, loss_ce: 0.623402
[12:08:18.678] train iteration 23802 : loss : 0.385647, loss_ce: 0.521271
[12:08:38.475] train iteration 23852 : loss : 0.632244, loss_ce: 0.774164
[12:08:58.430] train iteration 23902 : loss : 0.528904, loss_ce: 0.770244
[12:09:18.370] train iteration 23952 : loss : 0.571185, loss_ce: 0.737207
[12:09:38.294] train iteration 24002 : loss : 0.595623, loss_ce: 0.757442
[12:09:45.701] val epoch 91 : f1_micro : 0.6507128136498588, f1_macro : 0.5411466658115387, tumor_f1 : 0.7496063751833779, stroma_f1 : 0.5028628000956294, infla_f1 : 0.6763656799282346, necr_f1 : 0.8603101244994572, other_f1 : 0.40939127234742045, acc_micro : 0.8603101244994572
[12:09:47.145] train iteration 24013 : loss : 0.495275, loss_ce: 0.703434
[12:10:06.828] train iteration 24063 : loss : 0.595290, loss_ce: 0.766552
[12:10:26.601] train iteration 24113 : loss : 0.472697, loss_ce: 0.582912
[12:10:46.536] train iteration 24163 : loss : 0.537111, loss_ce: 0.774025
[12:11:06.487] train iteration 24213 : loss : 0.433972, loss_ce: 0.499034
[12:11:26.331] train iteration 24263 : loss : 0.594098, loss_ce: 0.808658
[12:11:33.860] val epoch 92 : f1_micro : 0.6646618098020554, f1_macro : 0.5482938034193856, tumor_f1 : 0.7474905337606158, stroma_f1 : 0.5746791884303093, infla_f1 : 0.6700092085770198, necr_f1 : 0.865898494209562, other_f1 : 0.4206887973206384, acc_micro : 0.865898494209562
[12:11:35.291] train iteration 24274 : loss : 0.390258, loss_ce: 0.527758
[12:11:54.966] train iteration 24324 : loss : 0.585246, loss_ce: 0.921161
[12:12:14.790] train iteration 24374 : loss : 0.548454, loss_ce: 0.841986
[12:12:34.650] train iteration 24424 : loss : 0.660873, loss_ce: 0.947891
[12:12:54.494] train iteration 24474 : loss : 0.554641, loss_ce: 0.707758
[12:13:14.497] train iteration 24524 : loss : 0.331198, loss_ce: 0.489088
[12:13:21.903] val epoch 93 : f1_micro : 0.6463783702680043, f1_macro : 0.5371516900403159, tumor_f1 : 0.7498798029763358, stroma_f1 : 0.5449071973562241, infla_f1 : 0.6572637389680105, necr_f1 : 0.8585900408881051, other_f1 : 0.4326539954968861, acc_micro : 0.8585900408881051
[12:13:23.306] train iteration 24535 : loss : 0.382367, loss_ce: 0.520487
[12:13:42.977] train iteration 24585 : loss : 0.645028, loss_ce: 0.929741
[12:14:02.703] train iteration 24635 : loss : 0.664371, loss_ce: 0.924645
[12:14:22.587] train iteration 24685 : loss : 0.534946, loss_ce: 0.738666
[12:14:42.475] train iteration 24735 : loss : 0.634824, loss_ce: 0.839801
[12:15:02.386] train iteration 24785 : loss : 0.710518, loss_ce: 1.076712
[12:15:09.880] val epoch 94 : f1_micro : 0.671829668538911, f1_macro : 0.5538968018123082, tumor_f1 : 0.7499677240848541, stroma_f1 : 0.5794414728879929, infla_f1 : 0.6495600161807877, necr_f1 : 0.8687837890216282, other_f1 : 0.4158332228128399, acc_micro : 0.8687837890216282
[12:15:11.378] train iteration 24796 : loss : 0.405875, loss_ce: 0.543424
[12:15:31.060] train iteration 24846 : loss : 0.370592, loss_ce: 0.452828
[12:15:50.852] train iteration 24896 : loss : 0.479115, loss_ce: 0.648882
[12:16:10.752] train iteration 24946 : loss : 0.658999, loss_ce: 1.090238
[12:16:30.760] train iteration 24996 : loss : 0.416924, loss_ce: 0.582001
[12:16:50.588] train iteration 25046 : loss : 0.359613, loss_ce: 0.499177
[12:16:58.119] val epoch 95 : f1_micro : 0.668679477913039, f1_macro : 0.5405715416584697, tumor_f1 : 0.7493847885302135, stroma_f1 : 0.5886850378343037, infla_f1 : 0.6412640352334295, necr_f1 : 0.8675152574266706, other_f1 : 0.4026566602821861, acc_micro : 0.8675152574266706
[12:16:59.586] train iteration 25057 : loss : 0.419284, loss_ce: 0.567275
[12:17:19.269] train iteration 25107 : loss : 0.391516, loss_ce: 0.572330
[12:17:39.018] train iteration 25157 : loss : 0.561939, loss_ce: 0.812101
[12:17:58.997] train iteration 25207 : loss : 0.592197, loss_ce: 0.856693
[12:18:18.947] train iteration 25257 : loss : 0.543181, loss_ce: 0.573415
[12:18:38.800] train iteration 25307 : loss : 0.391732, loss_ce: 0.502898
[12:18:46.218] val epoch 96 : f1_micro : 0.6850674237523761, f1_macro : 0.5335251486727169, tumor_f1 : 0.7345746159553528, stroma_f1 : 0.6474065056868962, infla_f1 : 0.547609384570803, necr_f1 : 0.8740873975413186, other_f1 : 0.4112373813986778, acc_micro : 0.8740873975413186
[12:18:47.737] train iteration 25318 : loss : 0.578530, loss_ce: 0.807414
[12:19:07.417] train iteration 25368 : loss : 0.532737, loss_ce: 0.583644
[12:19:27.287] train iteration 25418 : loss : 0.376010, loss_ce: 0.378710
[12:19:47.192] train iteration 25468 : loss : 0.486765, loss_ce: 0.632772
[12:20:07.025] train iteration 25518 : loss : 0.433461, loss_ce: 0.490012
[12:20:26.958] train iteration 25568 : loss : 0.630924, loss_ce: 0.742387
[12:20:34.336] val epoch 97 : f1_micro : 0.6984751352242061, f1_macro : 0.5436922950404031, tumor_f1 : 0.7604839652776718, stroma_f1 : 0.6108822439398084, infla_f1 : 0.6531442733747619, necr_f1 : 0.8794338021959577, other_f1 : 0.40191758144646883, acc_micro : 0.8794338021959577
[12:20:35.770] train iteration 25579 : loss : 0.618798, loss_ce: 0.936331
[12:20:55.459] train iteration 25629 : loss : 0.391141, loss_ce: 0.507872
[12:21:15.287] train iteration 25679 : loss : 0.458350, loss_ce: 0.645514
[12:21:35.138] train iteration 25729 : loss : 0.338976, loss_ce: 0.445543
[12:21:55.082] train iteration 25779 : loss : 0.476115, loss_ce: 0.710140
[12:22:14.990] train iteration 25829 : loss : 0.369571, loss_ce: 0.492022
[12:22:22.454] val epoch 98 : f1_micro : 0.6928849305425372, f1_macro : 0.5300583839416504, tumor_f1 : 0.745126268693379, stroma_f1 : 0.6382046160953385, infla_f1 : 0.56622445233266, necr_f1 : 0.8771711332457406, other_f1 : 0.41061501683933394, acc_micro : 0.8771711332457406
[12:22:23.973] train iteration 25840 : loss : 0.434948, loss_ce: 0.419211
[12:22:43.644] train iteration 25890 : loss : 0.379696, loss_ce: 0.513801
[12:23:03.472] train iteration 25940 : loss : 0.836414, loss_ce: 1.233983
[12:23:23.464] train iteration 25990 : loss : 0.473261, loss_ce: 0.542974
[12:23:43.341] train iteration 26040 : loss : 0.647959, loss_ce: 1.004336
[12:24:03.220] train iteration 26090 : loss : 0.599747, loss_ce: 0.869821
[12:24:10.587] val epoch 99 : f1_micro : 0.6741644399506705, f1_macro : 0.546833166054317, tumor_f1 : 0.762179149048669, stroma_f1 : 0.5689397816147123, infla_f1 : 0.6775624056213668, necr_f1 : 0.8696869824613843, other_f1 : 0.40960067936352323, acc_micro : 0.8696869824613843
[12:24:11.394] save model to ./logs/frac_1.0/fold_2/epoch_99.pth
[12:24:12.843] train iteration 26101 : loss : 0.506830, loss_ce: 0.713723
[12:24:32.512] train iteration 26151 : loss : 0.539085, loss_ce: 0.708813
[12:24:52.411] train iteration 26201 : loss : 0.381723, loss_ce: 0.537950
[12:25:12.332] train iteration 26251 : loss : 0.578159, loss_ce: 0.759074
[12:25:32.289] train iteration 26301 : loss : 0.406657, loss_ce: 0.462455
[12:25:52.172] train iteration 26351 : loss : 0.655000, loss_ce: 0.912845
[12:25:59.851] val epoch 100 : f1_micro : 0.6634577874626432, f1_macro : 0.5351750531366893, tumor_f1 : 0.748721222792353, stroma_f1 : 0.5928434974380902, infla_f1 : 0.6442291385361126, necr_f1 : 0.8654071688652039, other_f1 : 0.37157138330595835, acc_micro : 0.8654071688652039
[12:26:01.402] train iteration 26362 : loss : 0.495768, loss_ce: 0.697578
[12:26:21.075] train iteration 26412 : loss : 0.531976, loss_ce: 0.668274
[12:26:40.978] train iteration 26462 : loss : 0.639967, loss_ce: 0.987191
[12:27:00.925] train iteration 26512 : loss : 0.680793, loss_ce: 0.850068
[12:27:20.914] train iteration 26562 : loss : 0.540663, loss_ce: 0.738289
[12:27:40.852] train iteration 26612 : loss : 0.437854, loss_ce: 0.639968
[12:27:48.308] val epoch 101 : f1_micro : 0.6763604964528765, f1_macro : 0.5407198880399976, tumor_f1 : 0.7484835854598454, stroma_f1 : 0.59567477447646, infla_f1 : 0.6716770968133849, necr_f1 : 0.8705849179199764, other_f1 : 0.3465573154389858, acc_micro : 0.8705849179199764
[12:27:49.832] train iteration 26623 : loss : 0.404894, loss_ce: 0.518412
[12:28:09.510] train iteration 26673 : loss : 0.564767, loss_ce: 0.688483
[12:28:29.450] train iteration 26723 : loss : 0.575597, loss_ce: 0.857917
[12:28:49.271] train iteration 26773 : loss : 0.547680, loss_ce: 0.832003
[12:29:09.282] train iteration 26823 : loss : 0.608792, loss_ce: 0.842109
[12:29:29.287] train iteration 26873 : loss : 0.420724, loss_ce: 0.606873
[12:29:36.790] val epoch 102 : f1_micro : 0.6463975778647831, f1_macro : 0.5278383929814611, tumor_f1 : 0.7338566822665078, stroma_f1 : 0.5484075610126767, infla_f1 : 0.6378562940018517, necr_f1 : 0.8585837696279798, other_f1 : 0.422283837305648, acc_micro : 0.8585837696279798
[12:29:38.257] train iteration 26884 : loss : 0.513083, loss_ce: 0.635323
[12:29:57.934] train iteration 26934 : loss : 0.394342, loss_ce: 0.544772
[12:30:17.719] train iteration 26984 : loss : 0.512369, loss_ce: 0.803746
[12:30:37.630] train iteration 27034 : loss : 0.470683, loss_ce: 0.597078
[12:30:57.597] train iteration 27084 : loss : 0.295535, loss_ce: 0.373025
[12:31:17.533] train iteration 27134 : loss : 0.442660, loss_ce: 0.645299
[12:31:24.958] val epoch 103 : f1_micro : 0.6913917171103614, f1_macro : 0.535360472542899, tumor_f1 : 0.7521411627531052, stroma_f1 : 0.6147105427724975, infla_f1 : 0.6657937626753535, necr_f1 : 0.8765782628740583, other_f1 : 0.4057702587119171, acc_micro : 0.8765782628740583
[12:31:26.533] train iteration 27145 : loss : 0.522230, loss_ce: 0.606219
[12:31:46.201] train iteration 27195 : loss : 0.464302, loss_ce: 0.555769
[12:32:06.073] train iteration 27245 : loss : 0.404779, loss_ce: 0.543123
[12:32:25.930] train iteration 27295 : loss : 0.355420, loss_ce: 0.520411
[12:32:45.907] train iteration 27345 : loss : 0.647924, loss_ce: 0.901788
[12:33:05.788] train iteration 27395 : loss : 0.550112, loss_ce: 0.678669
[12:33:13.314] val epoch 104 : f1_micro : 0.6772845664194652, f1_macro : 0.5303904414176941, tumor_f1 : 0.7422812964235034, stroma_f1 : 0.6115983415927205, infla_f1 : 0.6527651202465806, necr_f1 : 0.8709569317953927, other_f1 : 0.39768613608820097, acc_micro : 0.8709569317953927
[12:33:14.818] train iteration 27406 : loss : 0.550837, loss_ce: 0.789973
[12:33:34.491] train iteration 27456 : loss : 0.385478, loss_ce: 0.404910
[12:33:54.355] train iteration 27506 : loss : 0.551353, loss_ce: 0.745052
[12:34:14.236] train iteration 27556 : loss : 0.365160, loss_ce: 0.487911
[12:34:34.083] train iteration 27606 : loss : 0.506769, loss_ce: 0.532188
[12:34:53.960] train iteration 27656 : loss : 0.372612, loss_ce: 0.540945
[12:35:01.439] val epoch 105 : f1_micro : 0.6614798158407211, f1_macro : 0.5320482562695231, tumor_f1 : 0.7445769948618752, stroma_f1 : 0.5901485926338604, infla_f1 : 0.6338691275034632, necr_f1 : 0.8646231208528791, other_f1 : 0.4374031993959631, acc_micro : 0.8646231208528791
[12:35:02.934] train iteration 27667 : loss : 0.582067, loss_ce: 0.669221
[12:35:22.608] train iteration 27717 : loss : 0.347445, loss_ce: 0.457438
[12:35:42.404] train iteration 27767 : loss : 0.462765, loss_ce: 0.573898
[12:36:02.314] train iteration 27817 : loss : 0.556922, loss_ce: 0.838836
[12:36:22.218] train iteration 27867 : loss : 0.444320, loss_ce: 0.646628
[12:36:42.130] train iteration 27917 : loss : 0.365493, loss_ce: 0.510866
[12:36:49.717] val epoch 106 : f1_micro : 0.6778326673167092, f1_macro : 0.5407499862568719, tumor_f1 : 0.7521756035940987, stroma_f1 : 0.6119118960840362, infla_f1 : 0.6772524296705212, necr_f1 : 0.8711742333003453, other_f1 : 0.36774711097989765, acc_micro : 0.8711742333003453
[12:36:51.211] train iteration 27928 : loss : 0.559629, loss_ce: 0.715090
[12:37:10.881] train iteration 27978 : loss : 0.561981, loss_ce: 0.629833
[12:37:30.752] train iteration 28028 : loss : 0.440255, loss_ce: 0.530816
[12:37:50.582] train iteration 28078 : loss : 0.472196, loss_ce: 0.539466
[12:38:10.554] train iteration 28128 : loss : 0.498932, loss_ce: 0.593307
[12:38:30.439] train iteration 28178 : loss : 0.503892, loss_ce: 0.609796
[12:38:38.019] val epoch 107 : f1_micro : 0.6810966389519828, f1_macro : 0.5530629988227572, tumor_f1 : 0.7578053857598986, stroma_f1 : 0.5918443181685039, infla_f1 : 0.657363834125655, necr_f1 : 0.8724788555077144, other_f1 : 0.4298503228596279, acc_micro : 0.8724788555077144
[12:38:39.533] train iteration 28189 : loss : 0.404168, loss_ce: 0.594936
[12:38:59.202] train iteration 28239 : loss : 0.753634, loss_ce: 1.042616
[12:39:18.933] train iteration 28289 : loss : 0.469940, loss_ce: 0.739214
[12:39:38.824] train iteration 28339 : loss : 0.448761, loss_ce: 0.454688
[12:39:58.727] train iteration 28389 : loss : 0.535228, loss_ce: 0.564261
[12:40:18.721] train iteration 28439 : loss : 0.601091, loss_ce: 0.838788
[12:40:26.171] val epoch 108 : f1_micro : 0.6730744476829257, f1_macro : 0.5406629145145416, tumor_f1 : 0.753957695194653, stroma_f1 : 0.6022033074072429, infla_f1 : 0.6496772176719138, necr_f1 : 0.8692627038274493, other_f1 : 0.4309399894305638, acc_micro : 0.8692627038274493
[12:40:27.665] train iteration 28450 : loss : 0.326439, loss_ce: 0.446340
[12:40:47.345] train iteration 28500 : loss : 0.319152, loss_ce: 0.347009
[12:41:07.115] train iteration 28550 : loss : 0.521191, loss_ce: 0.620890
[12:41:27.068] train iteration 28600 : loss : 0.661451, loss_ce: 0.876352
[12:41:47.034] train iteration 28650 : loss : 0.349682, loss_ce: 0.506174
[12:42:06.882] train iteration 28700 : loss : 0.437342, loss_ce: 0.679830
[12:42:14.416] val epoch 109 : f1_micro : 0.6110300868749619, f1_macro : 0.5018813141754696, tumor_f1 : 0.7522621325084141, stroma_f1 : 0.4729976292167391, infla_f1 : 0.6622796165091651, necr_f1 : 0.844450661114284, other_f1 : 0.41929346535887035, acc_micro : 0.844450661114284
[12:42:15.975] train iteration 28711 : loss : 0.541774, loss_ce: 0.801230
[12:42:35.650] train iteration 28761 : loss : 0.520646, loss_ce: 0.660082
[12:42:55.527] train iteration 28811 : loss : 0.543200, loss_ce: 0.814870
[12:43:15.505] train iteration 28861 : loss : 0.451165, loss_ce: 0.702275
[12:43:35.366] train iteration 28911 : loss : 0.587985, loss_ce: 0.772203
[12:43:55.271] train iteration 28961 : loss : 0.541116, loss_ce: 0.752545
[12:44:02.666] val epoch 110 : f1_micro : 0.6835771862949643, f1_macro : 0.5605208724737167, tumor_f1 : 0.7480192248310361, stroma_f1 : 0.6283557478870664, infla_f1 : 0.6553305092300954, necr_f1 : 0.8734593859740666, other_f1 : 0.41289346758276224, acc_micro : 0.8734593859740666
[12:44:04.095] train iteration 28972 : loss : 0.569529, loss_ce: 0.731678
[12:44:23.785] train iteration 29022 : loss : 0.359320, loss_ce: 0.571853
[12:44:43.725] train iteration 29072 : loss : 0.528067, loss_ce: 0.777921
[12:45:03.626] train iteration 29122 : loss : 0.668778, loss_ce: 0.974486
[12:45:23.622] train iteration 29172 : loss : 0.395645, loss_ce: 0.558557
[12:45:43.588] train iteration 29222 : loss : 0.528578, loss_ce: 0.629899
[12:45:51.055] val epoch 111 : f1_micro : 0.6630074679851532, f1_macro : 0.5434798332197326, tumor_f1 : 0.7547682736601148, stroma_f1 : 0.5533914534108979, infla_f1 : 0.6045723038634085, necr_f1 : 0.8652328635965075, other_f1 : 0.4224048348675881, acc_micro : 0.8652328635965075
[12:45:52.623] train iteration 29233 : loss : 0.368669, loss_ce: 0.372089
[12:46:12.308] train iteration 29283 : loss : 0.420609, loss_ce: 0.580537
[12:46:32.178] train iteration 29333 : loss : 0.523590, loss_ce: 0.751297
[12:46:52.212] train iteration 29383 : loss : 0.457866, loss_ce: 0.661722
[12:47:12.146] train iteration 29433 : loss : 0.435094, loss_ce: 0.578912
[12:47:32.064] train iteration 29483 : loss : 0.456848, loss_ce: 0.635831
[12:47:39.549] val epoch 112 : f1_micro : 0.6694446738277163, f1_macro : 0.5484997757843563, tumor_f1 : 0.7642968318292073, stroma_f1 : 0.5561326774103301, infla_f1 : 0.6891190601246697, necr_f1 : 0.8678092999117715, other_f1 : 0.41836104382361683, acc_micro : 0.8678092999117715
[12:47:41.018] train iteration 29494 : loss : 0.536407, loss_ce: 0.764013
[12:48:00.696] train iteration 29544 : loss : 0.442192, loss_ce: 0.558739
[12:48:20.657] train iteration 29594 : loss : 0.364518, loss_ce: 0.517267
[12:48:40.606] train iteration 29644 : loss : 0.302745, loss_ce: 0.349110
[12:49:00.596] train iteration 29694 : loss : 0.527518, loss_ce: 0.487603
[12:49:20.582] train iteration 29744 : loss : 0.658260, loss_ce: 0.811443
[12:49:28.106] val epoch 113 : f1_micro : 0.6592780372926167, f1_macro : 0.5343596254076276, tumor_f1 : 0.7540995308331081, stroma_f1 : 0.5703860473419938, infla_f1 : 0.6858367906617266, necr_f1 : 0.8637416022164481, other_f1 : 0.3562336445070936, acc_micro : 0.8637416022164481
[12:49:29.596] train iteration 29755 : loss : 0.439415, loss_ce: 0.641058
[12:49:49.283] train iteration 29805 : loss : 0.434424, loss_ce: 0.693511
[12:50:09.074] train iteration 29855 : loss : 0.523062, loss_ce: 0.617425
[12:50:29.068] train iteration 29905 : loss : 0.341413, loss_ce: 0.371224
[12:50:49.158] train iteration 29955 : loss : 0.420462, loss_ce: 0.526882
[12:51:09.082] train iteration 30005 : loss : 0.410935, loss_ce: 0.554516
[12:51:16.707] val epoch 114 : f1_micro : 0.6645933389663696, f1_macro : 0.5505034891622407, tumor_f1 : 0.7511693366936275, stroma_f1 : 0.564769809799535, infla_f1 : 0.6377340491328921, necr_f1 : 0.8658646813460759, other_f1 : 0.42457469552755356, acc_micro : 0.8658646813460759
[12:51:18.230] train iteration 30016 : loss : 0.606020, loss_ce: 1.050386
[12:51:37.917] train iteration 30066 : loss : 0.478094, loss_ce: 0.533308
[12:51:57.874] train iteration 30116 : loss : 0.421336, loss_ce: 0.612183
[12:52:17.883] train iteration 30166 : loss : 0.629192, loss_ce: 0.709047
[12:52:37.848] train iteration 30216 : loss : 0.494031, loss_ce: 0.653777
[12:52:57.772] train iteration 30266 : loss : 0.440111, loss_ce: 0.626361
[12:53:05.350] val epoch 115 : f1_micro : 0.6754145962851388, f1_macro : 0.5615019798278809, tumor_f1 : 0.7649280386311668, stroma_f1 : 0.5736459834235055, infla_f1 : 0.6417517789772579, necr_f1 : 0.8701953973088946, other_f1 : 0.41632458035434994, acc_micro : 0.8701953973088946
[12:53:06.936] train iteration 30277 : loss : 0.487842, loss_ce: 0.694884
[12:53:26.615] train iteration 30327 : loss : 0.619583, loss_ce: 0.977134
[12:53:46.516] train iteration 30377 : loss : 0.443005, loss_ce: 0.546890
[12:54:06.558] train iteration 30427 : loss : 0.606018, loss_ce: 0.797931
[12:54:26.490] train iteration 30477 : loss : 0.352920, loss_ce: 0.582039
[12:54:46.518] train iteration 30527 : loss : 0.571020, loss_ce: 0.679651
[12:54:54.044] val epoch 116 : f1_micro : 0.6780267315251487, f1_macro : 0.5588720568588802, tumor_f1 : 0.7538574912718364, stroma_f1 : 0.6122154039996011, infla_f1 : 0.6331141713474479, necr_f1 : 0.8712706736155919, other_f1 : 0.41108846557991846, acc_micro : 0.8712706736155919
[12:54:55.578] train iteration 30538 : loss : 0.422968, loss_ce: 0.461103
[12:55:15.286] train iteration 30588 : loss : 0.378660, loss_ce: 0.556642
[12:55:35.234] train iteration 30638 : loss : 0.556643, loss_ce: 0.739305
[12:55:55.220] train iteration 30688 : loss : 0.386186, loss_ce: 0.456396
[12:56:15.150] train iteration 30738 : loss : 0.476895, loss_ce: 0.454905
[12:56:35.094] train iteration 30788 : loss : 0.514279, loss_ce: 0.676710
[12:56:42.562] val epoch 117 : f1_micro : 0.6809314170054027, f1_macro : 0.5788621881178447, tumor_f1 : 0.7681152416127068, stroma_f1 : 0.5499091669917107, infla_f1 : 0.6810784935951233, necr_f1 : 0.8723998027188438, other_f1 : 0.41062174206932206, acc_micro : 0.8723998027188438
[12:56:44.070] train iteration 30799 : loss : 0.384205, loss_ce: 0.470567
[12:57:03.762] train iteration 30849 : loss : 0.592515, loss_ce: 0.780581
[12:57:23.622] train iteration 30899 : loss : 0.456196, loss_ce: 0.556228
[12:57:43.643] train iteration 30949 : loss : 0.321612, loss_ce: 0.466050
[12:58:03.561] train iteration 30999 : loss : 0.492434, loss_ce: 0.539804
[12:58:23.622] train iteration 31049 : loss : 0.442108, loss_ce: 0.521198
[12:58:31.177] val epoch 118 : f1_micro : 0.6832446753978729, f1_macro : 0.5420380351798875, tumor_f1 : 0.7627840787172318, stroma_f1 : 0.5930211799485343, infla_f1 : 0.6595347172447613, necr_f1 : 0.8733342843396323, other_f1 : 0.3567076570221356, acc_micro : 0.8733342843396323
[12:58:32.706] train iteration 31060 : loss : 0.433171, loss_ce: 0.465184
[12:58:52.413] train iteration 31110 : loss : 0.644689, loss_ce: 0.846752
[12:59:12.396] train iteration 31160 : loss : 0.378450, loss_ce: 0.423354
[12:59:32.425] train iteration 31210 : loss : 0.550197, loss_ce: 0.818094
[12:59:52.396] train iteration 31260 : loss : 0.578170, loss_ce: 0.782635
[13:00:12.389] train iteration 31310 : loss : 0.397569, loss_ce: 0.594036
[13:00:19.985] val epoch 119 : f1_micro : 0.6999655749116626, f1_macro : 0.5644822738000325, tumor_f1 : 0.7670660806553704, stroma_f1 : 0.6350616897855487, infla_f1 : 0.669651445533548, necr_f1 : 0.8800058577741895, other_f1 : 0.4036941592182432, acc_micro : 0.8800058577741895
[13:00:21.568] train iteration 31321 : loss : 0.605261, loss_ce: 0.962137
[13:00:41.238] train iteration 31371 : loss : 0.450613, loss_ce: 0.649573
[13:01:01.120] train iteration 31421 : loss : 0.602084, loss_ce: 0.852183
[13:01:21.204] train iteration 31471 : loss : 0.507747, loss_ce: 0.683319
[13:01:41.078] train iteration 31521 : loss : 0.396526, loss_ce: 0.565222
[13:02:01.118] train iteration 31571 : loss : 0.363506, loss_ce: 0.493450
[13:02:08.612] val epoch 120 : f1_micro : 0.6833699494600296, f1_macro : 0.5427973547152111, tumor_f1 : 0.7306728469473975, stroma_f1 : 0.6343662653650556, infla_f1 : 0.6518078480980226, necr_f1 : 0.8734109359128135, other_f1 : 0.39996127252067837, acc_micro : 0.8734109359128135
[13:02:10.183] train iteration 31582 : loss : 0.429696, loss_ce: 0.522560
[13:02:29.887] train iteration 31632 : loss : 0.446738, loss_ce: 0.661864
[13:02:49.834] train iteration 31682 : loss : 0.336731, loss_ce: 0.430179
[13:03:09.791] train iteration 31732 : loss : 0.313791, loss_ce: 0.420722
[13:03:29.830] train iteration 31782 : loss : 0.497982, loss_ce: 0.694966
[13:03:49.902] train iteration 31832 : loss : 0.399650, loss_ce: 0.442840
[13:03:57.413] val epoch 121 : f1_micro : 0.7048200049570629, f1_macro : 0.5784143954515457, tumor_f1 : 0.7605550523315158, stroma_f1 : 0.6457246201378959, infla_f1 : 0.6616319455871624, necr_f1 : 0.881953912121909, other_f1 : 0.40632666115249905, acc_micro : 0.881953912121909
[13:03:58.900] train iteration 31843 : loss : 0.691078, loss_ce: 1.005980
[13:04:18.575] train iteration 31893 : loss : 0.544474, loss_ce: 0.691079
[13:04:38.468] train iteration 31943 : loss : 0.408155, loss_ce: 0.466632
[13:04:58.521] train iteration 31993 : loss : 0.313210, loss_ce: 0.449511
[13:05:18.520] train iteration 32043 : loss : 0.528535, loss_ce: 0.756009
[13:05:38.461] train iteration 32093 : loss : 0.541090, loss_ce: 0.765549
[13:05:45.980] val epoch 122 : f1_micro : 0.6750455647706985, f1_macro : 0.5531702488660812, tumor_f1 : 0.7548725030251912, stroma_f1 : 0.5933978387287685, infla_f1 : 0.6876256543078593, necr_f1 : 0.8700570293835231, other_f1 : 0.3527123566184725, acc_micro : 0.8700570293835231
[13:05:47.440] train iteration 32104 : loss : 0.378684, loss_ce: 0.530785
[13:06:07.141] train iteration 32154 : loss : 0.454154, loss_ce: 0.586416
[13:06:27.100] train iteration 32204 : loss : 0.543952, loss_ce: 0.718561
[13:06:47.095] train iteration 32254 : loss : 0.542311, loss_ce: 0.690018
[13:07:07.135] train iteration 32304 : loss : 0.578412, loss_ce: 0.766401
[13:07:27.147] train iteration 32354 : loss : 0.468628, loss_ce: 0.588460
[13:07:34.601] val epoch 123 : f1_micro : 0.6890202952282769, f1_macro : 0.5545600333384105, tumor_f1 : 0.7727098081793103, stroma_f1 : 0.5993170993668693, infla_f1 : 0.6623851648930993, necr_f1 : 0.8756345765931266, other_f1 : 0.40499885247222017, acc_micro : 0.8756345765931266
[13:07:36.172] train iteration 32365 : loss : 0.378751, loss_ce: 0.477147
[13:07:55.885] train iteration 32415 : loss : 0.427296, loss_ce: 0.627189
[13:08:15.751] train iteration 32465 : loss : 0.309951, loss_ce: 0.441957
[13:08:35.841] train iteration 32515 : loss : 0.600850, loss_ce: 0.693183
[13:08:55.826] train iteration 32565 : loss : 0.446027, loss_ce: 0.566581
[13:09:15.810] train iteration 32615 : loss : 0.544002, loss_ce: 0.679466
[13:09:23.324] val epoch 124 : f1_micro : 0.6876414801393237, f1_macro : 0.5647134951182774, tumor_f1 : 0.7573243251868657, stroma_f1 : 0.6078520949397769, infla_f1 : 0.6401127023356301, necr_f1 : 0.8750869035720825, other_f1 : 0.4056143622313227, acc_micro : 0.8750869035720825
[13:09:24.769] train iteration 32626 : loss : 0.479434, loss_ce: 0.710170
[13:09:44.462] train iteration 32676 : loss : 0.357219, loss_ce: 0.452697
[13:10:04.540] train iteration 32726 : loss : 0.473692, loss_ce: 0.643821
[13:10:24.362] train iteration 32776 : loss : 0.647907, loss_ce: 0.840661
[13:10:44.484] train iteration 32826 : loss : 0.501687, loss_ce: 0.534690
[13:11:04.472] train iteration 32876 : loss : 0.468770, loss_ce: 0.709665
[13:11:11.977] val epoch 125 : f1_micro : 0.6621239164045879, f1_macro : 0.5428065412810871, tumor_f1 : 0.7617644901786532, stroma_f1 : 0.5555958322116307, infla_f1 : 0.6681291615324361, necr_f1 : 0.8648798039981297, other_f1 : 0.4189345573208162, acc_micro : 0.8648798039981297
[13:11:13.520] train iteration 32887 : loss : 0.429536, loss_ce: 0.553491
[13:11:33.226] train iteration 32937 : loss : 0.574098, loss_ce: 0.810095
[13:11:53.177] train iteration 32987 : loss : 0.221273, loss_ce: 0.239633
[13:12:13.212] train iteration 33037 : loss : 0.432623, loss_ce: 0.567303
[13:12:33.160] train iteration 33087 : loss : 0.331981, loss_ce: 0.445894
[13:12:53.209] train iteration 33137 : loss : 0.432542, loss_ce: 0.555434
[13:13:00.715] val epoch 126 : f1_micro : 0.688329679625375, f1_macro : 0.5664372657026563, tumor_f1 : 0.7528336005551475, stroma_f1 : 0.6089782012360436, infla_f1 : 0.6812803851706641, necr_f1 : 0.8753802222864968, other_f1 : 0.4207767838878291, acc_micro : 0.8753802222864968
[13:13:02.185] train iteration 33148 : loss : 0.468085, loss_ce: 0.631494
[13:13:21.943] train iteration 33198 : loss : 0.393019, loss_ce: 0.500759
[13:13:41.793] train iteration 33248 : loss : 0.470998, loss_ce: 0.555348
[13:14:01.856] train iteration 33298 : loss : 0.356691, loss_ce: 0.422090
[13:14:21.803] train iteration 33348 : loss : 0.460484, loss_ce: 0.573575
[13:14:41.764] train iteration 33398 : loss : 0.430923, loss_ce: 0.672060
[13:14:49.330] val epoch 127 : f1_micro : 0.7073582666260856, f1_macro : 0.5466345633779254, tumor_f1 : 0.750600699867521, stroma_f1 : 0.6708102588142667, infla_f1 : 0.6372862851463391, necr_f1 : 0.8829748204776219, other_f1 : 0.4091314088021006, acc_micro : 0.8829748204776219
[13:14:50.887] train iteration 33409 : loss : 0.397891, loss_ce: 0.529624
[13:15:10.580] train iteration 33459 : loss : 0.473806, loss_ce: 0.605830
[13:15:30.519] train iteration 33509 : loss : 0.347267, loss_ce: 0.409633
[13:15:50.450] train iteration 33559 : loss : 0.665386, loss_ce: 1.034487
[13:16:10.468] train iteration 33609 : loss : 0.348504, loss_ce: 0.496177
[13:16:30.551] train iteration 33659 : loss : 0.675409, loss_ce: 0.822988
[13:16:38.075] val epoch 128 : f1_micro : 0.6732416152954102, f1_macro : 0.5832210736615318, tumor_f1 : 0.7514326636280332, stroma_f1 : 0.6089798967753138, infla_f1 : 0.6525866820343903, necr_f1 : 0.8693467591490064, other_f1 : 0.419359072768462, acc_micro : 0.8693467591490064
[13:16:39.599] train iteration 33670 : loss : 0.491997, loss_ce: 0.512785
[13:16:59.273] train iteration 33720 : loss : 0.289842, loss_ce: 0.437197
[13:17:19.230] train iteration 33770 : loss : 0.453815, loss_ce: 0.528169
[13:17:39.193] train iteration 33820 : loss : 0.537791, loss_ce: 0.760488
[13:17:59.248] train iteration 33870 : loss : 0.479326, loss_ce: 0.554304
[13:18:19.275] train iteration 33920 : loss : 0.399224, loss_ce: 0.434269
[13:18:26.649] val epoch 129 : f1_micro : 0.7002121188810894, f1_macro : 0.5757208615541458, tumor_f1 : 0.7602935773985726, stroma_f1 : 0.6353357221399035, infla_f1 : 0.6602539558495794, necr_f1 : 0.8801120349339077, other_f1 : 0.42764128531728474, acc_micro : 0.8801120349339077
[13:18:28.189] train iteration 33931 : loss : 0.408061, loss_ce: 0.601855
[13:18:47.892] train iteration 33981 : loss : 0.503230, loss_ce: 0.555648
[13:19:07.882] train iteration 34031 : loss : 0.503646, loss_ce: 0.686667
[13:19:28.010] train iteration 34081 : loss : 0.424107, loss_ce: 0.631537
[13:19:47.874] train iteration 34131 : loss : 0.520266, loss_ce: 0.716821
[13:20:07.897] train iteration 34181 : loss : 0.503261, loss_ce: 0.606225
[13:20:15.516] val epoch 130 : f1_micro : 0.6845989567892892, f1_macro : 0.5600965363638741, tumor_f1 : 0.7574039782796588, stroma_f1 : 0.6196771774973188, infla_f1 : 0.6542129947670868, necr_f1 : 0.873875652040754, other_f1 : 0.4154101490442242, acc_micro : 0.873875652040754
[13:20:17.009] train iteration 34192 : loss : 0.283290, loss_ce: 0.399235
[13:20:36.704] train iteration 34242 : loss : 0.579330, loss_ce: 0.827653
[13:20:56.684] train iteration 34292 : loss : 0.569839, loss_ce: 0.780929
[13:21:16.704] train iteration 34342 : loss : 0.328531, loss_ce: 0.474520
[13:21:36.759] train iteration 34392 : loss : 0.430298, loss_ce: 0.627556
[13:21:56.768] train iteration 34442 : loss : 0.447838, loss_ce: 0.656166
[13:22:04.256] val epoch 131 : f1_micro : 0.6741164049931935, f1_macro : 0.5476301589182445, tumor_f1 : 0.766996722136225, stroma_f1 : 0.5660533745373998, infla_f1 : 0.6524824388325214, necr_f1 : 0.8696735075541905, other_f1 : 0.34634227571742876, acc_micro : 0.8696735075541905
[13:22:05.794] train iteration 34453 : loss : 0.519560, loss_ce: 0.765115
[13:22:25.548] train iteration 34503 : loss : 0.342437, loss_ce: 0.432120
[13:22:45.582] train iteration 34553 : loss : 0.248462, loss_ce: 0.343784
[13:23:05.593] train iteration 34603 : loss : 0.323473, loss_ce: 0.463937
[13:23:25.584] train iteration 34653 : loss : 0.280766, loss_ce: 0.370340
[13:23:45.595] train iteration 34703 : loss : 0.390874, loss_ce: 0.560051
[13:23:53.193] val epoch 132 : f1_micro : 0.6975198090076447, f1_macro : 0.5559454283543995, tumor_f1 : 0.7688972183636257, stroma_f1 : 0.5983154731137412, infla_f1 : 0.662485030213637, necr_f1 : 0.8790329992771149, other_f1 : 0.41060598686869654, acc_micro : 0.8790329992771149
[13:23:54.710] train iteration 34714 : loss : 0.309090, loss_ce: 0.440142
[13:24:14.480] train iteration 34764 : loss : 0.389134, loss_ce: 0.479662
[13:24:34.346] train iteration 34814 : loss : 0.369938, loss_ce: 0.510913
[13:24:54.409] train iteration 34864 : loss : 0.401759, loss_ce: 0.523539
[13:25:14.550] train iteration 34914 : loss : 0.505236, loss_ce: 0.615010
[13:25:34.579] train iteration 34964 : loss : 0.452676, loss_ce: 0.611571
[13:25:42.075] val epoch 133 : f1_micro : 0.6913025102445057, f1_macro : 0.5548792385629245, tumor_f1 : 0.7752708686249596, stroma_f1 : 0.5988748690911702, infla_f1 : 0.6488838443266494, necr_f1 : 0.876567006111145, other_f1 : 0.4091065957077912, acc_micro : 0.876567006111145
[13:25:43.613] train iteration 34975 : loss : 0.510799, loss_ce: 0.703471
[13:26:03.302] train iteration 35025 : loss : 0.485639, loss_ce: 0.622627
[13:26:23.265] train iteration 35075 : loss : 0.385342, loss_ce: 0.501006
[13:26:43.439] train iteration 35125 : loss : 0.343641, loss_ce: 0.303679
[13:27:03.396] train iteration 35175 : loss : 0.566869, loss_ce: 0.723639
[13:27:23.461] train iteration 35225 : loss : 0.535190, loss_ce: 0.660517
[13:27:30.959] val epoch 134 : f1_micro : 0.6779686084815434, f1_macro : 0.5363893136382103, tumor_f1 : 0.759972197668893, stroma_f1 : 0.6072660088539124, infla_f1 : 0.6155182628759316, necr_f1 : 0.8712191198553357, other_f1 : 0.4068926027310746, acc_micro : 0.8712191198553357
[13:27:32.455] train iteration 35236 : loss : 0.540067, loss_ce: 0.616377
[13:27:52.192] train iteration 35286 : loss : 0.508042, loss_ce: 0.717219
[13:28:12.197] train iteration 35336 : loss : 0.560232, loss_ce: 0.803716
[13:28:32.246] train iteration 35386 : loss : 0.458014, loss_ce: 0.689444
[13:28:52.303] train iteration 35436 : loss : 0.532415, loss_ce: 0.656929
[13:29:12.294] train iteration 35486 : loss : 0.357979, loss_ce: 0.478871
[13:29:19.932] val epoch 135 : f1_micro : 0.6859078641448703, f1_macro : 0.5472536299909864, tumor_f1 : 0.7639955856970378, stroma_f1 : 0.5970123388937542, infla_f1 : 0.6586144715547562, necr_f1 : 0.8743878517832074, other_f1 : 0.41557899170688223, acc_micro : 0.8743878517832074
[13:29:21.388] train iteration 35497 : loss : 0.404884, loss_ce: 0.608067
[13:29:41.086] train iteration 35547 : loss : 0.458695, loss_ce: 0.679848
[13:30:01.103] train iteration 35597 : loss : 0.507919, loss_ce: 0.499694
[13:30:21.154] train iteration 35647 : loss : 0.389605, loss_ce: 0.588156
[13:30:41.158] train iteration 35697 : loss : 0.522049, loss_ce: 0.663688
[13:31:01.180] train iteration 35747 : loss : 0.558042, loss_ce: 0.669486
[13:31:08.746] val epoch 136 : f1_micro : 0.6916753074952534, f1_macro : 0.5502967451299939, tumor_f1 : 0.777520192520959, stroma_f1 : 0.6016592298235212, infla_f1 : 0.6750825542424407, necr_f1 : 0.8767052931444985, other_f1 : 0.34426070032973904, acc_micro : 0.8767052931444985
[13:31:10.174] train iteration 35758 : loss : 0.485583, loss_ce: 0.649481
[13:31:29.910] train iteration 35808 : loss : 0.559755, loss_ce: 0.709922
[13:31:49.822] train iteration 35858 : loss : 0.369027, loss_ce: 0.329881
[13:32:10.056] train iteration 35908 : loss : 0.598190, loss_ce: 0.853868
[13:32:30.150] train iteration 35958 : loss : 0.297861, loss_ce: 0.334195
[13:32:50.225] train iteration 36008 : loss : 0.472903, loss_ce: 0.526478
[13:32:57.803] val epoch 137 : f1_micro : 0.6692452260426113, f1_macro : 0.5582593892301831, tumor_f1 : 0.768791030560221, stroma_f1 : 0.574546258364405, infla_f1 : 0.684201971760818, necr_f1 : 0.8677282588822501, other_f1 : 0.421662186987565, acc_micro : 0.8677282588822501
[13:32:59.286] train iteration 36019 : loss : 0.227372, loss_ce: 0.265298
[13:33:19.097] train iteration 36069 : loss : 0.362202, loss_ce: 0.500124
[13:33:39.017] train iteration 36119 : loss : 0.309443, loss_ce: 0.442681
[13:33:59.230] train iteration 36169 : loss : 0.419224, loss_ce: 0.576413
[13:34:19.425] train iteration 36219 : loss : 0.482352, loss_ce: 0.723488
[13:34:39.584] train iteration 36269 : loss : 0.389734, loss_ce: 0.495919
[13:34:47.191] val epoch 138 : f1_micro : 0.6969318624053683, f1_macro : 0.5782128764050347, tumor_f1 : 0.7714048751762935, stroma_f1 : 0.6260535057101931, infla_f1 : 0.6782943255134991, necr_f1 : 0.8787964412144252, other_f1 : 0.4341827391513756, acc_micro : 0.8787964412144252
[13:34:48.698] train iteration 36280 : loss : 0.309077, loss_ce: 0.442948
[13:35:08.429] train iteration 36330 : loss : 0.460915, loss_ce: 0.675522
[13:35:28.556] train iteration 36380 : loss : 0.430900, loss_ce: 0.440263
[13:35:48.691] train iteration 36430 : loss : 0.439018, loss_ce: 0.475915
[13:36:08.656] train iteration 36480 : loss : 0.474929, loss_ce: 0.602556
[13:36:28.876] train iteration 36530 : loss : 0.348576, loss_ce: 0.395245
[13:36:36.260] val epoch 139 : f1_micro : 0.694634484393256, f1_macro : 0.5463735397372927, tumor_f1 : 0.7718730270862579, stroma_f1 : 0.6224600332123893, infla_f1 : 0.6436216833868197, necr_f1 : 0.8778899226869855, other_f1 : 0.34854039177298546, acc_micro : 0.8778899226869855
[13:36:37.797] train iteration 36541 : loss : 0.328570, loss_ce: 0.501895
[13:36:57.615] train iteration 36591 : loss : 0.302604, loss_ce: 0.389904
[13:37:17.598] train iteration 36641 : loss : 0.463348, loss_ce: 0.692826
[13:37:37.815] train iteration 36691 : loss : 0.349950, loss_ce: 0.439064
[13:37:57.873] train iteration 36741 : loss : 0.481097, loss_ce: 0.662341
[13:38:17.895] train iteration 36791 : loss : 0.472704, loss_ce: 0.466814
[13:38:25.538] val epoch 140 : f1_micro : 0.6860210469790867, f1_macro : 0.5940158037202699, tumor_f1 : 0.7620931821210044, stroma_f1 : 0.612678661942482, infla_f1 : 0.6553222494465964, necr_f1 : 0.8744304435593742, other_f1 : 0.4340533534330981, acc_micro : 0.8744304435593742
[13:38:27.024] train iteration 36802 : loss : 0.350216, loss_ce: 0.492846
[13:38:46.746] train iteration 36852 : loss : 0.315906, loss_ce: 0.417100
[13:39:06.839] train iteration 36902 : loss : 0.519715, loss_ce: 0.716833
[13:39:26.949] train iteration 36952 : loss : 0.421620, loss_ce: 0.497867
[13:39:47.040] train iteration 37002 : loss : 0.584173, loss_ce: 0.641074
[13:40:07.054] train iteration 37052 : loss : 0.533903, loss_ce: 0.691764
[13:40:14.695] val epoch 141 : f1_micro : 0.6834579919065747, f1_macro : 0.5433394610881805, tumor_f1 : 0.7694183566740581, stroma_f1 : 0.610778638294765, infla_f1 : 0.6478152785982404, necr_f1 : 0.8734121535505567, other_f1 : 0.35272383423788206, acc_micro : 0.8734121535505567
[13:40:16.256] train iteration 37063 : loss : 0.496984, loss_ce: 0.764550
[13:40:35.976] train iteration 37113 : loss : 0.383280, loss_ce: 0.552365
[13:40:56.103] train iteration 37163 : loss : 0.404968, loss_ce: 0.587540
[13:41:16.083] train iteration 37213 : loss : 0.328551, loss_ce: 0.393125
[13:41:36.174] train iteration 37263 : loss : 0.459076, loss_ce: 0.716694
[13:41:56.219] train iteration 37313 : loss : 0.381492, loss_ce: 0.490663
[13:42:03.681] val epoch 142 : f1_micro : 0.6928826017039162, f1_macro : 0.5636739581823349, tumor_f1 : 0.7737798265048436, stroma_f1 : 0.6074350667851312, infla_f1 : 0.6739376091531345, necr_f1 : 0.8771759782518659, other_f1 : 0.4298569049154009, acc_micro : 0.8771759782518659
[13:42:05.187] train iteration 37324 : loss : 0.521396, loss_ce: 0.777853
[13:42:24.913] train iteration 37374 : loss : 0.505026, loss_ce: 0.774627
[13:42:45.006] train iteration 37424 : loss : 0.371311, loss_ce: 0.513542
[13:43:05.099] train iteration 37474 : loss : 0.581852, loss_ce: 0.913925
[13:43:25.097] train iteration 37524 : loss : 0.375571, loss_ce: 0.386807
[13:43:45.054] train iteration 37574 : loss : 0.349267, loss_ce: 0.467834
[13:43:52.642] val epoch 143 : f1_micro : 0.6892079689673015, f1_macro : 0.5636955190982137, tumor_f1 : 0.7737263504947934, stroma_f1 : 0.6124547592231205, infla_f1 : 0.6704901611166341, necr_f1 : 0.8757082351616451, other_f1 : 0.4216525262620832, acc_micro : 0.8757082351616451
[13:43:54.024] train iteration 37585 : loss : 0.363256, loss_ce: 0.426219
[13:44:13.804] train iteration 37635 : loss : 0.453481, loss_ce: 0.570872
[13:44:33.887] train iteration 37685 : loss : 0.474686, loss_ce: 0.701336
[13:44:53.932] train iteration 37735 : loss : 0.398992, loss_ce: 0.561237
[13:45:13.940] train iteration 37785 : loss : 0.333114, loss_ce: 0.425770
[13:45:33.980] train iteration 37835 : loss : 0.376469, loss_ce: 0.410909
[13:45:41.558] val epoch 144 : f1_micro : 0.6969968868153436, f1_macro : 0.5776772392647607, tumor_f1 : 0.7755798697471619, stroma_f1 : 0.6190331067357745, infla_f1 : 0.6642273558037621, necr_f1 : 0.8788246299539294, other_f1 : 0.4306521240089621, acc_micro : 0.8788246299539294
[13:45:43.050] train iteration 37846 : loss : 0.377310, loss_ce: 0.463774
[13:46:02.828] train iteration 37896 : loss : 0.436151, loss_ce: 0.677036
[13:46:22.792] train iteration 37946 : loss : 0.271928, loss_ce: 0.393650
[13:46:42.868] train iteration 37996 : loss : 0.495746, loss_ce: 0.654754
[13:47:02.910] train iteration 38046 : loss : 0.411607, loss_ce: 0.632570
[13:47:22.879] train iteration 38096 : loss : 0.500571, loss_ce: 0.509756
[13:47:30.285] val epoch 145 : f1_micro : 0.690167989049639, f1_macro : 0.5546360537409782, tumor_f1 : 0.769555104630334, stroma_f1 : 0.612205662897655, infla_f1 : 0.6486971309142453, necr_f1 : 0.8760928341320583, other_f1 : 0.4225063595388617, acc_micro : 0.8760928341320583
[13:47:31.754] train iteration 38107 : loss : 0.414623, loss_ce: 0.466985
[13:47:51.604] train iteration 38157 : loss : 0.654810, loss_ce: 1.021044
[13:48:11.591] train iteration 38207 : loss : 0.378273, loss_ce: 0.516406
[13:48:31.555] train iteration 38257 : loss : 0.567694, loss_ce: 0.766851
[13:48:51.618] train iteration 38307 : loss : 0.416183, loss_ce: 0.507016
[13:49:11.690] train iteration 38357 : loss : 0.311773, loss_ce: 0.419456
[13:49:19.245] val epoch 146 : f1_micro : 0.6898689504180636, f1_macro : 0.5625574237533978, tumor_f1 : 0.7732605465820858, stroma_f1 : 0.6084263111863818, infla_f1 : 0.6673542990216187, necr_f1 : 0.875973275729588, other_f1 : 0.4287402741611004, acc_micro : 0.875973275729588
[13:49:20.777] train iteration 38368 : loss : 0.440567, loss_ce: 0.537283
[13:49:40.481] train iteration 38418 : loss : 0.615260, loss_ce: 0.721503
[13:50:00.581] train iteration 38468 : loss : 0.316034, loss_ce: 0.445368
[13:50:20.522] train iteration 38518 : loss : 0.328031, loss_ce: 0.420722
[13:50:40.637] train iteration 38568 : loss : 0.319263, loss_ce: 0.446508
[13:51:00.618] train iteration 38618 : loss : 0.554958, loss_ce: 0.795299
[13:51:08.093] val epoch 147 : f1_micro : 0.6920326926878521, f1_macro : 0.5609746884022441, tumor_f1 : 0.7726089911801475, stroma_f1 : 0.6056902983358928, infla_f1 : 0.6652381542537894, necr_f1 : 0.8768379432814462, other_f1 : 0.4269440762166466, acc_micro : 0.8768379432814462
[13:51:09.641] train iteration 38629 : loss : 0.416925, loss_ce: 0.618534
[13:51:29.360] train iteration 38679 : loss : 0.371916, loss_ce: 0.524659
[13:51:49.384] train iteration 38729 : loss : 0.531048, loss_ce: 0.586200
[13:52:09.421] train iteration 38779 : loss : 0.490366, loss_ce: 0.652446
[13:52:29.476] train iteration 38829 : loss : 0.403491, loss_ce: 0.661211
[13:52:49.519] train iteration 38879 : loss : 0.442063, loss_ce: 0.615205
[13:52:57.076] val epoch 148 : f1_micro : 0.6920126612697329, f1_macro : 0.5627996815102441, tumor_f1 : 0.7733651931796756, stroma_f1 : 0.6139140725135803, infla_f1 : 0.6638612300157547, necr_f1 : 0.8768299094268254, other_f1 : 0.42545054972703966, acc_micro : 0.8768299094268254
[13:52:58.551] train iteration 38890 : loss : 0.389239, loss_ce: 0.323440
[13:53:18.282] train iteration 38940 : loss : 0.395296, loss_ce: 0.518814
[13:53:38.326] train iteration 38990 : loss : 0.523357, loss_ce: 0.644235
[13:53:58.339] train iteration 39040 : loss : 0.409177, loss_ce: 0.457781
[13:54:18.428] train iteration 39090 : loss : 0.555349, loss_ce: 0.852181
[13:54:38.406] train iteration 39140 : loss : 0.326584, loss_ce: 0.493270
[13:54:45.967] val epoch 149 : f1_micro : 0.6932230485337121, f1_macro : 0.5640806832483837, tumor_f1 : 0.7740966017757144, stroma_f1 : 0.6122553305966514, infla_f1 : 0.6677680122000831, necr_f1 : 0.8773154488631657, other_f1 : 0.42389319384736673, acc_micro : 0.8773154488631657
[13:54:46.807] save model to ./logs/frac_1.0/fold_2/epoch_149.pth
[13:54:47.776] save model to ./logs/frac_1.0/fold_2/epoch_149.pth
